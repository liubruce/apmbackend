/*! Countly 20-08-2016 */
function simpleheat(a){return this instanceof simpleheat?(this._canvas=a="string"==typeof a?document.getElementById(a):a,this._ctx=a.getContext("2d"),this._width=a.width,this._height=a.height,this._max=1,void(this._data=[])):new simpleheat(a)}function changeApp(a){settingsAppId=a,countlyGlobal.apps[a]&&"mobile"!=countlyGlobal.apps[a].type?$(".appmng-push").hide():$(".appmng-push").show(),a&&(apn=countlyGlobal.apps[a].apn=countlyGlobal.apps[a].apn||{},gcm=countlyGlobal.apps[a].gcm=countlyGlobal.apps[a].gcm||{},$("#push-apn-cert-uni-view").removeClass("fa fa-remove").removeClass("fa fa-check").addClass(apn.universal?"fa fa-check":"fa fa-remove"),$("#view-gcm-key").html(gcm.key||'<i class="fa fa-remove"></i>'),$("#gcm-key").val(gcm.key||""),$(".app-apn-cert-old")[apn.prod||apn.test?"show":"hide"](),$(".app-apn-cert-old .dev")[apn.test?"show":"hide"](),$(".app-apn-cert-old .prod")[apn.prod?"show":"hide"]())}function pushAppMgmt(){app.localize(),settingsAppId&&(changeApp(settingsAppId),window.pushSubmitting=!1,$("#save-app-edit").on("click",function(){if(!window.pushSubmitting){window.pushSubmitting=!0;var a=$("#apns_cert_prod").val().split(".").pop().toLowerCase();if(a&&$.inArray(a,["p12"])==-1)return CountlyHelpers.alert(jQuery.i18n.map["management-applications.push-error"],"red"),!1;var b=CountlyHelpers.loading(jQuery.i18n.map["management-applications.checking"]),c=1+(a?1:0),d=function(){c--,0==c&&(window.pushSubmitting=!1,CountlyHelpers.removeDialog(b)),changeApp(settingsAppId)},e=function(a){CountlyHelpers.removeDialog(b),CountlyHelpers.alert(a,"red")};$.ajax({type:"GET",url:countlyCommon.API_URL+"/i/pushes/update",data:{args:JSON.stringify({app_id:settingsAppId,"gcm.key":$("#gcm-key").val()||void 0}),api_key:countlyGlobal.member.api_key},dataType:"jsonp",success:function(b){return b.error?(e(jQuery.i18n.map["management-applications.gcm-creds-error"]),c=1,void d()):(countlyGlobal.apps[settingsAppId].apn||(countlyGlobal.apps[settingsAppId].apn={}),countlyGlobal.admin_apps[settingsAppId].apn||(countlyGlobal.admin_apps[settingsAppId].apn={}),countlyGlobal.apps[settingsAppId].gcm||(countlyGlobal.apps[settingsAppId].gcm={}),countlyGlobal.admin_apps[settingsAppId].gcm||(countlyGlobal.admin_apps[settingsAppId].gcm={}),b.gcm&&(countlyGlobal.apps[settingsAppId].gcm.key=b.gcm.key,countlyGlobal.admin_apps[settingsAppId].gcm.key=b.gcm.key),changeApp(settingsAppId),a&&($("#add-edit-apn-creds-uni-form").find("input[name=app_id]").val(settingsAppId),$("#add-edit-apn-creds-uni-form").ajaxSubmit({resetForm:!0,beforeSubmit:function(a,b,c){a.push({name:"_csrf",value:countlyGlobal.csrf_token}),a.push({name:"api_key",value:countlyGlobal.member.api_key})},success:function(a){!a||a.error?(countlyGlobal.apps[settingsAppId].apn&&(delete countlyGlobal.apps[settingsAppId].apn.universal,delete apn.universal),e(jQuery.i18n.map["management-applications.push-apn-creds-prod-error"]+(a.error?" ("+a.error+")":""))):countlyGlobal.apps[settingsAppId].apn?apn.universal=countlyGlobal.apps[settingsAppId].apn.universal=a:apn=countlyGlobal.apps[settingsAppId].apn={universal:a},d()}})),void d())}})}}))}function addPushHTMLIfNeeded(){0===$(".appmng-push").length&&($(".app-details table tr.table-edit").before(managementAdd),$(".appmng-push").prev().removeClass("table-edit-prev"))}window.MobileDashboardView=countlyView.extend({selectedView:"#draw-total-sessions",initialize:function(){this.curMap="map-list-sessions",this.template=Handlebars.compile($("#dashboard-template").html())},beforeRender:function(){return this.maps={"map-list-sessions":{id:"total",label:jQuery.i18n.map["sidebar.analytics.sessions"],type:"number",metric:"t"},"map-list-users":{id:"total",label:jQuery.i18n.map["sidebar.analytics.users"],type:"number",metric:"u"},"map-list-new":{id:"total",label:jQuery.i18n.map["common.table.new-users"],type:"number",metric:"n"}},$.when(countlyUser.initialize(),countlyCarrier.initialize(),countlyDeviceDetails.initialize(),countlyTotalUsers.initialize("users"),countlyTotalUsers.initialize("countries")).then(function(){})},afterRender:function(){if(countlyGlobal.config.use_google){var a=this;countlyLocation.drawGeoChart({height:290,metric:a.maps[a.curMap]})}},pageScript:function(){$("#total-user-estimate-ind").on("click",function(){CountlyHelpers.alert($("#total-user-estimate-exp").html(),"black")}),$(".widget-content .inner").click(function(){$(".big-numbers").removeClass("active"),$(".big-numbers .select").removeClass("selected"),$(this).parent(".big-numbers").addClass("active"),$(this).find(".select").addClass("selected")}),$(".bar-inner").on({mouseenter:function(){var a=$(this).parent().next();a.text($(this).data("item")),a.css({color:$(this).css("background-color")})},mouseleave:function(){var a=$(this).parent().next();a.text(a.data("item")),a.css({color:$(this).parent().find(".bar-inner:first-child").css("background-color")})}});var a=this;$(".big-numbers .inner").click(function(){var b=$(this).find(".select").attr("id");return a.selectedView=="#"+b||(a.selectedView="#"+b,void a.drawGraph())}),countlyGlobal.config.use_google&&(this.countryList(),$(".map-list .cly-button-group .icon-button").click(function(){$(".map-list .cly-button-group .icon-button").removeClass("active"),$(this).addClass("active"),a.curMap=$(this).attr("id"),countlyLocation.refreshGeoChart(a.maps[a.curMap]),a.countryList()})),app.localize()},drawGraph:function(){var a={};switch(this.selectedView){case"#draw-total-users":a=countlySession.getUserDPActive();break;case"#draw-new-users":a=countlySession.getUserDPNew();break;case"#draw-total-sessions":a=countlySession.getSessionDPTotal();break;case"#draw-time-spent":a=countlySession.getDurationDPAvg();break;case"#draw-total-time-spent":a=countlySession.getDurationDP();break;case"#draw-avg-events-served":a=countlySession.getEventsDPAvg()}_.defer(function(){countlyCommon.drawTimeGraph(a.chartDP,"#dashboard-graph")})},renderCommon:function(a,b){var c=countlySession.getSessionData(),d=countlyLocation.getLocationData({maxCountries:10});countlySession.getSessionDPTotal();this.locationData=d,c["page-title"]=countlyCommon.getDateRange(),c.usage=[{title:jQuery.i18n.map["common.total-sessions"],"material-icon":"timeline",data:c.usage["total-sessions"],id:"draw-total-sessions",help:"dashboard.total-sessions"},{title:jQuery.i18n.map["common.total-users"],"ion-icon":"ion-person-stalker",data:c.usage["total-users"],id:"draw-total-users",help:"dashboard.total-users"},{title:jQuery.i18n.map["common.new-users"],"ion-icon":"ion-person-add",data:c.usage["new-users"],id:"draw-new-users",help:"dashboard.new-users"},{title:jQuery.i18n.map["dashboard.time-spent"],"ion-icon":"ion-android-time",data:c.usage["total-duration"],id:"draw-total-time-spent",help:"dashboard.total-time-spent"},{title:jQuery.i18n.map["dashboard.avg-time-spent"],"material-icon":"timelapse",data:c.usage["avg-duration-per-session"],id:"draw-time-spent",help:"dashboard.avg-time-spent2"},{title:jQuery.i18n.map["dashboard.avg-reqs-received"],"material-icon":"compare_arrows",data:c.usage["avg-events"],id:"draw-avg-events-served",help:"dashboard.avg-reqs-received"}],c.bars=[{title:jQuery.i18n.map["common.bar.top-platform"],data:countlyDeviceDetails.getPlatformBars(),help:"dashboard.top-platforms"},{title:jQuery.i18n.map["common.bar.top-resolution"],data:countlyDeviceDetails.getResolutionBars(),help:"dashboard.top-resolutions"},{title:jQuery.i18n.map["common.bar.top-carrier"],data:countlyCarrier.getCarrierBars(),help:"dashboard.top-carriers"},{title:jQuery.i18n.map["common.bar.top-users"],data:countlySession.getTopUserBars(),help:"dashboard.top-users"}],this.templateData=c,a||($(this.el).html(this.template(this.templateData)),countlyGlobal.config.use_google||$(".map-list.geo-switch").hide(),$(this.selectedView).parents(".big-numbers").addClass("active"),this.pageScript(),b||this.drawGraph()),countlyGlobal.config.use_google||this.countryTable(a)},restart:function(){this.refresh(!0)},refresh:function(a){var b=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=b)return!1;b.renderCommon(!0);var c=$("<div>"+b.template(b.templateData)+"</div>");$(".dashboard-summary").replaceWith(c.find(".dashboard-summary")),$(".widget-header .title").replaceWith(c.find(".widget-header .title")),$("#big-numbers-container").find(".big-numbers").each(function(b,d){var e=$(c.find("#big-numbers-container .big-numbers")[b]);if(a)$(d).find(".number").replaceWith(e.find(".number"));else{var f=$(d).find(".number .value"),g=parseFloat(f.text())||0,h=f.text().replace(g,""),i=parseFloat(e.find(".number .value").text()),j=e.find(".number .value").text().replace(i,"");i!=g&&(i<g||j.length&&j!=h?$(d).find(".number").replaceWith(e.find(".number")):jQuery({someValue:g,currEl:f}).animate({someValue:i},{duration:2e3,easing:"easeInOutQuint",step:function(){(i+"").indexOf(".")==-1?this.currEl.text(Math.round(this.someValue)+j):this.currEl.text(parseFloat(this.someValue.toFixed(1))+j)}}))}$(d).find(".trend").replaceWith(e.find(".trend")),$(d).find(".spark").replaceWith(e.find(".spark"))}),b.drawGraph(),$(".usparkline").peity("bar",{width:"100%",height:"30",colour:"#6BB96E",strokeColour:"#6BB96E",strokeWidth:2}),$(".dsparkline").peity("bar",{width:"100%",height:"30",colour:"#C94C4C",strokeColour:"#C94C4C",strokeWidth:2}),0==c.find("#map-list-right").length&&$("#map-list-right").remove(),$("#map-list-right").length?$("#map-list-right").replaceWith(c.find("#map-list-right")):$(".widget.map-list").prepend(c.find("#map-list-right")),b.pageScript()})},countryList:function(){var a=this;$("#map-list-right").empty();for(var b,c=0;c<a.locationData.length;c++)b=a.locationData[c],$("#map-list-right").append('<div class="map-list-item"><div class="flag" style="background-image:url(\''+countlyGlobal.cdn+"images/flags/"+b.code+'.png\');"></div><div class="country-name">'+b.country+'</div><div class="total">'+b[a.maps[a.curMap].metric]+"</div></div>")},countryTable:function(a){var b=this;a?CountlyHelpers.refreshTable(b.country_dtable,countlyLocation.getLocationData({maxCountries:10})):($(".map-list").after('<table id="countries-alternative" class="d-table help-zone-vb" cellpadding="0" cellspacing="0"></table>'),this.country_dtable=$("#countries-alternative").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.locationData,iDisplayLength:10,aoColumns:[{mData:"country_flag",sType:"string",sTitle:jQuery.i18n.map["countries.table.country"]},{mData:"t",sType:"numeric",sTitle:jQuery.i18n.map["allapps.total-sessions"]},{mData:"u",sType:"numeric",sTitle:jQuery.i18n.map["allapps.total-users"]},{mData:"n",sType:"numeric",sTitle:jQuery.i18n.map["allapps.new-users"]}]})),this.country_dtable.stickyTableHeaders(),this.country_dtable.fnSort([[1,"desc"]]),$("#countries-alternative_wrapper .dataTable-top .search-table-data").hide(),$("#countries-alternative_wrapper .dataTable-top .save-table-data").hide(),$("#countries-alternative_wrapper .dataTable-top .dataTables_paginate").hide(),$("#countries-alternative_wrapper .dataTable-top .DTTT_container").hide(),$("#countries-alternative_wrapper .dataTable-top").append("<div style='font:13px Ubuntu,Helvetica,sans-serif; color:#636363; text-shadow:0 1px #F6F6F6; margin-right:10px; padding: 10px; float: right;'><a href='#/analytics/countries'>"+jQuery.i18n.map["common.go-to-countries"]+"&nbsp;&nbsp;&nbsp;<i class='fa fa-chevron-right' aria-hidden='true'></i></a></div>"),$("#countries-alternative_wrapper .dataTable-top").append("<div style='font:15px Ubuntu,Helvetica,sans-serif; color:#636363; text-shadow:0 1px #F6F6F6; letter-spacing:-1px; margin-left:10px; margin-top: 8px; text-transform: uppercase;'>"+jQuery.i18n.map["sidebar.analytics.countries"]+"</div>"))},destroy:function(){$("#content-top").html("")}}),app.addAppType("mobile",MobileDashboardView),$(document).ready(function(){var a='<a href="#/all" id="allapps-menu" class="item analytics"><div class="logo ion-android-apps"></div><div class="text" data-localize="mobile.allapps.title"></div></a>';$("#mobile-type a").first().before(a),a='<a href="#/analytics/platforms" class="item"><div class="logo platforms"></div><div class="text" data-localize="sidebar.analytics.platforms"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/carriers" class="item"><div class="logo carrier"></div><div class="text" data-localize="sidebar.analytics.carriers"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/versions" class="item"><div class="logo app-versions"></div><div class="text" data-localize="sidebar.analytics.app-versions"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/resolutions" class="item"><div class="logo resolutions"></div><div class="text" data-localize="sidebar.analytics.resolutions"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/devices" class="item"><div class="logo devices"></div><div class="text" data-localize="sidebar.analytics.devices"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/countries" class="item"><div class="logo country"></div><div class="text" data-localize="sidebar.analytics.countries"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/sessions" class="item"><div class="logo sessions"></div><div class="text" data-localize="sidebar.analytics.sessions"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),a='<a href="#/analytics/users" class="item"><div class="logo users"></div><div class="text" data-localize="sidebar.analytics.users"></div></a>',$("#mobile-type #analytics-submenu").prepend(a),$("#mobile-type #engagement-menu").show(),a='<a href="#/analytics/loyalty" class="item"><div class="logo loyalty"></div><div class="text" data-localize="sidebar.analytics.user-loyalty"></div></a><a href="#/analytics/frequency" class="item"><div class="logo frequency"></div><div class="text" data-localize="sidebar.analytics.session-frequency"></div></a><a href="#/analytics/durations" class="item"><div class="logo durations"></div><div class="text" data-localize="sidebar.engagement.durations"></div></a>',$("#mobile-type #engagement-submenu").append(a)}),function(a,b,c){var d=[],e="";a.initialize=function(){return e!=countlyCommon.ACTIVE_APP_ID&&(a.reset(),e=countlyCommon.ACTIVE_APP_ID),b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"latest_users"},dataType:"jsonp",success:function(a){d=a}})},a.refresh=a.initialize,a.reset=function(){d=[]},a.getLatestUsers=function(){return d}}(window.countlyWebDashboard=window.countlyWebDashboard||{},jQuery),window.WebDashboardView=countlyView.extend({selectedView:"#draw-total-sessions",initialize:function(){this.curMap="map-list-sessions",this.template=Handlebars.compile($("#dashboard-template").html())},beforeRender:function(){this.maps={"map-list-sessions":{id:"total",label:jQuery.i18n.map["sidebar.analytics.sessions"],type:"number",metric:"t"},"map-list-users":{id:"total",label:jQuery.i18n.map["sidebar.analytics.users"],type:"number",metric:"u"},"map-list-new":{id:"total",label:jQuery.i18n.map["common.table.new-users"],type:"number",metric:"n"}};var a=[countlyUser.initialize(),countlyDeviceDetails.initialize(),countlyWebDashboard.initialize(),countlyTotalUsers.initialize("users"),countlyTotalUsers.initialize("countries")];return"undefined"!=typeof window.countlyBrowser&&a.push(countlyBrowser.initialize()),"undefined"!=typeof window.countlySources&&a.push(countlySources.initialize()),$.when.apply($,a).then(function(){})},afterRender:function(){if(countlyGlobal.config.use_google){var a=this;countlyLocation.drawGeoChart({height:290,metric:a.maps[a.curMap]})}},pageScript:function(){$("#total-user-estimate-ind").on("click",function(){CountlyHelpers.alert($("#total-user-estimate-exp").html(),"black")}),$(".widget-content .inner").click(function(){$(".big-numbers").removeClass("active"),$(".big-numbers .select").removeClass("selected"),$(this).parent(".big-numbers").addClass("active"),$(this).find(".select").addClass("selected")}),$(".bar-inner").on({mouseenter:function(){var a=$(this).parent().next();a.text($(this).data("item")),a.css({color:$(this).css("background-color")})},mouseleave:function(){var a=$(this).parent().next();a.text(a.data("item")),a.css({color:$(this).parent().find(".bar-inner:first-child").css("background-color")})}});var a=this;$(".big-numbers .inner").click(function(){var b=$(this).find(".select").attr("id");return a.selectedView=="#"+b||(a.selectedView="#"+b,void a.drawGraph())}),countlyGlobal.config.use_google&&(this.countryList(),$(".map-list .cly-button-group .icon-button").click(function(){$(".map-list .cly-button-group .icon-button").removeClass("active"),$(this).addClass("active"),a.curMap=$(this).attr("id"),countlyLocation.refreshGeoChart(a.maps[a.curMap]),a.countryList()})),app.localize()},drawGraph:function(){var a={};switch(this.selectedView){case"#draw-total-users":a=countlySession.getUserDPActive();break;case"#draw-new-users":a=countlySession.getUserDPNew();break;case"#draw-total-sessions":a=countlySession.getSessionDPTotal();break;case"#draw-time-spent":a=countlySession.getDurationDPAvg();break;case"#draw-total-time-spent":a=countlySession.getDurationDP();break;case"#draw-avg-events-served":a=countlySession.getEventsDPAvg()}_.defer(function(){countlyCommon.drawTimeGraph(a.chartDP,"#dashboard-graph")})},renderCommon:function(a,b){var c=countlySession.getSessionData(),d=countlyLocation.getLocationData({maxCountries:7});countlySession.getSessionDPTotal();if(this.locationData=d,c["page-title"]=countlyCommon.getDateRange(),c.usage=[{title:jQuery.i18n.map["common.total-sessions"],"material-icon":"timeline",data:c.usage["total-sessions"],id:"draw-total-sessions",help:"dashboard.total-sessions"},{title:jQuery.i18n.map["common.total-users"],"ion-icon":"ion-person-stalker",data:c.usage["total-users"],id:"draw-total-users",help:"dashboard.total-users"},{title:jQuery.i18n.map["common.new-users"],"ion-icon":"ion-person-add",data:c.usage["new-users"],id:"draw-new-users",help:"dashboard.new-users"},{title:jQuery.i18n.map["dashboard.time-spent"],"ion-icon":"ion-android-time",data:c.usage["total-duration"],id:"draw-total-time-spent",help:"dashboard.total-time-spent"},{title:jQuery.i18n.map["dashboard.avg-time-spent"],"material-icon":"timelapse",data:c.usage["avg-duration-per-session"],id:"draw-time-spent",help:"dashboard.avg-time-spent2"},{title:jQuery.i18n.map["dashboard.avg-reqs-received"],"material-icon":"compare_arrows",data:c.usage["avg-events"],id:"draw-avg-events-served",help:"dashboard.avg-reqs-received"}],c.bars=[{title:jQuery.i18n.map["common.bar.top-platform"],data:countlyDeviceDetails.getPlatformBars(),help:"dashboard.top-platforms"},{title:jQuery.i18n.map["common.bar.top-sources"],data:"undefined"!=typeof countlySources?countlySources.getBars():[],help:"dashboard.top-sources"},{title:jQuery.i18n.map["common.bar.top-browsers"],data:"undefined"!=typeof countlyBrowser?countlyBrowser.getBars():[],help:"dashboard.top-browsers"},{title:jQuery.i18n.map["common.bar.top-users"],data:countlySession.getTopUserBars(),help:"dashboard.top-users"}],this.templateData=c,!a){$(this.el).html(this.template(this.templateData)),countlyGlobal.config.use_google||$(".map-list.geo-switch").hide(),$(".map-list").after('<table id="last-visitors" class="d-table help-zone-vb" cellpadding="0" cellspacing="0"></table>');var e=countlyWebDashboard.getLatestUsers(),f=3,g=[{mData:function(a){var b=a.cc?a.cc:"Unknown";return"Unknown"!=b&&(b='<div class="flag" style="background-image: url(images/flags/'+b.toLowerCase()+'.png);"></div>'+b),"Unknown"!=a.cty&&(b+=" ("+a.cty+")"),b},sType:"string",sTitle:jQuery.i18n.map["countries.table.country"],bSortable:!1},{mData:function(a){return a.p?a.p:jQuery.i18n.map["common.unknown"]},sType:"string",sTitle:jQuery.i18n.map["platforms.table.platform"],bSortable:!1}];e[0]&&e[0].brw&&(g.push({mData:function(a){return a.brw?a.brw:jQuery.i18n.map["common.unknown"]},sType:"string",sTitle:jQuery.i18n.map["web.browser"],bSortable:!1}),f++),e[0]&&e[0].lv&&(g.push({mData:function(a){return a.lv?a.lv:jQuery.i18n.map["common.unknown"]},sType:"string",sTitle:jQuery.i18n.map["web.views.view"],bSortable:!1,sClass:"break web-20"}),f++),e[0]&&e[0].src&&(g.push({mData:function(a){return a.src?0==a.src.indexOf("http")?"<a href='"+a.src+"' target='_blank'>"+("undefined"!=typeof countlySources?countlySources.getSourceName(a.src):a.src)+"</a>":"undefined"!=typeof countlySources?countlySources.getSourceName(a.src):a.src:jQuery.i18n.map["common.unknown"]},sType:"string",sTitle:jQuery.i18n.map["web.from-source"],bSortable:!1,sClass:"break web-20"}),f++),g.push({mData:function(a){return a.sc?a.sc:0},sType:"numeric",sTitle:jQuery.i18n.map["web.total-sessions"],bSortable:!1},{mData:function(a,b){return"display"==b?a.ls?countlyCommon.formatTimeAgo(a.ls):jQuery.i18n.map["web.never"]:a.ls?a.ls:0},sType:"numeric",sTitle:jQuery.i18n.map["web.last-seen"],bSortable:!1},{mData:function(a){return countlyCommon.formatTime(a.tsd?parseInt(a.tsd):0)},sType:"numeric",sTitle:jQuery.i18n.map["web.time-spent"],bSortable:!1}),this.latestdtable=$("#last-visitors").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:e,iDisplayLength:10,aoColumns:g})),this.latestdtable.stickyTableHeaders(),this.latestdtable.fnSort([[f,"desc"]]),$("#last-visitors_wrapper .dataTable-top .search-table-data").hide(),$("#last-visitors_wrapper .dataTable-top .save-table-data").hide(),$("#last-visitors_wrapper .dataTable-top").append("<div style='font:15px Ubuntu,Helvetica,sans-serif; color:#636363; text-shadow:0 1px #F6F6F6; letter-spacing:-1px; margin-left:10px; margin-top: 8px; text-transform: uppercase;'>"+jQuery.i18n.map["web.latest-visitors"]+"</div>"),$(this.selectedView).parents(".big-numbers").addClass("active"),this.pageScript(),b||this.drawGraph()}countlyGlobal.config.use_google||this.countryTable(a)},restart:function(){this.refresh(!0)},refresh:function(a){var b=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=b)return!1;b.renderCommon(!0),CountlyHelpers.refreshTable(b.latestdtable,countlyWebDashboard.getLatestUsers());var c=$("<div>"+b.template(b.templateData)+"</div>");$(".dashboard-summary").replaceWith(c.find(".dashboard-summary")),$(".widget-header .title").replaceWith(c.find(".widget-header .title")),$("#big-numbers-container").find(".big-numbers").each(function(b,d){var e=$(c.find("#big-numbers-container .big-numbers")[b]);if(a)$(d).find(".number").replaceWith(e.find(".number"));else{var f=$(d).find(".number .value"),g=parseFloat(f.text())||0,h=f.text().replace(g,""),i=parseFloat(e.find(".number .value").text()),j=e.find(".number .value").text().replace(i,"");i!=g&&(i<g||j.length&&j!=h?$(d).find(".number").replaceWith(e.find(".number")):jQuery({someValue:g,currEl:f}).animate({someValue:i},{duration:2e3,easing:"easeInOutQuint",step:function(){(i+"").indexOf(".")==-1?this.currEl.text(Math.round(this.someValue)+j):this.currEl.text(parseFloat(this.someValue.toFixed(1))+j)}}))}$(d).find(".trend").replaceWith(e.find(".trend")),$(d).find(".spark").replaceWith(e.find(".spark"))}),b.drawGraph(),$(".usparkline").peity("bar",{width:"100%",height:"30",colour:"#6BB96E",strokeColour:"#6BB96E",strokeWidth:2}),$(".dsparkline").peity("bar",{width:"100%",height:"30",colour:"#C94C4C",strokeColour:"#C94C4C",strokeWidth:2}),0==c.find("#map-list-right").length&&$("#map-list-right").remove(),$("#map-list-right").length?$("#map-list-right").replaceWith(c.find("#map-list-right")):$(".widget.map-list").prepend(c.find("#map-list-right")),b.pageScript()})},countryList:function(){var a=this;$("#map-list-right").empty();for(var b,c=0;c<a.locationData.length;c++)b=a.locationData[c],$("#map-list-right").append('<div class="map-list-item"><div class="flag" style="background-image:url(\''+countlyGlobal.cdn+"images/flags/"+b.code+'.png\');"></div><div class="country-name">'+b.country+'</div><div class="total">'+b[a.maps[a.curMap].metric]+"</div></div>")},countryTable:function(a){var b=this;a?CountlyHelpers.refreshTable(b.country_dtable,countlyLocation.getLocationData({maxCountries:10})):($(".map-list").after('<table id="countries-alternative" class="d-table help-zone-vb" cellpadding="0" cellspacing="0"></table>'),this.country_dtable=$("#countries-alternative").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.locationData,iDisplayLength:10,aoColumns:[{mData:"country_flag",sType:"string",sTitle:jQuery.i18n.map["countries.table.country"]},{mData:"t",sType:"numeric",sTitle:jQuery.i18n.map["allapps.total-sessions"]},{mData:"u",sType:"numeric",sTitle:jQuery.i18n.map["allapps.total-users"]},{mData:"n",sType:"numeric",sTitle:jQuery.i18n.map["allapps.new-users"]}]})),this.country_dtable.stickyTableHeaders(),this.country_dtable.fnSort([[1,"desc"]]),$("#countries-alternative_wrapper .dataTable-top .search-table-data").hide(),$("#countries-alternative_wrapper .dataTable-top .save-table-data").hide(),$("#countries-alternative_wrapper .dataTable-top .dataTables_paginate").hide(),$("#countries-alternative_wrapper .dataTable-top .DTTT_container").hide(),$("#countries-alternative_wrapper .dataTable-top").append("<div style='font:13px Ubuntu,Helvetica,sans-serif; color:#636363; text-shadow:0 1px #F6F6F6; margin-right:10px; padding: 10px; float: right;'><a href='#/analytics/countries'>"+jQuery.i18n.map["common.go-to-countries"]+"&nbsp;&nbsp;&nbsp;<i class='fa fa-chevron-right' aria-hidden='true'></i></a></div>"),$("#countries-alternative_wrapper .dataTable-top").append("<div style='font:15px Ubuntu,Helvetica,sans-serif; color:#636363; text-shadow:0 1px #F6F6F6; letter-spacing:-1px; margin-left:10px; margin-top: 8px; text-transform: uppercase;'>"+jQuery.i18n.map["sidebar.analytics.countries"]+"</div>"))},destroy:function(){$("#content-top").html("")}}),app.addAppType("web",WebDashboardView),$(document).ready(function(){var a='<a href="#/all" id="allapps-menu" class="item analytics active"><div class="logo ion-android-apps"></div><div class="text" data-localize="web.all-websites"></div></a>';$("#web-type a").first().before(a),a='<a href="#/analytics/platforms" class="item"><div class="logo platforms"></div><div class="text" data-localize="sidebar.analytics.platforms"></div></a>',$("#web-type #analytics-submenu").prepend(a),a='<a href="#/analytics/versions" class="item"><div class="logo app-versions"></div><div class="text" data-localize="sidebar.analytics.versions"></div></a>',$("#web-type #analytics-submenu").prepend(a),a='<a href="#/analytics/resolutions" class="item"><div class="logo resolutions"></div><div class="text" data-localize="sidebar.analytics.resolutions"></div></a>',$("#web-type #analytics-submenu").prepend(a),a='<a href="#/analytics/countries" class="item"><div class="logo country"></div><div class="text" data-localize="sidebar.analytics.countries"></div></a>',$("#web-type #analytics-submenu").prepend(a),a='<a href="#/analytics/sessions" class="item"><div class="logo sessions"></div><div class="text" data-localize="sidebar.analytics.sessions"></div></a>',$("#web-type #analytics-submenu").prepend(a),a='<a href="#/analytics/users" class="item"><div class="logo users"></div><div class="text" data-localize="sidebar.analytics.users"></div></a>',$("#web-type #analytics-submenu").prepend(a),$("#web-type #engagement-menu").show(),a='<a href="#/analytics/loyalty" class="item"><div class="logo loyalty"></div><div class="text" data-localize="sidebar.analytics.user-loyalty"></div></a><a href="#/analytics/frequency" class="item"><div class="logo frequency"></div><div class="text" data-localize="sidebar.analytics.session-frequency"></div></a><a href="#/analytics/durations" class="item"><div class="logo durations"></div><div class="text" data-localize="sidebar.engagement.durations"></div></a>',$("#web-type #engagement-submenu").append(a),app.addAppSwitchCallback(function(a){"web"==countlyGlobal.apps[a].type&&(jQuery.i18n.map["drill.lv"]=jQuery.i18n.map["web.drill.lv"],jQuery.i18n.map["views.title"]=jQuery.i18n.map["web.views.title"],jQuery.i18n.map["views.view"]=jQuery.i18n.map["web.views.view"],jQuery.i18n.map["crashes.title"]=jQuery.i18n.map["web.crashes.title"],jQuery.i18n.map["crashes.unresolved-crashes"]=jQuery.i18n.map["web.crashes.unresolved-crashes"],jQuery.i18n.map["crashes.groupid"]=jQuery.i18n.map["web.crashes.groupid"],jQuery.i18n.map["crashes.crashed"]=jQuery.i18n.map["web.crashes.crashed"],jQuery.i18n.map["crashes.last-crash"]=jQuery.i18n.map["web.crashes.last-crash"],jQuery.i18n.map["crashes.online"]=jQuery.i18n.map["web.crashes.online"],jQuery.i18n.map["crashes.muted"]=jQuery.i18n.map["web.crashes.muted"],jQuery.i18n.map["crashes.background"]=jQuery.i18n.map["web.crashes.background"],jQuery.i18n.map["crashes.back-to-crashes"]=jQuery.i18n.map["web.crashes.back-to-crashes"],jQuery.i18n.map["crashes.back-to-crash"]=jQuery.i18n.map["web.crashes.back-to-crash"],jQuery.i18n.map["crashes.crashes-by"]=jQuery.i18n.map["web.crashes.crashes-by"],jQuery.i18n.map["crashes.unique"]=jQuery.i18n.map["web.crashes.unique"],jQuery.i18n.map["crashes.rate"]=jQuery.i18n.map["web.crashes.rate"],jQuery.i18n.map["crashes.top-crash"]=jQuery.i18n.map["web.crashes.top-crash"],jQuery.i18n.map["crashes.new-crashes"]=jQuery.i18n.map["web.crashes.new-crashes"],jQuery.i18n.map["crashes.fatality"]=jQuery.i18n.map["web.crashes.fatality"],jQuery.i18n.map["crashes.nonfatal-crashes"]=jQuery.i18n.map["web.crashes.nonfatal-crashes"],jQuery.i18n.map["crashes.confirm-delete"]=jQuery.i18n.map["web.crashes.confirm-delete"],jQuery.i18n.map["revenue.iap"]=jQuery.i18n.map["web.revenue.iap"],jQuery.i18n.map["revenue.tooltip"]=jQuery.i18n.map["web.revenue.tooltip"],jQuery.i18n.map["placeholder.iap-event-key"]=jQuery.i18n.map["web.placeholder.iap-event-key"],jQuery.i18n.map["placeholder.iap-help"]=jQuery.i18n.map["web.placeholder.iap-help"],jQuery.i18n.map["management-applications.iap-event"]=jQuery.i18n.map["web.management-applications.iap-event"],jQuery.i18n.map["drill.crash"]=jQuery.i18n.map["web.drill.crash"],jQuery.i18n.map["drill.crash-segments"]=jQuery.i18n.map["web.drill.crash-segments"],jQuery.i18n.map["userdata.crashes"]=jQuery.i18n.map["web.userdata.crashes"],jQuery.i18n.map["common.total-users"]=jQuery.i18n.map["web.common.total-users"],jQuery.i18n.map["common.new-users"]=jQuery.i18n.map["web.common.new-users"],jQuery.i18n.map["common.returning-users"]=jQuery.i18n.map["web.common.returning-users"],jQuery.i18n.map["common.number-of-users"]=jQuery.i18n.map["web.common.number-of-users"],jQuery.i18n.map["common.table.total-users"]=jQuery.i18n.map["web.common.table.total-users"],jQuery.i18n.map["common.table.new-users"]=jQuery.i18n.map["web.common.table.new-users"],jQuery.i18n.map["common.table.returning-users"]=jQuery.i18n.map["web.common.table.returning-users"],jQuery.i18n.map["common.bar.top-users"]=jQuery.i18n.map["web.common.bar.top-users"],jQuery.i18n.map["sidebar.analytics.users"]=jQuery.i18n.map["web.sidebar.analytics.users"],jQuery.i18n.map["sidebar.analytics.user-loyalty"]=jQuery.i18n.map["web.sidebar.analytics.user-loyalty"],jQuery.i18n.map["users.title"]=jQuery.i18n.map["web.users.title"],jQuery.i18n.map["allapps.total-users"]=jQuery.i18n.map["web.allapps.total-users"],jQuery.i18n.map["allapps.new-users"]=jQuery.i18n.map["web.allapps.new-users"],jQuery.i18n.map["crashes.users"]=jQuery.i18n.map["web.crashes.users"],jQuery.i18n.map["crashes.affected-users"]=jQuery.i18n.map["web.crashes.affected-users"],jQuery.i18n.map["crashes.public-users"]=jQuery.i18n.map["web.crashes.public-users"],jQuery.i18n.map["drill.users"]=jQuery.i18n.map["web.drill.users"],jQuery.i18n.map["drill.times-users"]=jQuery.i18n.map["web.drill.times-users"],jQuery.i18n.map["drill.sum-users"]=jQuery.i18n.map["web.drill.sum-users"],jQuery.i18n.map["funnels.total-users"]=jQuery.i18n.map["web.funnels.total-users"],jQuery.i18n.map["funnels.users"]=jQuery.i18n.map["web.funnels.users"],jQuery.i18n.map["common.online-users"]=jQuery.i18n.map["web.common.online-users"],
jQuery.i18n.map["live.new-users"]=jQuery.i18n.map["web.live.new-users"],jQuery.i18n.map["populator.amount-users"]=jQuery.i18n.map["web.populator.amount-users"],jQuery.i18n.map["sidebar.engagement.retention"]=jQuery.i18n.map["web.sidebar.engagement.retention"],jQuery.i18n.map["retention.users-first-session"]=jQuery.i18n.map["web.retention.users-first-session"],jQuery.i18n.map["userdata.title"]=jQuery.i18n.map["web.userdata.title"],jQuery.i18n.map["userdata.users"]=jQuery.i18n.map["web.userdata.users"],jQuery.i18n.map["userdata.user"]=jQuery.i18n.map["web.userdata.user"],jQuery.i18n.map["userdata.back-to-list"]=jQuery.i18n.map["web.userdata.back-to-list"],jQuery.i18n.map["userdata.no-users"]=jQuery.i18n.map["web.userdata.no-users"],jQuery.i18n.map["attribution.per-user"]=jQuery.i18n.map["web.attribution.per-user"],jQuery.i18n.map["attribution.user-conversion"]=jQuery.i18n.map["web.attribution.user-conversion"],jQuery.i18n.map["attribution.organic"]=jQuery.i18n.map["web.attribution.organic"],jQuery.i18n.map["reports.total_users"]=jQuery.i18n.map["web.reports.total_users"],jQuery.i18n.map["reports.new_users"]=jQuery.i18n.map["web.reports.new_users"],jQuery.i18n.map["reports.paying_users"]=jQuery.i18n.map["web.reports.paying_users"],jQuery.i18n.map["reports.messaging_users"]=jQuery.i18n.map["web.reports.messaging_users"],jQuery.i18n.map["reports.returning_users"]=jQuery.i18n.map["web.reports.returning_users"],jQuery.i18n.map["common.per-user"]=jQuery.i18n.map["web.common.per-user"],jQuery.i18n.map["common.per-paying-user"]=jQuery.i18n.map["web.common.per-paying-user"],jQuery.i18n.map["common.users"]=jQuery.i18n.map["web.common.users"],jQuery.i18n.map["attribution.installs"]=jQuery.i18n.map["web.attribution.installs"],jQuery.i18n.map["attribution.cost-install"]=jQuery.i18n.map["web.attribution.cost-install"],jQuery.i18n.map["sources.title"]=jQuery.i18n.map["web.sources.title"],jQuery.i18n.map["sources.source"]=jQuery.i18n.map["web.sources.source"])})}),function(a,b,c){var d={},e={},f={},g=[];a.initialize=function(a){return b.ajax({type:"GET",url:countlyCommon.API_URL+"/o/plugins",data:{api_key:countlyGlobal.member.api_key},success:function(a){d=a}})},a.toggle=function(a,c){b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/plugins",data:{plugin:JSON.stringify(a),api_key:countlyGlobal.member.api_key},success:function(a){c&&c(a)},error:function(a,d,e){var f=d+" ";f+=a.status+": "+b(a.responseText).text(),e&&(f+=e+"\n"),c&&c(f)}})},a.initializeConfigs=function(a){return b.when(b.ajax({type:"GET",url:countlyCommon.API_URL+"/o/themes",data:{api_key:countlyGlobal.member.api_key},success:function(a){g=a}}),b.ajax({type:"GET",url:countlyCommon.API_URL+"/o/configs",data:{api_key:countlyGlobal.member.api_key},success:function(a){e=a}})).then(function(){return!0})},a.updateConfigs=function(a,c){b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/configs",data:{configs:JSON.stringify(a),api_key:countlyGlobal.member.api_key},success:function(a){e=a,c&&c(null,a)},error:function(a){c&&c(!0,a)}})},a.initializeUserConfigs=function(a){return b.when(b.ajax({type:"GET",url:countlyCommon.API_URL+"/o/themes",data:{api_key:countlyGlobal.member.api_key},success:function(a){g=a}}),b.ajax({type:"GET",url:countlyCommon.API_URL+"/o/userconfigs",data:{api_key:countlyGlobal.member.api_key},success:function(a){f=a}})).then(function(){return!0})},a.updateUserConfigs=function(a,c){b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/userconfigs",data:{configs:JSON.stringify(a),api_key:countlyGlobal.member.api_key},success:function(a){f=a,c&&c(null,a)},error:function(a){c&&c(!0,a)}})},a.getData=function(){return d},a.getConfigsData=function(){return e},a.getUserConfigsData=function(){return f},a.getThemeList=function(){return g}}(window.countlyPlugins=window.countlyPlugins||{},jQuery),window.PluginsView=countlyView.extend({initialize:function(){this.filter=store.get("countly_pluginsfilter")?store.get("countly_pluginsfilter"):"plugins-all"},beforeRender:function(){if(this.template)return $.when(countlyPlugins.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/plugins/templates/plugins.html",function(b){a.template=Handlebars.compile(b)}),countlyPlugins.initialize()).then(function(){})},renderCommon:function(a){var b=countlyPlugins.getData();this.templateData={"page-title":jQuery.i18n.map["plugins.title"]};var c=this;a||($(this.el).html(this.template(this.templateData)),$("#"+this.filter).addClass("selected").addClass("active"),$.fn.dataTableExt.afnFiltering.push(function(a,b,d){return!$(a.nTable).hasClass("plugins-filter")||("plugins-enabled"==c.filter?b[4]:"plugins-disabled"!=c.filter||!b[4])}),this.dtable=$("#plugins-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b,aoColumns:[{mData:function(a,b){return a.title},sType:"string",sTitle:jQuery.i18n.map["plugins.name"]},{mData:function(a,b){return a.description},sType:"string",sTitle:jQuery.i18n.map["plugins.description"]},{mData:function(a,b){return a.version},sType:"string",sTitle:jQuery.i18n.map["plugins.version"],sClass:"center"},{mData:function(a,b){return a.enabled?jQuery.i18n.map["plugins.enabled"]:jQuery.i18n.map["plugins.disabled"]},sType:"string",sTitle:jQuery.i18n.map["plugins.status"],sClass:"center"},{mData:function(a,b){if("display"==b){var c=a.prepackaged?"disabled":"btn-plugins";return a.enabled?'<a class="icon-button red btn-header '+c+'" id="plugin-'+a.code+'">'+jQuery.i18n.map["plugins.disable"]+"</a>":'<a class="icon-button green btn-header '+c+'" id="plugin-'+a.code+'">'+jQuery.i18n.map["plugins.enable"]+"</a>"}return a.enabled},sType:"string",sTitle:jQuery.i18n.map["plugins.state"],sClass:"shrink center"},{mData:function(a,b){return""!=a.homepage?'<a class="icon-button btn-header light" href="'+a.homepage+'" target="_blank">'+jQuery.i18n.map["plugins.homepage"]+"</a>":""},sType:"string",sTitle:jQuery.i18n.map["plugins.homepage"],sClass:"shrink center"}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[0,"asc"]]))},refresh:function(){},togglePlugin:function(a){var b=$("#overlay").clone();$("body").append(b),b.show();var c=$(this.el).find("#loader");c.show(),countlyPlugins.toggle(a,function(a){var d={clearAll:!0};if("Success"==a||"Errors"==a){var e=10;"Success"==a?(d.title=jQuery.i18n.map["plugins.success"],d.message=jQuery.i18n.map["plugins.restart"]+" "+e+" "+jQuery.i18n.map["plugins.seconds"],d.info=jQuery.i18n.map["plugins.finish"],d.delay=1e3*e):"Errors"==a&&(d.title=jQuery.i18n.map["plugins.errors"],d.message=jQuery.i18n.map["plugins.errors-msg"],d.info=jQuery.i18n.map["plugins.restart"]+" "+e+" "+jQuery.i18n.map["plugins.seconds"],d.sticky=!0,d.type="error"),setTimeout(function(){window.location.reload(!0)},1e3*e)}else b.hide(),c.hide(),d.title=jQuery.i18n.map["plugins.error"],d.message=a,d.info=jQuery.i18n.map["plugins.retry"],d.sticky=!0,d.type="error";CountlyHelpers.notify(d)})},filterPlugins:function(a){this.filter=a,store.set("countly_pluginsfilter",a),$("#"+this.filter).addClass("selected").addClass("active"),this.dtable.fnDraw()}}),window.ConfigurationsView=countlyView.extend({userConfig:!1,initialize:function(){this.predefinedInputs={},this.predefinedLabels={frontend:jQuery.i18n.map["configs.frontend"],api:jQuery.i18n.map["configs.api"],apps:jQuery.i18n.map["configs.apps"],logs:jQuery.i18n.map["configs.logs"],"frontend-production":jQuery.i18n.map["configs.frontend-production"],"frontend-session_timeout":jQuery.i18n.map["configs.frontend-session_timeout"],"frontend-theme":jQuery.i18n.map["configs.frontend-theme"],"frontend-use_google":jQuery.i18n.map["configs.frontend-use_google"],"frontend-code":jQuery.i18n.map["configs.frontend-code"],"api-domain":jQuery.i18n.map["configs.api-domain"],"api-safe":jQuery.i18n.map["configs.api-safe"],"api-session_duration_limit":jQuery.i18n.map["configs.api-session_duration_limit"],"api-city_data":jQuery.i18n.map["configs.api-city_data"],"api-event_limit":jQuery.i18n.map["configs.api-event_limit"],"api-event_segmentation_limit":jQuery.i18n.map["configs.api-event_segmentation_limit"],"api-event_segmentation_value_limit":jQuery.i18n.map["configs.api-event_segmentation_value_limit"],"api-sync_plugins":jQuery.i18n.map["configs.api-sync_plugins"],"api-session_cooldown":jQuery.i18n.map["configs.api-session_cooldown"],"api-total_users":jQuery.i18n.map["configs.api-total_users"],"apps-country":jQuery.i18n.map["configs.apps-country"],"apps-category":jQuery.i18n.map["configs.apps-category"]},this.configsData={},this.cache={},this.changes={},this.registerInput("apps-category",function(a){var b=app.manageAppsView.getAppCategories(),c='<div class="cly-select" id="apps-category"><div class="select-inner"><div class="text-container">';c+=b[a]?'<div class="text">'+b[a]+"</div>":'<div class="text"></div>',c+='</div><div class="right combo"></div></div><div class="select-items square"><div>';for(var d in b)c+='<div data-value="'+d+'" class="segmentation-option item">'+b[d]+"</div>";return c+="</div></div></div>"}),this.registerInput("apps-country",function(a){var b=app.manageAppsView.getTimeZones(),c='<div class="cly-select" id="apps-country"><div class="select-inner"><div class="text-container">';c+=b[a]?'<div class="text"><div class="flag" style="background-image:url(images/flags/'+a.toLowerCase()+'.png)"></div>'+b[a].n+"</div>":'<div class="text"></div>',c+='</div><div class="right combo"></div></div><div class="select-items square"><div>';for(var d in b)c+='<div data-value="'+d+'" class="segmentation-option item"><div class="flag" style="background-image:url(images/flags/'+d.toLowerCase()+'.png)"></div>'+b[d].n+"</div>";return c+="</div></div></div>"}),this.registerInput("frontend-theme",function(a){var b=countlyPlugins.getThemeList(),c='<div class="cly-select" id="frontend-theme"><div class="select-inner"><div class="text-container">';c+=a&&a.length?'<div class="text">'+a+"</div>":'<div class="text">'+jQuery.i18n.map["configs.no-theme"]+"</div>",c+='</div><div class="right combo"></div></div><div class="select-items square"><div>';for(var d=0;d<b.length;d++)c+=""==b[d]?'<div data-value="" class="segmentation-option item">'+jQuery.i18n.map["configs.no-theme"]+"</div>":'<div data-value="'+b[d]+'" class="segmentation-option item">'+b[d]+"</div>";return c+="</div></div></div>"}),this.registerInput("logs-default",function(a){var b=["debug","info","warn","error"],c='<div class="cly-select" id="logs-default"><div class="select-inner"><div class="text-container">';c+=a&&a.length?'<div class="text">'+jQuery.i18n.map["configs.logs."+a]+"</div>":'<div class="text">'+Query.i18n.map["configs.logs.warn"]+"</div>",c+='</div><div class="right combo"></div></div><div class="select-items square"><div>';for(var d=0;d<b.length;d++)c+='<div data-value="'+b[d]+'" class="segmentation-option item">'+jQuery.i18n.map["configs.logs."+b[d]]+"</div>";return c+="</div></div></div>"}),this.registerInput("apps-timezone",function(a){return null})},beforeRender:function(){if(this.template)return this.userConfig?$.when(countlyPlugins.initializeUserConfigs()).then(function(){}):$.when(countlyPlugins.initializeConfigs()).then(function(){});var a=this;return this.userConfig?$.when($.get(countlyGlobal.path+"/plugins/templates/configurations.html",function(b){a.template=Handlebars.compile(b)}),countlyPlugins.initializeUserConfigs()).then(function(){}):$.when($.get(countlyGlobal.path+"/plugins/templates/configurations.html",function(b){a.template=Handlebars.compile(b)}),countlyPlugins.initializeConfigs()).then(function(){})},renderCommon:function(a){this.userConfig?this.configsData=countlyPlugins.getUserConfigsData():this.configsData=countlyPlugins.getConfigsData();var b,c=jQuery.i18n.map["plugins.configs"];this.userConfig&&(c=jQuery.i18n.map["plugins.user-configs"]),this.namespace&&this.configsData[this.namespace]?(b=this.generateConfigsTable(this.configsData[this.namespace],"-"+this.namespace),c=this.getInputLabel(this.namespace,this.namespace)+" "+c):b=this.generateConfigsTable(this.configsData),this.templateData={"page-title":c,configs:b,namespace:this.namespace,user:this.userConfig};var d=this;a||($(this.el).html(this.template(this.templateData)),this.changes={},this.cache=JSON.parse(JSON.stringify(this.configsData)),$(".configs #username").val($("#menu-username").text()),$(".configs #api-key").val($("#user-api-key").val()),$("#configs-back").click(function(){window.history.back()}),$(".boolean-selector>.button").click(function(){var a={"plugins.enable":!0,"plugins.disable":!1},b=$(this);if(b.hasClass("selected"))return!0;var c=b.parent(".button-selector").find(">.button.selected");c.removeClass("selected").removeClass("active"),b.addClass("selected").addClass("active");var e=$(this).parent(".button-selector").attr("id"),f=a[$(this).data("localize")];d.updateConfig(e,f)}),$(".configs input").keyup(function(){var a=$(this).attr("id"),b=$(this).val();"number"==$(this).attr("type")&&(b=parseFloat(b)),d.updateConfig(a,b)}),$(".configs .segmentation-option").on("click",function(){var a=$(this).closest(".cly-select").attr("id"),b=$(this).data("value");d.updateConfig(a,b)}),$(".configs .account-settings .input input").keyup(function(){$("#configs-apply-changes").removeClass("settings-changes"),$(".configs .account-settings .input input").each(function(){var a=$(this).attr("id");switch(a){case"username":this.value!=$("#menu-username").text()&&$("#configs-apply-changes").addClass("settings-changes");break;case"api-key":this.value!=$("#user-api-key").val()&&$("#configs-apply-changes").addClass("settings-changes");break;default:""!=this.value&&$("#configs-apply-changes").addClass("settings-changes")}$("#configs-apply-changes").hasClass("settings-changes")?$("#configs-apply-changes").show():$("#configs-apply-changes").hasClass("configs-changes")||$("#configs-apply-changes").hide()})}),$("#configs-apply-changes").click(function(){if(d.userConfig){var a=$(".configs #username").val(),b=$(".configs #old_pwd").val(),c=$(".configs #new_pwd").val(),e=$(".configs #re_new_pwd").val(),f=$(".configs #api-key").val(),g=!1;if((c.length&&e.length||f.length||a.length)&&(g=!0),(c.length||e.length)&&!b.length)return CountlyHelpers.notify({title:jQuery.i18n.map["user-settings.old-password-match"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}),!0;if(c!=e)return CountlyHelpers.notify({title:jQuery.i18n.map["user-settings.password-match"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}),!0;$.ajax({type:"POST",url:countlyGlobal.path+"/user/settings",data:{username:a,old_pwd:b,new_pwd:c,api_key:f,_csrf:countlyGlobal.csrf_token},success:function(b){$(".configs #settings-save-result");return"username-exists"==b?(CountlyHelpers.notify({title:jQuery.i18n.map["management-users.username.exists"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}),!0):b?($(".configs #old_pwd").val(""),$(".configs #new_pwd").val(""),$(".configs #re_new_pwd").val(""),$("#menu-username").text(a),$("#user-api-key").val(f),countlyGlobal.member.username=a,countlyGlobal.member.api_key=f,void countlyPlugins.updateUserConfigs(d.changes,function(a,b){a&&!g?CountlyHelpers.notify({title:jQuery.i18n.map["configs.not-changed"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}):(CountlyHelpers.notify({title:jQuery.i18n.map["configs.changed"],message:jQuery.i18n.map["configs.saved"]}),d.configsData=JSON.parse(JSON.stringify(d.cache)),$("#configs-apply-changes").hide(),d.changes={})})):(CountlyHelpers.notify({title:jQuery.i18n.map["user-settings.alert"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}),!0)}})}else countlyPlugins.updateConfigs(d.changes,function(a,b){a?CountlyHelpers.notify({title:jQuery.i18n.map["configs.not-changed"],message:jQuery.i18n.map["configs.not-saved"],type:"error"}):(CountlyHelpers.notify({title:jQuery.i18n.map["configs.changed"],message:jQuery.i18n.map["configs.saved"]}),d.configsData=JSON.parse(JSON.stringify(d.cache)),$("#configs-apply-changes").hide(),d.changes={})})}))},updateConfig:function(a,b){for(var c=a.split("-"),d=this.cache,e=0;e<c.length&&"undefined"!=typeof d[c[e]];e++)e==c.length-1?d[c[e]]=b:d=d[c[e]];for(var d=this.changes,e=0;e<c.length;e++)e==c.length-1?d[c[e]]=b:"undefined"==typeof d[c[e]]&&(d[c[e]]={}),d=d[c[e]];$("#configs-apply-changes").removeClass("configs-changes"),JSON.stringify(this.configsData)!=JSON.stringify(this.cache)?$("#configs-apply-changes").addClass("configs-changes"):this.changes={},$("#configs-apply-changes").hasClass("configs-changes")?$("#configs-apply-changes").show():$("#configs-apply-changes").hasClass("settings-changes")||$("#configs-apply-changes").hide()},generateConfigsTable:function(a,b){b=b||"";var c=!0;""!=b&&(c=!1);var d="";c||(d+="<table class='d-table help-zone-vb' cellpadding='0' cellspacing='0'>");for(var e in a)if("object"==typeof a[e])if(null!=a[e]){var f=this.getInputLabel((b+"-"+e).substring(1),e);f&&(d+="<tr><td>"+f+"</td><td>"+this.generateConfigsTable(a[e],b+"-"+e)+"</td></tr>")}else{var g=this.getInputByType((b+"-"+e).substring(1),""),f=this.getInputLabel((b+"-"+e).substring(1),e);g&&f&&(d+="<tr><td>"+f+"</td><td>"+g+"</td></tr>")}else{var g=this.getInputByType((b+"-"+e).substring(1),a[e]),f=this.getInputLabel((b+"-"+e).substring(1),e);g&&f&&(d+="<tr><td>"+f+"</td><td>"+g+"</td></tr>")}return c||(d+="</table>"),d},getInputLabel:function(a,b){var c=a.split("-")[0];if("frontend"!=c&&"api"!=c&&"apps"!=c&&"logs"!=c&&countlyGlobal.plugins.indexOf(c)==-1)return null;var d="";return jQuery.i18n.map["configs.help."+a]&&(d="<span class='config-help'>"+jQuery.i18n.map["configs.help."+a]+"</span>"),"undefined"!=typeof this.predefinedLabels[a]?"<div>"+this.predefinedLabels[a]+"</div>"+d:"<div>"+b+"</div>"+d},getInputByType:function(a,b){if(this.predefinedInputs[a])return this.predefinedInputs[a](b);if("boolean"==typeof b){var c='<div id="'+a+'" class="button-selector boolean-selector">';return b?(c+='<div class="button active selected" data-localize="plugins.enable"></div>',c+='<div class="button" data-localize="plugins.disable"></div>'):(c+='<div class="button" data-localize="plugins.enable"></div>',c+='<div class="button active selected" data-localize="plugins.disable"></div>'),c+="</div>"}return"number"==typeof b?"<input type='number' id='"+a+"' value='"+b+"'/>":"<input type='text' id='"+a+"' value='"+b+"'/>"},registerInput:function(a,b){this.predefinedInputs[a]=b},registerLabel:function(a,b){this.predefinedLabels[a]=b},refresh:function(){}}),app.pluginsView=new PluginsView,app.configurationsView=new ConfigurationsView,countlyGlobal.member.global_admin&&(app.route("/manage/plugins","plugins",function(){this.renderWhenReady(this.pluginsView)}),app.route("/manage/configurations","configurations",function(){this.configurationsView.namespace=null,this.configurationsView.userConfig=!1,this.renderWhenReady(this.configurationsView)}),app.route("/manage/configurations/:namespace","configurations_namespace",function(a){this.configurationsView.namespace=a,this.configurationsView.userConfig=!1,this.renderWhenReady(this.configurationsView)})),app.route("/manage/user-settings","user-settings",function(){this.configurationsView.namespace=null,this.configurationsView.userConfig=!0,this.renderWhenReady(this.configurationsView)}),app.route("/manage/user-settings/:namespace","user-settings_namespace",function(a){this.configurationsView.namespace=a,this.configurationsView.userConfig=!0,this.renderWhenReady(this.configurationsView)}),app.addPageScript("/manage/plugins",function(){$("#plugins-selector").find(">.button").click(function(){if($(this).hasClass("selected"))return!0;$(".plugins-selector").removeClass("selected").removeClass("active");var a=$(this).attr("id");app.activeView.filterPlugins(a)});var a=countlyGlobal.plugins.slice();$("#plugins-table").on("click",".btn-plugins",function(){var b=!1,c=this.id.toString().replace(/^plugin-/,"");if($(this).hasClass("green"))$(this).removeClass("green").addClass("red"),$(this).text(jQuery.i18n.map["plugins.disable"]),a.push(c);else if($(this).hasClass("red")){$(this).removeClass("red").addClass("green"),$(this).text(jQuery.i18n.map["plugins.enable"]);var d=$.inArray(c,a);a.splice(d,1)}if(a.length!=countlyGlobal.plugins.length)b=!0;else for(var e=0;e<a.length;e++)if($.inArray(a[e],countlyGlobal.plugins)==-1){b=!0;break}b?$(".btn-plugin-enabler").show():$(".btn-plugin-enabler").hide()}),$("#plugins-selector").on("click",".btn-plugin-enabler",function(){var a={};$(".btn-plugins").each(function(){var b=this.id.toString().replace(/^plugin-/,""),c=!$(this).hasClass("green");a[b]=c});var b=jQuery.i18n.map["plugins.confirm"],c={title:jQuery.i18n.map["plugins.processing"],message:jQuery.i18n.map["plugins.wait"],info:jQuery.i18n.map["plugins.hold-on"],sticky:!0};CountlyHelpers.confirm(b,"red",function(b){return!b||(CountlyHelpers.notify(c),void app.activeView.togglePlugin(a))})})}),$(document).ready(function(){if(countlyGlobal.member&&countlyGlobal.member.global_admin){var a='<a href="#/manage/plugins" class="item"><div class="logo-icon fa fa-puzzle-piece"></div><div class="text" data-localize="plugins.title"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a);var a='<a href="#/manage/configurations" class="item"><div class="logo-icon fa fa-wrench"></div><div class="text" data-localize="plugins.configs"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a)}}),CountlyHelpers.createMetricModel(window.countlyDensity=window.countlyDensity||{},{name:"density",estOverrideMetric:"densities"},jQuery),window.DensityView=countlyView.extend({beforeRender:function(){return $.when(countlyDensity.initialize(),countlyTotalUsers.initialize("densities")).then(function(){})},renderCommon:function(a){var b=countlyDensity.getData();this.templateData={"page-title":jQuery.i18n.map["density.title"],"logo-class":"densities","graph-type-double-pie":!0,"pie-titles":{left:jQuery.i18n.map["common.total-users"],right:jQuery.i18n.map["common.new-users"]},"chart-helper":"density.chart"},a||($(this.el).html(this.template(this.templateData)),"undefined"!=typeof addDrill&&$(".widget-header .left .title").after(addDrill("up.dnst")),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.chartData,aoColumns:[{mData:"density",sType:"session-duration",sTitle:jQuery.i18n.map["density.table.density"]},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-sessions"]},{mData:"u",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-users"]},{mData:"n",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.new-users"]}]})),$(".d-table").stickyTableHeaders(),countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"))},refresh:function(){var a=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0),newPage=$("<div>"+a.template(a.templateData)+"</div>"),$(a.el).find(".dashboard-summary").replaceWith(newPage.find(".dashboard-summary"));var b=countlyDensity.getData();countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),CountlyHelpers.refreshTable(a.dtable,b.chartData)})}}),app.densityView=new DensityView,app.route("/analytics/density","desity",function(){this.renderWhenReady(this.densityView)}),$(document).ready(function(){var a='<a href="#/analytics/density" class="item"><div class="logo densities"></div><div class="text" data-localize="sidebar.analytics.densities"></div></a>';$("#mobile-type #analytics-submenu").append(a)}),function(){function a(a){return b&&b[a]?b[a].englishName:a}var b;$.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/langmap",dataType:"json",success:function(a){b=a}}),CountlyHelpers.createMetricModel(window.countlyLanguage=window.countlyLanguage||{getLanguageName:a},{name:"langs",estOverrideMetric:"languages"},jQuery,a)}(),window.LanguageView=countlyView.extend({beforeRender:function(){return $.when(countlyLanguage.initialize(),countlyTotalUsers.initialize("languages")).then(function(){})},renderCommon:function(a){var b=countlyLanguage.getData();this.templateData={"page-title":jQuery.i18n.map["languages.title"],"logo-class":"languages","graph-type-double-pie":!0,"pie-titles":{left:jQuery.i18n.map["common.total-users"],right:jQuery.i18n.map["common.new-users"]},"chart-helper":"languages.chart","table-helper":""},b.chartData.forEach(function(a){a.language in countlyGlobalLang.languages&&(a.language=countlyGlobalLang.languages[a.language].englishName)}),a||($(this.el).html(this.template(this.templateData)),"undefined"!=typeof addDrill&&$(".widget-header .left .title").after(addDrill("up.la")),countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.chartData,aoColumns:[{mData:"langs",sTitle:jQuery.i18n.map["languages.table.language"]},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-sessions"]},{mData:"u",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-users"]},{mData:"n",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.new-users"]}]})),$(".d-table").stickyTableHeaders())},refresh:function(){var a=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0),newPage=$("<div>"+a.template(a.templateData)+"</div>");var b=countlyLanguage.getData();countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),CountlyHelpers.refreshTable(a.dtable,b.chartData),app.localize()})}}),app.languageView=new LanguageView,app.route("/analytics/languages","languages",function(){this.renderWhenReady(this.languageView)}),$(document).ready(function(){Handlebars.registerHelper("languageTitle",function(a,b){return countlyGlobalLang.languages[a]});var a='<a href="#/analytics/languages" class="item"><div class="logo languages"></div><div class="text" data-localize="sidebar.analytics.languages"></div></a>';$(".sidebar-menu:not(#iot-type) #analytics-submenu").append(a)}),CountlyHelpers.createMetricModel(window.countlyBrowser=window.countlyBrowser||{},{name:"browser",estOverrideMetric:"browsers"},jQuery),window.BrowserView=countlyView.extend({beforeRender:function(){return $.when(countlyBrowser.initialize(),countlyTotalUsers.initialize("browsers")).then(function(){})},renderCommon:function(a){var b=countlyBrowser.getData();this.templateData={"page-title":jQuery.i18n.map["browser.title"],"font-logo-class":"fa-globe","graph-type-double-pie":!0,"pie-titles":{left:jQuery.i18n.map["common.total-users"],right:jQuery.i18n.map["common.new-users"]},"chart-helper":"browser.chart"},a||($(this.el).html(this.template(this.templateData)),"undefined"!=typeof addDrill&&$(".widget-header .left .title").after(addDrill("up.brw")),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.chartData,aoColumns:[{mData:"browser",sType:"session-duration",sTitle:jQuery.i18n.map["browser.table.browser"]},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-sessions"]},{mData:"u",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-users"]},{mData:"n",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.new-users"]}]})),$(".d-table").stickyTableHeaders(),countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"))},refresh:function(){var a=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0),newPage=$("<div>"+a.template(a.templateData)+"</div>"),$(a.el).find(".dashboard-summary").replaceWith(newPage.find(".dashboard-summary"));var b=countlyBrowser.getData();countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),CountlyHelpers.refreshTable(a.dtable,b.chartData)})}}),app.browserView=new BrowserView,app.route("/analytics/browser","browser",function(){this.renderWhenReady(this.browserView)}),$(document).ready(function(){var a='<a href="#/analytics/browser" class="item"><div class="logo-icon fa fa-globe"></div><div class="text" data-localize="browser.title"></div></a>';$("#web-type #analytics-submenu").append(a)}),function(){function a(a,c,d){if(a=a.replace(/&#46;/g,"."),"mobile"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type){if(!isNaN(parseFloat(a))&&isFinite(a))return jQuery.i18n.map["common.unknown"];if(d)return a;if(b&&b[a])return b[a];for(var e in b)if(0==a.indexOf(e))return b[e];return a}if(a.indexOf("://")==-1)return d?jQuery.i18n.map["sources.organic"]+" ("+a+")":jQuery.i18n.map["sources.direct"];if(d)return a;a=a.replace("://www.","://");var f=a.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i),g=f&&f[1]||a;return 0==g.indexOf("google.")?g="Google":g.indexOf("search.yahoo.")>-1?g="Yahoo":g.indexOf("search.ask.")>-1&&(g="Ask"),g}var b;$.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/sources",dataType:"json",success:function(a){b=a}}),window.countlySources=window.countlySources||{},window.countlySources.getSourceName=a,CountlyHelpers.createMetricModel(window.countlySources,{name:"sources",estOverrideMetric:"sources"},jQuery,a)}(),window.SourcesView=countlyView.extend({beforeRender:function(){return this.dataMap={},$.when(countlySources.initialize(),countlyTotalUsers.initialize("sources")).then(function(){})},renderCommon:function(a){if(this.updateDataMap(),this.templateData={"page-title":jQuery.i18n.map["sources.title"],"font-logo-class":"fa-crosshairs","graph-type-double-pie":!0,"pie-titles":{left:jQuery.i18n.map["common.total-users"],right:jQuery.i18n.map["common.new-users"]},"chart-helper":"sources.chart"},!a){var b=countlySources.getData();$(this.el).html(this.template(this.templateData)),"undefined"!=typeof addDrill&&$(".widget-header .left .title").after(addDrill("up.src")),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.chartData,fnRowCallback:function(a,b,c,d){$(a).attr("id",b.sources.replace(/\./g,"-").replace(/ /g,"_").replace(/[^\w]/g,""))},aoColumns:[{mData:"sources",sType:"string",sTitle:jQuery.i18n.map["sources.source"],sClass:"break source-40"},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-sessions"],sClass:"source-20"},{mData:"u",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-users"],sClass:"source-20"},{mData:"n",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.new-users"],sClass:"source-20"}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[1,"desc"]]),this.dtable.addClass("source-table"),countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),CountlyHelpers.expandRows(this.dtable,this.expandTable,this)}},refresh:function(){var a=this;$.when(this.beforeRender()).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0),newPage=$("<div>"+a.template(a.templateData)+"</div>"),$(a.el).find(".dashboard-summary").replaceWith(newPage.find(".dashboard-summary"));var b=countlySources.getData();countlyCommon.drawGraph(b.chartDPTotal,"#dashboard-graph","pie"),
countlyCommon.drawGraph(b.chartDPNew,"#dashboard-graph2","pie"),CountlyHelpers.refreshTable(a.dtable,b.chartData),CountlyHelpers.reopenRows(a.dtable,a.expandTable,a)})},expandTable:function(a,b){var c="";if(a&&a.sources&&b.dataMap[a.sources]){c+='<div class="datatablesubrow"><table cellpadding="5" cellspacing="0" border="0" class="subtable">',c+="<tr>",c+='<th class="source-40">'+jQuery.i18n.map["sources.source"]+"</th>",c+='<th class="source-20">'+jQuery.i18n.map["common.table.total-sessions"]+"</th>",c+='<th class="source-20">'+jQuery.i18n.map["common.table.total-users"]+"</th>",c+='<th class="source-20">'+jQuery.i18n.map["common.table.new-users"]+"</th>",c+="</tr>";for(var d in b.dataMap[a.sources])c+="<tr>",c+="mobile"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type||b.dataMap[a.sources][d].sources.indexOf("://")==-1?'<td class="source-40">'+b.dataMap[a.sources][d].sources+"</td>":'<td class="source-40"><a href="'+b.dataMap[a.sources][d].sources+'" target="_blank">'+b.dataMap[a.sources][d].sources+"</a></td>",c+='<td class="source-20">'+b.dataMap[a.sources][d].t+"</td>",c+='<td class="source-20">'+b.dataMap[a.sources][d].u+"</td>",c+='<td class="source-20">'+b.dataMap[a.sources][d].n+"</td>",c+="</tr>";c+="</table></div>"}return c},updateDataMap:function(){var a,b=countlySources.getData(!0).chartData;for(var c in b)a=countlySources.getSourceName(b[c].sources),this.dataMap[a]||(this.dataMap[a]={}),this.dataMap[a][b[c].sources]=b[c]}}),app.sourcesView=new SourcesView,app.route("/analytics/sources","sources",function(){this.renderWhenReady(this.sourcesView)}),$(document).ready(function(){var a='<a href="#/analytics/sources" class="item"><div class="logo-icon fa fa-crosshairs"></div><div class="text" data-localize="sources.title"></div></a>';$("#web-type #analytics-submenu").append(a),$("#mobile-type #analytics-submenu").append(a)}),function(a,b,c){function d(){h=g.meta&&g.meta[b]?g.meta[b]:[]}function e(){g.meta&&(h=countlyCommon.union(h,g.meta[b]))}var f={},g={},h=[],i=[],j={},k=0,l=!1,m=null,n=[],o=null;a.initialize=function(){return l&&o==countlyCommon.getPeriodForAjax()&&k==countlyCommon.ACTIVE_APP_KEY?this.refresh():(o=countlyCommon.getPeriodForAjax(),countlyCommon.DEBUG?(g={2012:{}},!0):(k=countlyCommon.ACTIVE_APP_KEY,l=!0,c.when(c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"get_view_segments",period:o},dataType:"jsonp",success:function(a){if(a&&a.segments){for(var b=0;b<a.segments.length;b++)a.segments[b]=a.segments[b].replace(/&#46;/g,".");n=a.segments}}}),c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:b,segmentation:m,period:o},dataType:"jsonp",success:function(a){g=a,d()}})).then(function(){return!0})))},a.refresh=function(){return f=countlyCommon.periodObj,countlyCommon.DEBUG?(g={2012:{}},!0):k!=countlyCommon.ACTIVE_APP_KEY?(k=countlyCommon.ACTIVE_APP_KEY,this.initialize()):l?c.when(c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"get_view_segments",period:o},dataType:"jsonp",success:function(a){if(a&&a.segments){for(var b=0;b<a.segments.length;b++)a.segments[b]=a.segments[b].replace(/&#46;/g,".");n=a.segments}}}),c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:b,segmentation:m,action:"refresh"},dataType:"jsonp",success:function(a){countlyCommon.extendDbObj(g,a),e()}})).then(function(){return!0}):this.initialize()},a.reset=function(){g={},i=[],j={},l=!1,d()},a.setSegment=function(a){m=a.replace(/\./g,"&#46;")},a.getSegments=function(){return n},a.loadActionsData=function(a){return o=countlyCommon.getPeriodForAjax(),c.when(c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"get_view_segments",period:o},dataType:"jsonp",success:function(a){if(a&&a.segments){for(var b=0;b<a.segments.length;b++)a.segments[b]=a.segments[b].replace(/&#46;/g,".");n=a.segments}}}),c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/actions",data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,view:a,segment:m,period:o},dataType:"json",success:function(a){j=a}})).then(function(){return!0})},a.testUrl=function(a,b){c.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/urltest",data:{url:a},dataType:"json",success:function(a){b&&b(a.result)}})},a.getActionsData=function(a){return j},a.getChartData=function(b,c,d){var e=[{data:[],label:d,color:"#DDDDDD",mode:"ghost"},{data:[],label:d,color:"#333933"}],f=[{name:"p"+c,func:function(a){return a[c]},period:"previous"},{name:c}];return countlyCommon.extractChartData(g,a.clearObject,e,f,b)},a.getData=function(a){var c=countlyCommon.extractTwoLevelData(g,h,this.clearObject,[{name:b,func:function(a,b){return a}},{name:"u"},{name:"t"},{name:"s"},{name:"b"},{name:"e"},{name:"d"},{name:"n"}]);return c.chartData=countlyCommon.mergeMetricsByName(c.chartData,b),c},a.clearObject=function(a){return a?(a.u||(a.u=0),a.t||(a.t=0),a.n||(a.n=0),a.s||(a.s=0),a.e||(a.e=0),a.b||(a.b=0),a.d||(a.d=0)):a={u:0,t:0,n:0,s:0,e:0,b:0,d:0},a},a.getBars=function(){return countlyCommon.extractBarData(g,h,this.clearObject,fetchValue)},a.getViewFrequencyData=function(){var b=countlySession.getSessionDb();i.length?b.meta&&(i=countlyCommon.union(i,b.meta["v-ranges"])):i=b.meta&&b.meta["v-ranges"]?b.meta["v-ranges"]:[];var c={chartData:{},chartDP:{dp:[],ticks:[]}};c.chartData=countlyCommon.extractRangeData(b,"vc",i,a.explainFrequencyRange);var d=_.pluck(c.chartData,"vc"),e=_.pluck(c.chartData,"t"),f=[{data:[]}];f[0].data[0]=[-1,null],f[0].data[d.length+1]=[d.length,null],c.chartDP.ticks.push([-1,""]),c.chartDP.ticks.push([d.length,""]);for(var g=0;g<d.length;g++)f[0].data[g+1]=[g,e[g]],c.chartDP.ticks.push([g,d[g]]);c.chartDP.dp=f;for(var g=0;g<c.chartData.length;g++)c.chartData[g].percent="<div class='percent-bar' style='width:"+2*c.chartData[g].percent+"px;'></div>"+c.chartData[g].percent+"%";return c},a.explainFrequencyRange=function(a){var b=jQuery.i18n.map["views.visits"].toLowerCase(),c=["1 - 2 "+b,"3 - 5 "+b,"6 - 10 "+b,"11 - 15 "+b,"16 - 30 "+b,"31 - 50 "+b,"51 - 100 "+b,"> 100 "+b];return c[a]},a.getFrequencyIndex=function(a){var b=jQuery.i18n.map["views.visits"].toLowerCase(),c=["1 - 2 "+b,"3 - 5 "+b,"6 - 10 "+b,"11 - 15 "+b,"16 - 30 "+b,"31 - 50 "+b,"51 - 100 "+b,"> 100 "+b];return c.indexOf(a)}}(window.countlyViews=window.countlyViews||{},"views",jQuery),"undefined"!=typeof module&&(module.exports=simpleheat),simpleheat.prototype={defaultRadius:25,defaultGradient:{.4:"blue",.6:"cyan",.7:"lime",.8:"yellow",1:"red"},data:function(a){return this._data=a,this},max:function(a){return this._max=a,this},add:function(a){return this._data.push(a),this},clear:function(){return this._data=[],this},radius:function(a,b){b=void 0===b?15:b;var c=this._circle=document.createElement("canvas"),d=c.getContext("2d"),e=this._r=a+b;return c.width=c.height=2*e,d.shadowOffsetX=d.shadowOffsetY=2*e,d.shadowBlur=b,d.shadowColor="black",d.beginPath(),d.arc(-e,-e,a,0,2*Math.PI,!0),d.closePath(),d.fill(),this},resize:function(){this._width=this._canvas.width,this._height=this._canvas.height},gradient:function(a){var b=document.createElement("canvas"),c=b.getContext("2d"),d=c.createLinearGradient(0,0,0,256);b.width=1,b.height=256;for(var e in a)d.addColorStop(e,a[e]);return c.fillStyle=d,c.fillRect(0,0,1,256),this._grad=c.getImageData(0,0,1,256).data,this},draw:function(a){this._circle||this.radius(this.defaultRadius),this._grad||this.gradient(this.defaultGradient);var b=this._ctx;b.clearRect(0,0,this._width,this._height);for(var c,d=0,e=this._data.length;d<e;d++)c=this._data[d],b.globalAlpha=Math.max(c[2]/this._max,void 0===a?.05:a),b.drawImage(this._circle,c[0]-this._r,c[1]-this._r);var f=b.getImageData(0,0,this._width,this._height);return this._colorize(f.data,this._grad),b.putImageData(f,0,0),this},_colorize:function(a,b){for(var c,d=0,e=a.length;d<e;d+=4)c=4*a[d+3],c&&(a[d]=b[c],a[d+1]=b[c+1],a[d+2]=b[c+2])}},window.ViewsView=countlyView.extend({selectedMetric:"u",selectedView:null,selectedViews:[],selectedApps:{all:!0},selectedCount:0,ids:{},lastId:0,beforeRender:function(){var a=this;return $.when($.get(countlyGlobal.path+"/views/templates/views.html",function(b){a.template=Handlebars.compile(b)}),countlyViews.initialize()).then(function(){})},getProperties:function(a){return{u:jQuery.i18n.map["common.table.total-users"],n:jQuery.i18n.map["common.table.new-users"],t:jQuery.i18n.map["views.total-visits"],d:jQuery.i18n.map["views.duration"],s:jQuery.i18n.map["views.starts"],e:jQuery.i18n.map["views.exits"],b:jQuery.i18n.map["views.bounces"]}},renderCommon:function(a){var b=this,c=countlyViews.getData(),d=this.getProperties(),e=[];for(var f in d)e.push({title:d[f],id:"view-metric-"+f});if(this.templateData={"page-title":jQuery.i18n.map["views.title"],"font-logo-class":"fa-eye","active-segmentation":jQuery.i18n.map["views.all-segments"],segmentations:countlyViews.getSegments(),usage:e},!a){$(this.el).html(this.template(this.templateData));var g=[{mData:function(a,b){return"display"==b?a.views+"<div class='color'></div>":a.views},sType:"string",sTitle:jQuery.i18n.map["views.table.view"],sClass:"break",sWidth:"30%"},{mData:"u",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.total-users"]},{mData:"n",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.table.new-users"]},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["views.total-visits"]},{mData:function(a,b){return 0==a.d||0==a.t?0:a.d/a.t},sType:"formatted-num",mRender:function(a){return countlyCommon.timeString(a/60)},sTitle:jQuery.i18n.map["views.avg-duration"]},{mData:"s",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["views.starts"]},{mData:"e",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["views.exits"]},{mData:"b",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["views.bounces"]}];"undefined"!=typeof addDrill&&($(".widget-header .left .title").after(addDrill("up.lv")),"web"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type&&g.push({mData:function(a,b){return'<a href="#/analytics/views/action-map/'+a.views+'" class="icon-button green btn-header btn-view-map" data-localize="views.table.view" style="margin:0px; padding:2px;">View</a>'},sType:"string",sTitle:jQuery.i18n.map["views.action-map"],sClass:"shrink center"})),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:c.chartData,fnRowCallback:function(a,c,d,e){b.selectedView||(b.selectedView=c.views,b.selectedViews.push(b.selectedView)),_.contains(b.selectedViews,c.views)&&$(a).addClass("selected"),b.ids[c.views]||(b.ids[c.views]="view_"+b.lastId,b.lastId++),$(a).attr("id",b.ids[c.views])},aoColumns:g})),$(".d-table").stickyTableHeaders(),$(".dataTable-bottom").append("<div clas='dataTables_info' style='float: right; margin-top:2px; margin-right: 10px;'>"+jQuery.i18n.map["views.maximum-items"]+" ("+countlyCommon.GRAPH_COLORS.length+")</div>"),$(".views-table tbody").on("click","tr",function(a){var c=$(this);if(b.selectedView=c.find("td").first().text(),_.contains(b.selectedViews,b.selectedView)){var d=b.selectedViews.indexOf(b.selectedView);b.selectedViews.splice(d,1),c.removeClass("selected"),c.find(".color").css("background-color","transparent")}else b.selectedViews.length<countlyCommon.GRAPH_COLORS.length&&(b.selectedViews.push(b.selectedView),c.addClass("selected"));0==b.selectedViews.length?$("#empty-graph").show():$("#empty-graph").hide(),b.drawGraph()}),$("#view-metric-"+this.selectedMetric).parents(".big-numbers").addClass("active"),$(".widget-content .inner").click(function(){$(".big-numbers").removeClass("active"),$(".big-numbers .select").removeClass("selected"),$(this).parent(".big-numbers").addClass("active"),$(this).find(".select").addClass("selected")}),$(".segmentation-option").on("click",function(){countlyViews.reset(),countlyViews.setSegment($(this).data("value")),b.refresh()}),$(".big-numbers .inner").click(function(){var a=$(this).find(".select").attr("id").replace("view-metric-","");return b.selectedMetric==a||(b.selectedMetric=a,void b.drawGraph())}),this.drawGraph()}},drawGraph:function(){for(var a=this.getProperties(),b=[],c=0;c<this.selectedViews.length;c++){var d=countlyCommon.GRAPH_COLORS[c],e=countlyViews.getChartData(this.selectedViews[c],this.selectedMetric,a[this.selectedMetric]).chartDP;if(e[1].color=d,$("#"+this.ids[this.selectedViews[c]]+" .color").css("background-color",d),1==this.selectedViews.length){var f=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d);e[0].color="rgba("+parseInt(f[1],16)+","+parseInt(f[2],16)+","+parseInt(f[3],16)+",0.5)",b.push(e[0])}b.push(e[1])}countlyCommon.drawTimeGraph(b,"#dashboard-graph")},refresh:function(){var a=this;$.when(countlyViews.refresh()).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0),newPage=$("<div>"+a.template(a.templateData)+"</div>"),$(a.el).find(".dashboard-summary").replaceWith(newPage.find(".dashboard-summary"));var b=countlyViews.getData();CountlyHelpers.refreshTable(a.dtable,b.chartData),a.drawGraph()})}}),window.ViewFrequencyView=countlyView.extend({beforeRender:function(){return $.when(countlyUser.initialize()).then(function(){})},renderCommon:function(a){var b=countlyViews.getViewFrequencyData();this.templateData={"page-title":jQuery.i18n.map["views.view-frequency"],"font-logo-class":"fa-eye"},a||($(this.el).html(this.template(this.templateData)),countlyCommon.drawGraph(b.chartDP,"#dashboard-graph","bar"),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b.chartData,aoColumns:[{mData:"vc",sType:"view-frequency",sTitle:jQuery.i18n.map["views.view-frequency"]},{mData:"t",sType:"formatted-num",mRender:function(a){return countlyCommon.formatNumber(a)},sTitle:jQuery.i18n.map["common.number-of-sessions"]},{mData:"percent",sType:"percent",sTitle:jQuery.i18n.map["common.percent"]}]})),$(".d-table").stickyTableHeaders())},refresh:function(){var a=this;$.when(countlyUser.initialize()).then(function(){if(app.activeView!=a)return!1;var b=countlyViews.getViewFrequencyData();countlyCommon.drawGraph(b.chartDP,"#dashboard-graph","bar"),CountlyHelpers.refreshTable(a.dtable,b.chartData)})}}),window.ActionMapView=countlyView.extend({actionType:"",curSegment:0,beforeRender:function(){var a=this;return $.when($.get(countlyGlobal.path+"/views/templates/actionmap.html",function(b){a.template=Handlebars.compile(b)}),countlyViews.loadActionsData(this.view)).then(function(){})},getData:function(a){for(var b,c=[],d=$("#view-canvas-map").prop("width"),e=$("#view-canvas-map").prop("height"),f=0;f<a.length;f++)b=a[f].sg,b.type==this.actionType&&c.push([parseInt(b.x/b.width*d),parseInt(b.y/b.height*e),a[f].c]);return c},getMaxHeight:function(a){for(var b=$("#view-map").width(),c={w:0,h:0},d={w:1e5,h:5e3},e=0;e<a.length;e++){if(b==a[e].sg.width)return a[e].sg.height;b>a[e].sg.width&&c.w<a[e].sg.width&&(c.w=a[e].sg.width,c.h=a[e].sg.height)}if(c.h>0)return c.h;for(var e=0;e<a.length;e++)b<a[e].sg.width&&d.w>a[e].sg.width&&(d.w=a[e].sg.width,d.h=a[e].sg.height);return d.h},getResolutions:function(a){for(var b=["Normal"],c={},d=0;d<a.length;d++)c[a[d].sg.width+" x "+a[d].sg.height]||(c[a[d].sg.width+" x "+a[d].sg.height]=!0,b.push(a[d].sg.width+" x "+a[d].sg.height));return b},resize:function(){$("#view-canvas-map").prop("width",$("#view-map").width()),$("#view-canvas-map").prop("height",$("#view-map").height()),this.map&&this.map.resize()},loadIframe:function(){var a=this,b=countlyViews.getActionsData().domains,c=location.protocol+"//"+b[a.curSegment]+a.view;0==$("#view_loaded_url").val().length&&$("#view_loaded_url").val(c),countlyViews.testUrl(c,function(d){d?($("#view-map iframe").attr("src","/o/urlredir?url="+encodeURIComponent(c)),$("#view_loaded_url").val(c)):(a.curSegment++,b[a.curSegment]?a.loadIframe():($("#view_loaded_url").show(),CountlyHelpers.alert(jQuery.i18n.map["views.cannot-load"],"red")))})},renderCommon:function(a){var b=countlyViews.getActionsData();this.actionType=b.types[0]||jQuery.i18n.map["views.select-action-type"];var c=countlyViews.getSegments(),d=this;if(this.templateData={"page-title":jQuery.i18n.map["views.action-map"],"font-logo-class":"fa-eye","first-type":this.actionType,"active-segmentation":jQuery.i18n.map["views.all-segments"],segmentations:c,data:b},!a){$(this.el).html(this.template(this.templateData)),$("#view-map").height(this.getMaxHeight(b.data)),this.resize(),this.loadIframe(),this.map=simpleheat("view-canvas-map"),this.map.data(this.getData(b.data));var e=Math.max((48500-35*b.data.length)/900,5);this.map.radius(e,1.6*e),this.map.draw(),$("#date-selector").after('<a class="icon-button light btn-header btn-back-view" data-localize="views.back"><i class="fa fa-chevron-left"></i> Back</a>'),app.localize(),$(".btn-back-view").off("click").on("click",function(){window.location.hash="/analytics/views"}),$("#view_reload_url").on("click",function(){$("#view-map iframe").attr("src","/o/urlredir?url="+encodeURIComponent($("#view_loaded_url").val()))}),$("#view_loaded_url").keyup(function(a){13==a.keyCode&&$("#view_reload_url").click()}),$("#action-map-type .segmentation-option").on("click",function(){d.actionType=$(this).data("value"),d.refresh()}),$("#action-map-resolution .segmentation-option").on("click",function(){switch($(this).data("value")){case"Normal":$("#view-map").width("100%"),$("#view-map").height(4500),$("#view-map").prependTo("#view-map-container");break;case"Fullscreen":$("#view-map").width("100%"),$("#view-map").height(4500),$("#view-map").prependTo(document.body);break;default:var a=$(this).data("value").split(" x ");$("#view-map").width(a[0]),$("#view-map").height(a[1]),$("#view-map").prependTo("#view-map-container")}d.resize(),d.refresh()}),$("#view-segments .segmentation-option").on("click",function(){countlyViews.reset(),countlyViews.setSegment($(this).data("value")),d.refresh()})}},refresh:function(){var a=this;$.when(countlyViews.loadActionsData(this.view)).then(function(){if(app.activeView!=a)return!1;a.renderCommon(!0);var b=countlyViews.getActionsData();if(a.map){a.map.clear(),a.map.data(a.getData(b.data));var c=Math.max((48500-35*b.data.length)/900,5);a.map.radius(c,1.6*c),a.map.draw()}})}}),app.viewsView=new ViewsView,app.viewFrequencyView=new ViewFrequencyView,app.actionMapView=new ActionMapView,app.route("/analytics/views","views",function(){this.renderWhenReady(this.viewsView)}),app.route("/analytics/view-frequency","views",function(){this.renderWhenReady(this.viewFrequencyView)}),app.route("/analytics/views/action-map/*view","views",function(a){this.actionMapView.view=a,this.renderWhenReady(this.actionMapView)}),$(document).ready(function(){production||CountlyHelpers.loadJS("views/javascripts/simpleheat.js"),jQuery.fn.dataTableExt.oSort["view-frequency-asc"]=function(a,b){return a=countlyViews.getFrequencyIndex(a),b=countlyViews.getFrequencyIndex(b),a<b?-1:a>b?1:0},jQuery.fn.dataTableExt.oSort["view-frequency-desc"]=function(a,b){return a=countlyViews.getFrequencyIndex(a),b=countlyViews.getFrequencyIndex(b),a<b?1:a>b?-1:0};var a='<a href="#/analytics/views" class="item"><div class="logo-icon fa fa-eye"></div><div class="text" data-localize="views.title"></div></a>';$("#web-type #analytics-submenu").append(a),$("#mobile-type #analytics-submenu").append(a);var a='<a href="#/analytics/view-frequency" class="item"><div class="logo-icon fa fa-eye"></div><div class="text" data-localize="views.view-frequency"></div></a>';$("#web-type #engagement-submenu").append(a),$("#mobile-type #engagement-submenu").append(a)}),function(b,c,d,e,f,g,h){function i(){function a(a,b){g.push({$EventName:a,$Handler:b})}function c(a,b){m.$Each(g,function(c,d){c.$EventName==a&&c.$Handler===b&&g.splice(d,1)})}function d(){g=[]}function e(){m.$Each(h,function(a){m.$RemoveEvent(a.$Obj,a.$EventName,a.$Handler)}),h=[]}var f=this,g=[],h=[];f.$Listen=function(a,b,c,d){m.$AddEvent(a,b,c,d),h.push({$Obj:a,$EventName:b,$Handler:c})},f.$Unlisten=function(a,b,c){m.$Each(h,function(d,e){d.$Obj===a&&d.$EventName==b&&d.$Handler===c&&(m.$RemoveEvent(a,b,c),h.splice(e,1))})},f.$UnlistenAll=e,f.$On=f.addEventListener=a,f.$Off=f.removeEventListener=c,f.$TriggerEvent=function(a){var c=[].slice.call(arguments,1);m.$Each(g,function(d){d.$EventName==a&&d.$Handler.apply(b,c)})},f.$Destroy=function(){e(),d();for(var a in f)delete f[a]}}function j(a,b,c){var d=this;n.call(d,0,c),d.$Revert=m.$EmptyFunction,d.$IdleBegin=0,d.$IdleEnd=c}new function(){function a(b){if(b.constructor===a.caller)throw new Error("Cannot create instance of an abstract class.")}this.$DebugMode=f,this.$Log=function(a,c){var d=b.console||{},e=this.$DebugMode;e&&d.log?d.log(a):e&&c&&alert(a)},this.$Error=function(a,c){var d=b.console||{},e=this.$DebugMode;if(e&&d.error?d.error(a):e&&alert(a),e)throw c||new Error(a)},this.$Fail=function(a){throw new Error(a)},this.$Assert=function(a,b){var c=this.$DebugMode;if(c&&!a)throw new Error("Assert failed "+b||"")},this.$Trace=function(a){var c=b.console||{},d=this.$DebugMode;d&&c.log&&c.log(a)},this.$Execute=function(a){var b=this.$DebugMode;b&&a()},this.$LiveStamp=function(a,b){var d=this.$DebugMode;if(d){var e=c.createElement("DIV");e.setAttribute("id",b),a.$Live=e}},this.$C_AbstractProperty=function(){throw new Error("The property is abstract, it should be implemented by subclass.")},this.$C_AbstractMethod=function(){throw new Error("The method is abstract, it should be implemented by subclass.")},this.$C_AbstractClass=a};var k=b.$JssorEasing$={$EaseSwing:function(a){return-d.cos(a*d.PI)/2+.5},$EaseLinear:function(a){return a},$EaseInQuad:function(a){return a*a},$EaseOutQuad:function(a){return-a*(a-2)},$EaseInOutQuad:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)},$EaseInCubic:function(a){return a*a*a},$EaseOutCubic:function(a){return(a-=1)*a*a+1},$EaseInOutCubic:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},$EaseInQuart:function(a){return a*a*a*a},$EaseOutQuart:function(a){return-((a-=1)*a*a*a-1)},$EaseInOutQuart:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},$EaseInQuint:function(a){return a*a*a*a*a},$EaseOutQuint:function(a){return(a-=1)*a*a*a*a+1},$EaseInOutQuint:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},$EaseInSine:function(a){return 1-d.cos(a*d.PI/2)},$EaseOutSine:function(a){return d.sin(a*d.PI/2)},$EaseInOutSine:function(a){return-.5*(d.cos(d.PI*a)-1)},$EaseInExpo:function(a){return 0==a?0:d.pow(2,10*(a-1))},$EaseOutExpo:function(a){return 1==a?1:-d.pow(2,-10*a)+1},$EaseInOutExpo:function(a){return 0==a||1==a?a:(a*=2)<1?.5*d.pow(2,10*(a-1)):.5*(-d.pow(2,-10*--a)+2)},$EaseInCirc:function(a){return-(d.sqrt(1-a*a)-1)},$EaseOutCirc:function(a){return d.sqrt(1-(a-=1)*a)},$EaseInOutCirc:function(a){return(a*=2)<1?-.5*(d.sqrt(1-a*a)-1):.5*(d.sqrt(1-(a-=2)*a)+1)},$EaseInElastic:function(a){if(!a||1==a)return a;var b=.3,c=.075;return-(d.pow(2,10*(a-=1))*d.sin(2*(a-c)*d.PI/b))},$EaseOutElastic:function(a){if(!a||1==a)return a;var b=.3,c=.075;return d.pow(2,-10*a)*d.sin(2*(a-c)*d.PI/b)+1},$EaseInOutElastic:function(a){if(!a||1==a)return a;var b=.45,c=.1125;return(a*=2)<1?-.5*d.pow(2,10*(a-=1))*d.sin(2*(a-c)*d.PI/b):d.pow(2,-10*(a-=1))*d.sin(2*(a-c)*d.PI/b)*.5+1},$EaseInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},$EaseOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},$EaseInOutBack:function(a){var b=1.70158;return(a*=2)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},$EaseInBounce:function(a){return 1-k.$EaseOutBounce(1-a)},$EaseOutBounce:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},$EaseInOutBounce:function(a){return a<.5?.5*k.$EaseInBounce(2*a):.5*k.$EaseOutBounce(2*a-1)+.5},$EaseGoBack:function(a){return 1-d.abs(1)},$EaseInWave:function(a){return 1-d.cos(a*d.PI*2)},$EaseOutWave:function(a){return d.sin(a*d.PI*2)},$EaseOutJump:function(a){return 1-((a*=2)<1?(a=1-a)*a*a:(a-=1)*a*a)},$EaseInJump:function(a){return(a*=2)<1?a*a*a:(a=2-a)*a*a}},l=b.$Jease$={$Swing:k.$EaseSwing,$Linear:k.$EaseLinear,$InQuad:k.$EaseInQuad,$OutQuad:k.$EaseOutQuad,$InOutQuad:k.$EaseInOutQuad,$InCubic:k.$EaseInCubic,$OutCubic:k.$EaseOutCubic,$InOutCubic:k.$EaseInOutCubic,$InQuart:k.$EaseInQuart,$OutQuart:k.$EaseOutQuart,$InOutQuart:k.$EaseInOutQuart,$InQuint:k.$EaseInQuint,$OutQuint:k.$EaseOutQuint,$InOutQuint:k.$EaseInOutQuint,$InSine:k.$EaseInSine,$OutSine:k.$EaseOutSine,$InOutSine:k.$EaseInOutSine,$InExpo:k.$EaseInExpo,$OutExpo:k.$EaseOutExpo,$InOutExpo:k.$EaseInOutExpo,$InCirc:k.$EaseInCirc,$OutCirc:k.$EaseOutCirc,$InOutCirc:k.$EaseInOutCirc,$InElastic:k.$EaseInElastic,$OutElastic:k.$EaseOutElastic,$InOutElastic:k.$EaseInOutElastic,$InBack:k.$EaseInBack,$OutBack:k.$EaseOutBack,$InOutBack:k.$EaseInOutBack,$InBounce:k.$EaseInBounce,$OutBounce:k.$EaseOutBounce,$InOutBounce:k.$EaseInOutBounce,$GoBack:k.$EaseGoBack,$InWave:k.$EaseInWave,$OutWave:k.$EaseOutWave,$OutJump:k.$EaseOutJump,$InJump:k.$EaseInJump};b.$JssorDirection$={$TO_LEFT:1,$TO_RIGHT:2,$TO_TOP:4,$TO_BOTTOM:8,$HORIZONTAL:3,$VERTICAL:12,$GetDirectionHorizontal:function(a){return 3&a},$GetDirectionVertical:function(a){return 12&a},$IsHorizontal:function(a){return 3&a},$IsVertical:function(a){return 12&a}};var m=b.$Jssor$=new function(){function i(){if(!ja){ja={$Touchable:"ontouchstart"in b||"createTouch"in c};var a;(xa.pointerEnabled||(a=xa.msPointerEnabled))&&(ja.$TouchActionAttr=a?"msTouchAction":"touchAction")}return ja}function j(a){if(!sa)if(sa=-1,"Microsoft Internet Explorer"==ya&&b.attachEvent&&b.ActiveXObject){var d=za.indexOf("MSIE");sa=na,ua=Ba(za.substring(d+5,za.indexOf(";",d))),ta=c.documentMode||ua}else if("Netscape"==ya&&b.addEventListener){var e=za.indexOf("Firefox"),f=za.indexOf("Safari"),g=za.indexOf("Chrome"),h=za.indexOf("AppleWebKit");if(e>=0)sa=oa,ta=Ba(za.substring(e+8));else if(f>=0){var i=za.substring(0,f).lastIndexOf("/");sa=g>=0?qa:pa,ta=Ba(za.substring(i+1,f))}else{var j=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/i.exec(za);j&&(sa=na,ta=ua=Ba(j[1]))}h>=0&&(wa=Ba(za.substring(h+12)))}else{var j=/(opera)(?:.*version|)[ \/]([\w.]+)/i.exec(za);j&&(sa=ra,ta=Ba(j[2]))}return a==sa}function l(){return j(na)}function n(){return l()&&(ta<6||"BackCompat"==c.compatMode)}function o(){return j(oa)}function p(){return j(pa)}function q(){return j(qa)}function r(){return j(ra)}function s(){return p()&&wa>534&&wa<535}function t(){return j(),wa>537||ta>42||sa==na&&ta>=11}function u(){return l()&&ta<9}function v(a){var b,c;return function(d){if(!b){b=f;var e=a.substr(0,1).toUpperCase()+a.substr(1);z([a].concat(["WebKit","ms","Moz","O","webkit"]),function(b,f){var g=a;if(f&&(g=b+e),d.style[g]!=h)return c=g})}return c}}function w(a){var b;return function(c){return b=b||v(a)(c)||a}}function x(a){return{}.toString.call(a)}function y(){return ka||(ka={},z(["Boolean","Number","String","Function","Array","Date","RegExp","Object"],function(a){ka["[object "+a+"]"]=a.toLowerCase()})),ka}function z(a,b){var c,d;if("[object Array]"==x(a)){for(c=0;c<a.length;c++)if(d=b(a[c],c,a))return d}else for(c in a)if(d=b(a[c],c,a))return d}function A(a){return a==e?String(a):y()[x(a)]||"object"}function B(a){for(var b in a)return f}function C(a){try{return"object"==A(a)&&!a.nodeType&&a!=a.window&&(!a.constructor||{}.hasOwnProperty.call(a.constructor.prototype,"isPrototypeOf"))}catch(b){}}function D(a,b){return{x:a,y:b}}function E(a,b){setTimeout(a,b||0)}function F(a,b,c){var d=a&&"inherit"!=a?a:"";return z(b,function(a){var b=a.exec(d);if(b){var c=d.substr(0,b.index),e=d.substr(b.index+b[0].length+1,d.length-1);d=c+e}}),d=c+(d.indexOf(" ")?" ":"")+d}function G(a,b){ta<9&&(a.style.filter=b)}function H(a){a.constructor===H.caller&&a.$Construct&&a.$Construct.apply(a,H.caller.arguments)}function I(a){return a||b.event}function J(a,c,d){if(d===h){var f=a.currentStyle||a.style;return d=f[c],""==d&&b.getComputedStyle&&(f=a.ownerDocument.defaultView.getComputedStyle(a,e),f&&(d=f.getPropertyValue(c)||f[c])),d}a.style[c]=d==h?"":d}function K(a,b,c,d){return c===h?Ba(J(a,b)):(c==e?c="":d&&(c+="px"),void J(a,b,c))}function L(a,b,c){return K(a,b,c,f)}function M(a,b){var c,d=b?K:J;return 4&b&&(c=w(a)),function(e,f){return d(e,c?c(e):a,f,2&b)}}function N(a){if(l()&&ua<9){var b=/opacity=([^)]*)/.exec(a.style.filter||"");return b?Ba(b[1])/100:1}return Ba(a.style.opacity||"1")}function O(a,b,c){if(l()&&ua<9){var e=a.style.filter||"",f=new RegExp(/[\s]*alpha\([^\)]*\)/g),g=d.round(100*b),h="";(g<100||c)&&(h="alpha(opacity="+g+") ");var i=F(e,[f],h);G(a,i)}else a.style.opacity=1==b?"":d.round(100*b)/100}function P(a,b){var c="";b&&(l()&&ta&&ta<10&&(delete b.$RotateX,delete b.$RotateY,delete b.$TranslateZ),m.$Each(b,function(a,b){var d=Da[b];if(d){var e=d[1]||0;Ha[b]!=a&&(c+=" "+d[0]+"("+a+["deg","px",""][e]+")")}}),t()&&((b.$TranslateX||b.$TranslateY||b.$TranslateZ)&&(c+=" translate3d("+(b.$TranslateX||0)+"px,"+(b.$TranslateY||0)+"px,"+(b.$TranslateZ||0)+"px)"),b.$ScaleX==h&&(b.$ScaleX=1),b.$ScaleY==h&&(b.$ScaleY=1),1==b.$ScaleX&&1==b.$ScaleY||(c+=" scale3d("+b.$ScaleX+", "+b.$ScaleY+", 1)"))),a.style[Ca(a)]=c}function Q(a,b,c,d){for(d=d||"u",a=a?a.firstChild:e;a;a=a.nextSibling)if(1==a.nodeType){if(Y(a,d)==b)return a;if(!c){var f=Q(a,b,c,d);if(f)return f}}}function R(a,b,c,d){d=d||"u";var f=[];for(a=a?a.firstChild:e;a;a=a.nextSibling)if(1==a.nodeType&&(Y(a,d)==b&&f.push(a),!c)){var g=R(a,b,c,d);g.length&&(f=f.concat(g))}return f}function S(a,b,c){for(a=a?a.firstChild:e;a;a=a.nextSibling)if(1==a.nodeType){if(a.tagName==b)return a;if(!c){var d=S(a,b,c);if(d)return d}}}function T(a,b,c){var d=[];for(a=a?a.firstChild:e;a;a=a.nextSibling)if(1==a.nodeType&&((!b||a.tagName==b)&&d.push(a),!c)){var f=T(a,b,c);f.length&&(d=d.concat(f))}return d}function U(){var a,b,c,d,e=arguments,f=1&e[0],g=1+f;for(a=e[g-1]||{};g<e.length;g++)if(b=e[g])for(c in b)if(d=b[c],d!==h){d=b[c];var i=a[c];a[c]=f&&(C(i)||C(d))?U(f,{},i,d):d}return a}function V(a,b){var c,d,e,f={};for(c in a)if(d=a[c],e=b[c],d!==e){var g;C(d)&&C(e)&&(d=V(d,e),g=!B(d)),!g&&(f[c]=d)}return f}function W(a){return c.createElement(a)}function X(a,b,c){return c==h?a.getAttribute(b):void a.setAttribute(b,c)}function Y(a,b){return X(a,b)||X(a,"data-"+b)}function Z(a,b){return b==h?a.className:void(a.className=b)}function $(a){var b={};return z(a,function(a){b[a]=a}),b}function _(a){var b=[];return z(a,function(a){b.push(a)}),b}function aa(a,b){return a.match(b||ma)}function ba(a,b){return $(aa(a||"",b))}function ca(a,b){var c="";return z(b,function(b){c&&(c+=a),c+=b}),c}function da(a,b,c){Z(a,ca(" ",U(V(ba(Z(a)),ba(b)),ba(c))))}function ea(a,b,c){var d=a.cloneNode(!b);return!c&&la.$RemoveAttribute(d,"id"),d}function fa(a){function b(){da(a,f,k[o||l||2&n||n]),m.$Css(a,"pointer-events",o?"none":"")}function d(){l=0,b(),la.$RemoveEvent(c,"mouseup",d),la.$RemoveEvent(c,"touchend",d),la.$RemoveEvent(c,"touchcancel",d)}function e(a){o?la.$CancelEvent(a):(l=4,b(),la.$AddEvent(c,"mouseup",d),la.$AddEvent(c,"touchend",d),la.$AddEvent(c,"touchcancel",d))}var f,g=this,i="",j=["av","pv","ds","dn"],k=[],l=0,n=0,o=0;g.$Selected=function(a){return a===h?n:(n=2&a||1&a,void b())},g.$Enable=function(a){return a===h?!o:(o=a?0:3,void b())},g.$Elmt=a=la.$GetElement(a);var p=m.$Split(Z(a));p&&(i=p.shift()),z(j,function(a){k.push(i+a)}),f=ca(" ",k),k.unshift(""),la.$AddEvent(a,"mousedown",e),la.$AddEvent(a,"touchstart",e)}function ga(a,b){function c(a,b,c){var e=a.$TransformPoint(D(-b/2,-c/2)),f=a.$TransformPoint(D(b/2,-c/2)),g=a.$TransformPoint(D(b/2,c/2)),h=a.$TransformPoint(D(-b/2,c/2));
return a.$TransformPoint(D(300,300)),D(d.min(e.x,f.x,g.x,h.x)+b/2,d.min(e.y,f.y,g.y,h.y)+c/2)}function f(a,b){b=b||{};var d=b.$TranslateZ||0,e=(b.$RotateX||0)%360,f=(b.$RotateY||0)%360,j=(b.$Rotate||0)%360,l=b.$ScaleZ;g&&(d=0,e=0,f=0,l=0);var m=new ha(b.$TranslateX,b.$TranslateY,d);if(m.$RotateX(e),m.$RotateY(f),m.$RotateZ(j),m.$Skew(b.$SkewX,b.$SkewY),m.$Scale(b.$ScaleX,b.$ScaleY,l),i)m.$Move(b.$MoveX,b.$MoveY),a.style[k]=m.$Format3d();else if(!va||va<9){var n="";if(j||b.$ScaleX!=h&&1!=b.$ScaleX||b.$ScaleY!=h&&1!=b.$ScaleY){var o=c(m,b.$OriginalWidth,b.$OriginalHeight);la.$CssMarginTop(a,o.y),la.$CssMarginLeft(a,o.x),n=m.$Format2d()}var p=a.style.filter,q=new RegExp(/[\s]*progid:DXImageTransform\.Microsoft\.Matrix\([^\)]*\)/g),r=F(p,[q],n);G(a,r)}}var g=u(),i=t(),j=s(),k=Ca(a);ga=function(a,b){b=b||{};var c,d=b.$MoveX,g=b.$MoveY;z(Ga,function(d,e){c=b[e],c!==h&&d(a,c)}),la.$SetStyleClip(a,b.$Clip),i||(d!=h&&la.$CssLeft(a,b.$OriginalX+d),g!=h&&la.$CssTop(a,b.$OriginalY+g)),b.$Transform&&(j?E(la.$CreateCallback(e,P,a,b)):f(a,b))},la.$SetStyleTransform=P,j&&(la.$SetStyleTransform=ga),g?la.$SetStyleTransform=f:i||(f=P),la.$SetStyles=ga,ga(a,b)}function ha(b,c,f){function g(a){return a*d.PI/180}function i(a,b){return{x:a,y:b}}function j(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F){return[a*q+b*u+c*y+d*C,a*r+b*v+c*z+d*D,a*s+b*w+c*A+d*E,a*t+b*x+c*B+d*F,e*q+f*u+g*y+h*C,e*r+f*v+g*z+h*D,e*s+f*w+g*A+h*E,e*t+f*x+g*B+h*F,i*q+j*u+k*y+l*C,i*r+j*v+k*z+l*D,i*s+j*w+k*A+l*E,i*t+j*x+k*B+l*F,m*q+n*u+o*y+p*C,m*r+n*v+o*z+p*D,m*s+n*w+o*A+p*E,m*t+n*x+o*B+p*F]}function k(a,b){return j.apply(e,(b||m).concat(a))}var l=this,m=[1,0,0,0,0,1,0,0,0,0,1,0,b||0,c||0,f||0,1],n=d.sin,o=d.cos,p=d.tan;l.$Matrix=function(){return m},l.$Scale=function(a,b,c){a==h&&(a=1),b==h&&(b=1),c==h&&(c=1),1==a&&1==b&&1==c||(m=k([a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1]))},l.$Translate=function(a,b,c){(a||b||c)&&(m=k([1,0,0,0,0,1,0,0,0,0,1,0,a||0,b||0,c||0,1]))},l.$Move=function(a,b,c){m[12]+=a||0,m[13]+=b||0,m[14]+=c||0},l.$RotateX=function(b){if(b){a=g(b);var c=o(a),d=n(a);m=k([1,0,0,0,0,c,d,0,0,-d,c,0,0,0,0,1])}},l.$RotateY=function(b){if(b){a=g(b);var c=o(a),d=n(a);m=k([c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1])}},l.$RotateZ=function(b){if(b){a=g(b);var c=o(a),d=n(a);m=k([c,d,0,0,-d,c,0,0,0,0,1,0,0,0,0,1])}},l.$Skew=function(a,d){(a||d)&&(b=g(a),c=g(d),m=k([1,p(c),0,0,p(b),1,0,0,0,0,1,0,0,0,0,1]))},l.$TransformPoint=function(a){var b=k(m,[1,0,0,0,0,1,0,0,0,0,1,0,a.x,a.y,0,1]);return i(b[12],b[13])},l.$Format3d=function(){return"matrix3d("+m.join(",")+")"},l.$Format2d=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+m[0]+", M12="+m[4]+", M21="+m[1]+", M22="+m[5]+", SizingMethod='auto expand')"}}function ia(a,b){var c={};return z(a,function(a,d){var e=a;b[d]!=h&&(e=la.$IsNumeric(a)?a+b[d]:ia(a,b[d])),c[d]=e}),c}var ja,ka,la=this,ma=/\S+/g,na=1,oa=2,pa=3,qa=4,ra=5,sa=0,ta=0,ua=0,va=0,wa=0,xa=navigator,ya=xa.appName,za=xa.userAgent,Aa=c.documentElement,Ba=parseFloat,Ca=w("transform");la.$Device=i,la.$IsBrowserIE=l,la.$IsBrowserIeQuirks=n,la.$IsBrowserFireFox=o,la.$IsBrowserSafari=p,la.$IsBrowserChrome=q,la.$IsBrowserOpera=r,la.$IsBrowserBadTransform=s,la.$IsBrowser3dSafe=t,la.$IsBrowserIe9Earlier=u,la.$GetTransformProperty=v("transform"),la.$BrowserVersion=function(){return ta},la.$BrowserEngineVersion=function(){return ua||ta},la.$WebKitVersion=function(){return j(),wa},la.$Delay=E,la.$Inherit=function(a,b){return b.call(a),U({},a)},la.$Construct=H,la.$GetElement=function(a){return la.$IsString(a)&&(a=c.getElementById(a)),a},la.$GetEvent=I,la.$EvtSrc=function(a){a=I(a);var b=a.target||a.srcElement||c;return 3==b.nodeType&&(b=la.$ParentNode(b)),b},la.$EvtTarget=function(a){return a=I(a),a.relatedTarget||a.toElement},la.$EvtWhich=function(a){return a=I(a),a.which||[0,1,3,0,2][a.button]||a.charCode||a.keyCode},la.$MousePosition=function(a){return a=I(a),{x:a.pageX||a.clientX||0,y:a.pageY||a.clientY||0}},la.$PageScroll=function(){var a=c.body;return{x:(b.pageXOffset||Aa.scrollLeft||a.scrollLeft||0)-(Aa.clientLeft||a.clientLeft||0),y:(b.pageYOffset||Aa.scrollTop||a.scrollTop||0)-(Aa.clientTop||a.clientTop||0)}},la.$WindowSize=function(){var a=c.body;return{x:a.clientWidth||Aa.clientWidth,y:a.clientHeight||Aa.clientHeight}};var Da={$Rotate:["rotate"],$RotateX:["rotateX"],$RotateY:["rotateY"],$SkewX:["skewX"],$SkewY:["skewY"]};t()||(Da=U(Da,{$ScaleX:["scaleX",2],$ScaleY:["scaleY",2],$TranslateZ:["translateZ",1]})),la.$CssTransformOrigin=M("transformOrigin",4),la.$CssBackfaceVisibility=M("backfaceVisibility",4),la.$CssTransformStyle=M("transformStyle",4),la.$CssPerspective=M("perspective",6),la.$CssPerspectiveOrigin=M("perspectiveOrigin",4),la.$CssScale=function(a,b){if(l()&&ua<9||ua<10&&n())a.style.zoom=1==b?"":b;else{var c=Ca(a),d="scale("+b+")",e=a.style[c],f=new RegExp(/[\s]*scale\(.*?\)/g),g=F(e,[f],d);a.style[c]=g}};var Ea=0,Fa=0;la.$WindowResizeFilter=function(a,b){return u()?function(){var c=f,d=n()?a.document.body:a.document.documentElement;if(d){var e=d.offsetWidth-Ea,h=d.offsetHeight-Fa;e||h?(Ea+=e,Fa+=h):c=g}c&&b()}:b},la.$MouseOverOutFilter=function(a,b){return function(c){c=I(c);var d=c.type,e=c.relatedTarget||("mouseout"==d?c.toElement:c.fromElement);(!e||e!==b&&!la.$IsChild(b,e))&&a(c)}},la.$AddEvent=function(a,b,c,d){a=la.$GetElement(a),a.addEventListener?("mousewheel"==b&&a.addEventListener("DOMMouseScroll",c,d),a.addEventListener(b,c,d)):a.attachEvent&&(a.attachEvent("on"+b,c),d&&a.setCapture&&a.setCapture())},la.$RemoveEvent=function(a,b,c,d){a=la.$GetElement(a),a.removeEventListener?("mousewheel"==b&&a.removeEventListener("DOMMouseScroll",c,d),a.removeEventListener(b,c,d)):a.detachEvent&&(a.detachEvent("on"+b,c),d&&a.releaseCapture&&a.releaseCapture())},la.$FireEvent=function(a,b){var d;if(c.createEvent)d=c.createEvent("HTMLEvents"),d.initEvent(b,g,g),a.dispatchEvent(d);else{var e="on"+b;d=c.createEventObject(),a.fireEvent(e,d)}},la.$CancelEvent=function(a){a=I(a),a.preventDefault&&a.preventDefault(),a.cancel=f,a.returnValue=g},la.$StopEvent=function(a){a=I(a),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=f},la.$CreateCallback=function(a,b){var c=[].slice.call(arguments,2),d=function(){var d=c.concat([].slice.call(arguments,0));return b.apply(a,d)};return d},la.$InnerText=function(a,b){if(b==h)return a.textContent||a.innerText;var d=c.createTextNode(b);la.$Empty(a),a.appendChild(d)},la.$InnerHtml=function(a,b){return b==h?a.innerHTML:void(a.innerHTML=b)},la.$GetClientRect=function(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top,w:b.right-b.left,h:b.bottom-b.top}},la.$ClearInnerHtml=function(a){a.innerHTML=""},la.$EncodeHtml=function(a){var b=la.$CreateDiv();return la.$InnerText(b,a),la.$InnerHtml(b)},la.$DecodeHtml=function(a){var b=la.$CreateDiv();return la.$InnerHtml(b,a),la.$InnerText(b)},la.$SelectElement=function(a){var d;b.getSelection&&(d=b.getSelection());var f=e;c.createRange?(f=c.createRange(),f.selectNode(a)):(f=c.body.createTextRange(),f.moveToElementText(a),f.select()),d&&d.addRange(f)},la.$DeselectElements=function(){c.selection?c.selection.empty():b.getSelection&&b.getSelection().removeAllRanges()},la.$Children=function(a,b){for(var c=[],d=a.firstChild;d;d=d.nextSibling)(b||1==d.nodeType)&&c.push(d);return c},la.$FindChild=Q,la.$FindChildByTag=S,la.$FindChildrenByTag=T,la.$GetElementsByTag=function(a,b){return a.getElementsByTagName(b)},la.$Extend=U,la.$Unextend=V,la.$IsFunction=function(a){return"function"==A(a)},la.$IsArray=function(a){return"array"==A(a)},la.$IsString=function(a){return"string"==A(a)},la.$IsNumeric=function(a){return!isNaN(Ba(a))&&isFinite(a)},la.$Type=A,la.$Each=z,la.$IsNotEmpty=B,la.$IsPlainObject=C,la.$CreateElement=W,la.$CreateDiv=function(){return W("DIV")},la.$CreateSpan=function(){return W("SPAN")},la.$EmptyFunction=function(){},la.$Attribute=X,la.$AttributeEx=Y,la.$ClassName=Z,la.$ToHash=$,la.$FromHash=_,la.$Split=aa,la.$Join=ca,la.$AddClass=function(a,b){da(a,e,b)},la.$RemoveClass=da,la.$ReplaceClass=da,la.$ParentNode=function(a){return a.parentNode},la.$HideElement=function(a){la.$CssDisplay(a,"none")},la.$EnableElement=function(a,b){b?la.$Attribute(a,"disabled",f):la.$RemoveAttribute(a,"disabled")},la.$HideElements=function(a){for(var b=0;b<a.length;b++)la.$HideElement(a[b])},la.$ShowElement=function(a,b){la.$CssDisplay(a,b?"none":"")},la.$ShowElements=function(a,b){for(var c=0;c<a.length;c++)la.$ShowElement(a[c],b)},la.$RemoveAttribute=function(a,b){a.removeAttribute(b)},la.$CanClearClip=function(){return l()&&ta<10},la.$SetStyleClip=function(a,b){if(b)a.style.clip="rect("+d.round(b.$Top)+"px "+d.round(b.$Right)+"px "+d.round(b.$Bottom)+"px "+d.round(b.$Left)+"px)";else if(b!==h){var c=a.style.cssText,e=[new RegExp(/[\s]*clip: rect\(.*?\)[;]?/i),new RegExp(/[\s]*cliptop: .*?[;]?/i),new RegExp(/[\s]*clipright: .*?[;]?/i),new RegExp(/[\s]*clipbottom: .*?[;]?/i),new RegExp(/[\s]*clipleft: .*?[;]?/i)],f=F(c,e,"");m.$CssCssText(a,f)}},la.$GetNow=function(){return+new Date},la.$AppendChild=function(a,b){a.appendChild(b)},la.$AppendChildren=function(a,b){z(b,function(b){la.$AppendChild(a,b)})},la.$InsertBefore=function(a,b,c){(c||b.parentNode).insertBefore(a,b)},la.$InsertAfter=function(a,b,c){la.$InsertBefore(a,b.nextSibling,c||b.parentNode)},la.$InsertAdjacentHtml=function(a,b,c){a.insertAdjacentHTML(b,c)},la.$RemoveElement=function(a,b){b=b||a.parentNode,b&&b.removeChild(a)},la.$RemoveElements=function(a,b){z(a,function(a){la.$RemoveElement(a,b)})},la.$Empty=function(a){la.$RemoveElements(la.$Children(a,f),a)},la.$CenterElement=function(a,b){var c=la.$ParentNode(a);1&b&&la.$CssLeft(a,(la.$CssWidth(c)-la.$CssWidth(a))/2),2&b&&la.$CssTop(a,(la.$CssHeight(c)-la.$CssHeight(a))/2)},la.$ParseInt=function(a,b){return parseInt(a,b||10)},la.$ParseFloat=Ba,la.$IsChild=function(a,b){for(var d=c.body;b&&a!==b&&d!==b;)try{b=b.parentNode}catch(e){return g}return a===b},la.$CloneNode=ea,la.$LoadImage=function(a,b){function c(a,f){la.$RemoveEvent(e,"load",c),la.$RemoveEvent(e,"abort",d),la.$RemoveEvent(e,"error",d),b&&b(e,f)}function d(a){c(a,f)}var e=new Image;r()&&ta<11.6||!a?c(!a):(la.$AddEvent(e,"load",c),la.$AddEvent(e,"abort",d),la.$AddEvent(e,"error",d),e.src=a)},la.$LoadImages=function(a,b,c){function d(a){e--,b&&a&&a.src==b.src&&(b=a),!e&&c&&c(b)}var e=a.length+1;z(a,function(a){la.$LoadImage(a.src,d)}),d()},la.$BuildElement=function(a,b,c,d){d&&(a=ea(a));var e=R(a,b);e.length||(e=m.$GetElementsByTag(a,b));for(var f=e.length-1;f>-1;f--){var g=e[f],h=ea(c);Z(h,Z(g)),m.$CssCssText(h,g.style.cssText),m.$InsertBefore(h,g),m.$RemoveElement(g)}return a},la.$Buttonize=function(a){return new fa(a)},la.$Css=J,la.$CssN=K,la.$CssP=L,la.$CssOverflow=M("overflow"),la.$CssTop=M("top",2),la.$CssLeft=M("left",2),la.$CssWidth=M("width",2),la.$CssHeight=M("height",2),la.$CssMarginLeft=M("marginLeft",2),la.$CssMarginTop=M("marginTop",2),la.$CssPosition=M("position"),la.$CssDisplay=M("display"),la.$CssZIndex=M("zIndex",1),la.$CssFloat=function(a,b){return J(a,l()?"styleFloat":"cssFloat",b)},la.$CssOpacity=function(a,b,c){return b==h?N(a):void O(a,b,c)},la.$CssCssText=function(a,b){return b==h?a.style.cssText:void(a.style.cssText=b)};var Ga={$Opacity:la.$CssOpacity,$Top:la.$CssTop,$Left:la.$CssLeft,$Width:la.$CssWidth,$Height:la.$CssHeight,$Position:la.$CssPosition,$Display:la.$CssDisplay,$ZIndex:la.$CssZIndex};la.$GetStyles=function(a,b){var c={};return z(b,function(b,d){Ga[d]&&(c[d]=Ga[d](a))}),c},la.$SetStyleTransform=ga,la.$SetStyles=ga,new function(){function a(a,b){for(var c=a[0].length,d=a.length,e=b[0].length,f=[],g=0;g<d;g++)for(var h=f[g]=[],i=0;i<e;i++){for(var j=0,k=0;k<c;k++)j+=a[g][k]*b[k][i];h[i]=j}return f}var b=this;b.$ScaleX=function(a,c){return b.$ScaleXY(a,c,0)},b.$ScaleY=function(a,c){return b.$ScaleXY(a,0,c)},b.$ScaleXY=function(b,c,d){return a(b,[[c,0],[0,d]])},b.$TransformPoint=function(b,c){var d=a(b,[[c.x],[c.y]]);return D(d[0][0],d[1][0])}};var Ha={$OriginalX:0,$OriginalY:0,$MoveX:0,$MoveY:0,$Zoom:1,$ScaleX:1,$ScaleY:1,$Rotate:0,$RotateX:0,$RotateY:0,$TranslateX:0,$TranslateY:0,$TranslateZ:0,$SkewX:0,$SkewY:0};la.$FormatEasings=function(a){var b=a||{};return a&&(m.$IsFunction(a)?b={$Default:b}:m.$IsFunction(a.$Clip)&&(b.$Clip={$Default:a.$Clip})),b},la.$AddDif=ia,la.$Cast=function(a,b,c,g,i,j,l){var n=b;if(a){n={};for(var o in b){var p=j[o]||1,q=i[o]||[0,1],r=(c-q[0])/q[1];r=d.min(d.max(r,0),1),r*=p;var s=d.floor(r);r!=s&&(r-=s);var t,u=g.$Default||k.$EaseSwing,v=a[o],w=b[o];if(m.$IsNumeric(w)){u=g[o]||u;var x=u(r);t=v+w*x}else t=m.$Extend({$Offset:{}},a[o]),m.$Each(w.$Offset||w,function(a,b){g.$Clip&&(u=g.$Clip[b]||g.$Clip.$Default||u);var c=u(r),d=a*c;t.$Offset[b]=d,t[b]+=d});n[o]=t}var y=m.$Each(b,function(a,b){return Ha[b]!=h});y&&m.$Each(Ha,function(b,c){n[c]==h&&a[c]!==h&&(n[c]=a[c])}),y&&(n.$Zoom&&(n.$ScaleX=n.$ScaleY=n.$Zoom),n.$OriginalWidth=l.$OriginalWidth,n.$OriginalHeight=l.$OriginalHeight,n.$Transform=f)}if(b.$Clip&&l.$Move){var z=n.$Clip.$Offset,A=(z.$Top||0)+(z.$Bottom||0),B=(z.$Left||0)+(z.$Right||0);n.$Left=(n.$Left||0)+B,n.$Top=(n.$Top||0)+A,n.$Clip.$Left-=B,n.$Clip.$Right-=B,n.$Clip.$Top-=A,n.$Clip.$Bottom-=A}return n.$Clip&&m.$CanClearClip()&&!n.$Clip.$Top&&!n.$Clip.$Left&&n.$Clip.$Right==l.$OriginalWidth&&n.$Clip.$Bottom==l.$OriginalHeight&&(n.$Clip=e),n}},n=b.$JssorAnimator$=function(a,c,h,i,j,k){function l(a){E+=a,F+=a,C+=a,D+=a,L+=a,M+=a,K+=a}function n(a){var b=a;if(G&&(b>=F||b<=E)&&(b=((b-E)%G+G)%G+E),!B||w||L!=b){var e=d.min(b,F);if(e=d.max(e,E),!B||w||e!=M){if(k){var g=(e-C)/(c||1);h.$Reverse&&(g=1-g);var l=m.$Cast(j,k,g,x,z,y,h);H?m.$Each(l,function(a,b){H[b]&&H[b](i,a)}):m.$SetStyles(i,l)}I.$OnInnerOffsetChange(M-C,e-C),M=e,m.$Each(N,function(b,c){var d=a<L?N[N.length-c-1]:b;d.$GoToPosition(M-K)});var n=L,o=M;L=b,B=f,I.$OnPositionChange(n,o)}}}function o(a,b,c){b&&a.$Shift(F),c||(E=d.min(E,a.$GetPosition_OuterBegin()+K),F=d.max(F,a.$GetPosition_OuterEnd()+K)),N.push(a)}function p(){if(s){var a=m.$GetNow(),b=d.min(a-J,h.$IntervalMax),c=L+b*v;J=a,c*v>=u*v&&(c=u),n(c),!w&&c*v>=u*v?r(A):O(p)}}function q(a,b,c){s||(s=f,w=c,A=b,a=d.max(a,E),a=d.min(a,F),u=a,v=u<L?-1:1,I.$OnStart(),J=m.$GetNow(),O(p))}function r(a){s&&(w=s=A=g,I.$OnStop(),a&&a())}a=a||0;var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I=this,J=0,K=0,L=0,M=0,N=[],O=b.requestAnimationFrame||b.webkitRequestAnimationFrame||b.mozRequestAnimationFrame||b.msRequestAnimationFrame;m.$IsBrowserSafari()&&m.$BrowserVersion()<7&&(O=e),O=O||function(a){m.$Delay(a,h.$Interval)},I.$Play=function(a,b,c){q(a?L+a:F,b,c)},I.$PlayToPosition=q,I.$PlayToBegin=function(a,b){q(E,a,b)},I.$PlayToEnd=function(a,b){q(F,a,b)},I.$Stop=r,I.$Continue=function(a){q(a)},I.$GetPosition=function(){return L},I.$GetPlayToPosition=function(){return u},I.$GetPosition_Display=function(){return M},I.$GoToPosition=n,I.$GoToBegin=function(){n(E,f)},I.$GoToEnd=function(){n(F,f)},I.$Move=function(a){n(L+a)},I.$CombineMode=function(){return t},I.$GetDuration=function(){return c},I.$IsPlaying=function(){return s},I.$IsOnTheWay=function(){return L>C&&L<=D},I.$SetLoopLength=function(a){G=a},I.$Shift=l,I.$Join=o,I.$Combine=function(a,b){o(a,0,b)},I.$Chain=function(a){o(a,1)},I.$Expand=function(a){F+=a},I.$GetPosition_InnerBegin=function(){return C},I.$GetPosition_InnerEnd=function(){return D},I.$GetPosition_OuterBegin=function(){return E},I.$GetPosition_OuterEnd=function(){return F},I.$OnPositionChange=I.$OnStart=I.$OnStop=I.$OnInnerOffsetChange=m.$EmptyFunction,I.$Version=m.$GetNow(),h=m.$Extend({$Interval:16,$IntervalMax:50},h),G=h.$LoopLength,H=h.$Setter,E=C=a,F=D=a+c,y=h.$Round||{},z=h.$During||{},x=m.$FormatEasings(h.$Easing)},o=b.$JssorSlideshowFormations$=new function(){function a(a){return(a&l)==l}function b(a){return(a&m)==m}function c(a,b,c){c.push(b),a[b]=a[b]||[],a[b].push(c)}var e=this,g=0,h=1,i=2,j=3,k=1,l=2,m=4,n=8,o=256,p=512,q=1024,r=2048,s=r+k,t=r+l,u=p+k,v=p+l,w=o+m,x=o+n,y=q+m,z=q+n;e.$FormationStraight=function(a){for(var b,d=a.$Cols,e=a.$Rows,f=a.$Assembly,g=a.$Count,h=[],i=0,j=0,k=d-1,l=e-1,m=g-1,j=0;j<e;j++)for(i=0;i<d;i++){switch(f){case s:b=m-(i*e+(l-j));break;case y:b=m-(j*d+(k-i));break;case u:b=m-(i*e+j);case w:b=m-(j*d+i);break;case t:b=i*e+j;break;case x:b=j*d+(k-i);break;case v:b=i*e+(l-j);break;default:b=j*d+i}c(h,b,[j,i])}return h},e.$FormationSwirl=function(a){var b,d,e=a.$Cols,k=a.$Rows,l=a.$Assembly,m=a.$Count,n=[],o=[],p=0,q=0,r=0,z=e-1,A=k-1,B=0;switch(l){case s:q=z,r=0,d=[i,h,j,g];break;case y:q=0,r=A,d=[g,j,h,i];break;case u:q=z,r=A,d=[j,h,i,g];break;case w:q=z,r=A,d=[h,j,g,i];break;case t:q=0,r=0,d=[i,g,j,h];break;case x:q=z,r=0,d=[h,i,g,j];break;case v:q=0,r=A,d=[j,g,i,h];break;default:q=0,r=0,d=[g,i,h,j]}for(p=0;p<m;){if(b=r+","+q,q>=0&&q<e&&r>=0&&r<k&&!o[b])o[b]=f,c(n,p++,[r,q]);else switch(d[B++%d.length]){case g:q--;break;case i:r--;break;case h:q++;break;case j:r++}switch(d[B%d.length]){case g:q++;break;case i:r++;break;case h:q--;break;case j:r--}}return n},e.$FormationZigZag=function(a){var b,d,e=a.$Cols,f=a.$Rows,k=a.$Assembly,l=a.$Count,m=[],n=0,o=0,p=0,q=e-1,r=f-1,z=0;switch(k){case s:o=q,p=0,d=[i,h,j,h];break;case y:o=0,p=r,d=[g,j,h,j];break;case u:o=q,p=r,d=[j,h,i,h];break;case w:o=q,p=r,d=[h,j,g,j];break;case t:o=0,p=0,d=[i,g,j,g];break;case x:o=q,p=0,d=[h,i,g,i];break;case v:o=0,p=r,d=[j,g,i,g];break;default:o=0,p=0,d=[g,i,h,i]}for(n=0;n<l;)if(b=p+","+o,o>=0&&o<e&&p>=0&&p<f&&"undefined"==typeof m[b])switch(c(m,n++,[p,o]),d[z%d.length]){case g:o++;break;case i:p++;break;case h:o--;break;case j:p--}else{switch(d[z++%d.length]){case g:o--;break;case i:p--;break;case h:o++;break;case j:p++}switch(d[z++%d.length]){case g:o++;break;case i:p++;break;case h:o--;break;case j:p--}}return m},e.$FormationStraightStairs=function(d){var e=d.$Cols,f=d.$Rows,g=d.$Assembly,h=d.$Count,i=[],j=0,k=0,l=0,m=e-1,n=f-1,o=h-1;switch(g){case s:case v:case u:case t:var p=0,q=0;break;case x:case y:case w:case z:var p=m,q=0;break;default:g=z;var p=m,q=0}for(k=p,l=q;j<h;){switch(b(g)||a(g)?c(i,o-j++,[l,k]):c(i,j++,[l,k]),g){case s:case v:k--,l++;break;case u:case t:k++,l--;break;case x:case y:k--,l--;break;case z:case w:default:k++,l++}if(k<0||l<0||k>m||l>n){switch(g){case s:case v:p++;break;case x:case y:case u:case t:q++;break;case z:case w:default:p--}if(p<0||q<0||p>m||q>n){switch(g){case s:case v:p=m,q++;break;case u:case t:q=n,p++;break;case x:case y:q=n,p--;break;case z:case w:default:p=0,q++}q>n?q=n:q<0?q=0:p>m?p=m:p<0&&(p=0)}l=q,k=p}}return i},e.$FormationSquare=function(a){var b,e,f,g,h,i=a.$Cols||1,j=a.$Rows||1,k=[];for(f=i<j?(j-i)/2:0,g=i>j?(i-j)/2:0,h=d.round(d.max(i/2,j/2))+1,b=0;b<i;b++)for(e=0;e<j;e++)c(k,h-d.min(b+1+f,e+1+g,i-b+f,j-e+g),[e,b]);return k},e.$FormationRectangle=function(a){var b,e,f,g=a.$Cols||1,h=a.$Rows||1,i=[];for(f=d.round(d.min(g/2,h/2))+1,b=0;b<g;b++)for(e=0;e<h;e++)c(i,f-d.min(b+1,e+1,g-b,h-e),[e,b]);return i},e.$FormationRandom=function(a){for(var b,e=[],f=0;f<a.$Rows;f++)for(b=0;b<a.$Cols;b++)c(e,d.ceil(1e5*d.random())%13,[f,b]);return e},e.$FormationCircle=function(a){for(var b,e=a.$Cols||1,f=a.$Rows||1,g=[],h=e/2-.5,i=f/2-.5,j=0;j<e;j++)for(b=0;b<f;b++)c(g,d.round(d.sqrt(d.pow(j-h,2)+d.pow(b-i,2))),[b,j]);return g},e.$FormationCross=function(a){for(var b,e=a.$Cols||1,f=a.$Rows||1,g=[],h=e/2-.5,i=f/2-.5,j=0;j<e;j++)for(b=0;b<f;b++)c(g,d.round(d.min(d.abs(j-h),d.abs(b-i))),[b,j]);return g},e.$FormationRectangleCross=function(a){for(var b,e=a.$Cols||1,f=a.$Rows||1,g=[],h=e/2-.5,i=f/2-.5,j=d.max(h,i)+1,k=0;k<e;k++)for(b=0;b<f;b++)c(g,d.round(j-d.max(h-d.abs(k-h),i-d.abs(b-i)))-1,[b,k]);return g}};b.$JssorSlideshowRunner$=function(a,b,c,h,j){function l(a,b){var c={$Interval:b,$Duration:1,$Delay:0,$Cols:1,$Rows:1,$Opacity:0,$Zoom:0,$Clip:0,$Move:g,$SlideOut:g,$Reverse:g,$Formation:o.$FormationRandom,$Assembly:1032,$ChessMode:{$Column:0,$Row:0},$Easing:k.$EaseSwing,$Round:{},$Blocks:[],$During:{}};return m.$Extend(c,a),c.$Count=c.$Cols*c.$Rows,c.$Easing=m.$FormatEasings(c.$Easing),c.$FramesCount=d.ceil(c.$Duration/c.$Interval),c.$GetBlocks=function(a,b){a/=c.$Cols,b/=c.$Rows;var d=a+"x"+b;if(!c.$Blocks[d]){c.$Blocks[d]={$Width:a,$Height:b};for(var e=0;e<c.$Cols;e++)for(var f=0;f<c.$Rows;f++)c.$Blocks[d][f+","+e]={$Top:f*b,$Right:e*a+a,$Bottom:f*b+b,$Left:e*a}}return c.$Blocks[d]},c.$Brother&&(c.$Brother=l(c.$Brother,b),c.$SlideOut=f),c}function p(a,b,c,h,i,j){function k(a){var b=a.$Formation(a);return a.$Reverse?b.reverse():b}var l,n,o,p,q,r=this,s={},t={},u=[],v=c.$ChessMode.$Column||0,w=c.$ChessMode.$Row||0,x=c.$GetBlocks(i,j),y=k(c),z=y.length-1,A=c.$Duration+c.$Delay*z,B=h+A,C=c.$SlideOut;if(B+=50,r.$EndTime=B,r.$ShowFrame=function(a){a-=h;var b=a<A;if(b||q){q=b,C||(a=A-a);var e=d.ceil(a/c.$Interval);m.$Each(t,function(a,b){var c=d.max(e,a.$Min);c=d.min(c,a.length-1),a.$LastFrameIndex!=c&&(a.$LastFrameIndex||C?c==a.$Max&&C&&m.$HideElement(u[b]):m.$ShowElement(u[b]),a.$LastFrameIndex=c,m.$SetStyles(u[b],a[c]))})}},b=m.$CloneNode(b),m.$SetStyleTransform(b,e),m.$IsBrowserIe9Earlier()){var D=!b["no-image"],E=m.$FindChildrenByTag(b);m.$Each(E,function(a){(D||a["jssor-slider"])&&m.$CssOpacity(a,m.$CssOpacity(a),f)})}m.$Each(y,function(a,b){m.$Each(a,function(a){var e=a[0],h=a[1],k=e+","+h,q=g,r=g,u=g;v&&h%2&&(3&v&&(q=!q),12&v&&(r=!r),16&v&&(u=!u)),w&&e%2&&(3&w&&(q=!q),12&w&&(r=!r),16&w&&(u=!u)),c.$Top=c.$Top||4&c.$Clip,c.$Bottom=c.$Bottom||8&c.$Clip,c.$Left=c.$Left||1&c.$Clip,c.$Right=c.$Right||2&c.$Clip;var y=r?c.$Bottom:c.$Top,z=r?c.$Top:c.$Bottom,A=q?c.$Right:c.$Left,B=q?c.$Left:c.$Right;c.$Clip=y||z||A||B,p={},o={$Top:0,$Left:0,$Opacity:1,$Width:i,$Height:j},n=m.$Extend({},o),l=m.$Extend({},x[k]),c.$Opacity&&(o.$Opacity=2-c.$Opacity),c.$ZIndex&&(o.$ZIndex=c.$ZIndex,n.$ZIndex=0);var D=c.$Cols*c.$Rows>1||c.$Clip;if(c.$Zoom||c.$Rotate){var E=f;if(m.$IsBrowserIe9Earlier()&&(c.$Cols*c.$Rows>1?E=g:D=g),E){o.$Zoom=c.$Zoom?c.$Zoom-1:1,n.$Zoom=1,(m.$IsBrowserIe9Earlier()||m.$IsBrowserOpera())&&(o.$Zoom=d.min(o.$Zoom,2));var F=c.$Rotate||0;o.$Rotate=360*F*(u?-1:1),n.$Rotate=0}}if(D){var G=l.$Offset={};if(c.$Clip){var H=c.$ScaleClip||1;y&&z?(G.$Top=x.$Height/2*H,G.$Bottom=-G.$Top):y?G.$Bottom=-x.$Height*H:z&&(G.$Top=x.$Height*H),A&&B?(G.$Left=x.$Width/2*H,G.$Right=-G.$Left):A?G.$Right=-x.$Width*H:B&&(G.$Left=x.$Width*H)}p.$Clip=l,n.$Clip=x[k]}var I=q?1:-1,J=r?1:-1;c.x&&(o.$Left+=i*c.x*I),c.y&&(o.$Top+=j*c.y*J),m.$Each(o,function(a,b){m.$IsNumeric(a)&&a!=n[b]&&(p[b]=a-n[b])}),s[k]=C?n:o;var K=c.$FramesCount,L=d.round(b*c.$Delay/c.$Interval);t[k]=new Array(L),t[k].$Min=L,t[k].$Max=L+K-1;for(var M=0;M<=K;M++){var N=m.$Cast(n,p,M/K,c.$Easing,c.$During,c.$Round,{$Move:c.$Move,$OriginalWidth:i,$OriginalHeight:j});N.$ZIndex=N.$ZIndex||1,t[k].push(N)}})}),y.reverse(),m.$Each(y,function(c){m.$Each(c,function(c){var d=c[0],e=c[1],f=d+","+e,g=b;(e||d)&&(g=m.$CloneNode(b)),m.$SetStyles(g,s[f]),m.$CssOverflow(g,"hidden"),m.$CssPosition(g,"absolute"),a.$AddClipElement(g),u[f]=g,m.$ShowElement(g,!C)})})}function q(){var a=this,b=0;n.call(a,0,r),a.$OnPositionChange=function(a,c){c-b>y&&(b=c,t&&t.$ShowFrame(c),s&&s.$ShowFrame(c))},a.$Transition=u}var r,s,t,u,v=this,w=0,x=h.$TransitionsOrder,y=8;v.$GetTransition=function(){var a=0,b=h.$Transitions,c=b.length;return a=x?w++%c:d.floor(d.random()*c),b[a]&&(b[a].$Index=a),b[a]},v.$Initialize=function(e,f,g,h,i){u=i,i=l(i,y);var j=h.$Item,k=g.$Item;j["no-image"]=!h.$Image,k["no-image"]=!g.$Image;var m=j,n=k,o=i,q=i.$Brother||l({},y);i.$SlideOut||(m=k,n=j);var w=q.$Shift||0;s=new p(a,n,q,d.max(w-q.$Interval,0),b,c),t=new p(a,m,o,d.max(q.$Interval-w,0),b,c),s.$ShowFrame(0),t.$ShowFrame(0),r=d.max(s.$EndTime,t.$EndTime),v.$Index=e},v.$Clear=function(){a.$Clear(),s=e,t=e},v.$GetProcessor=function(){var a=e;return t&&(a=new q),a},(m.$IsBrowserIe9Earlier()||m.$IsBrowserOpera()||j&&m.$WebKitVersion()<537)&&(y=16),i.call(v),n.call(v,-1e7,1e7)};var p=b.$JssorSlider$=function(a,l){function o(){var a=this;n.call(a,-1e8,2e8),a.$GetCurrentSlideInfo=function(){var b=a.$GetPosition_Display(),c=d.floor(b),e=O(c),f=b-d.floor(b);return{$Index:e,$VirtualIndex:c,$Position:f}},a.$OnPositionChange=function(a,b){var c=d.floor(b);c!=b&&b>a&&c++,K(c,f),Z.$TriggerEvent(p.$EVT_POSITION_CHANGE,O(b),O(a),b,a)}}function r(){var a=this;n.call(a,0,0,{$LoopLength:Wa}),m.$Each(ub,function(b){1&hb&&b.$SetLoopLength(Wa),a.$Chain(b),b.$Shift(Ha/ab)})}function s(){var a=this,b=lb.$Elmt;n.call(a,-1,2,{$Easing:k.$EaseLinear,$Setter:{$Position:y},$LoopLength:Wa},b,{$Position:1},{$Position:-2}),a.$Wrapper=b}function t(a,b){var c,d,h,i,j,k=this;n.call(k,-1e8,2e8,{$IntervalMax:100}),k.$OnStart=function(){Ka=f,Ma=e,Z.$TriggerEvent(p.$EVT_SWIPE_START,O(Ra.$GetPosition()),Ra.$GetPosition())},k.$OnStop=function(){Ka=g,i=g;var a=Ra.$GetCurrentSlideInfo();Z.$TriggerEvent(p.$EVT_SWIPE_END,O(Ra.$GetPosition()),Ra.$GetPosition()),!a.$Position&&J(a.$VirtualIndex,Va)},k.$OnPositionChange=function(a,b){var e;if(i)e=j;else if(e=d,h){var f=b/h;e=$.$SlideEasing(f)*(d-c)+c}Ra.$GoToPosition(e)},k.$PlayCarousel=function(a,b,e,f){c=a,d=b,h=e,Ra.$GoToPosition(a),k.$GoToPosition(0),k.$PlayToPosition(e,f)},k.$StandBy=function(a){i=f,j=a,k.$Play(a,e,f)},k.$SetStandByPosition=function(a){j=a},k.$MoveCarouselTo=function(a){Ra.$GoToPosition(a)},Ra=new o,Ra.$Combine(a),Ra.$Combine(b)}function u(){var a=this,b=N();m.$CssZIndex(b,0),m.$Css(b,"pointerEvents","none"),a.$Elmt=b,a.$AddClipElement=function(a){m.$AppendChild(b,a),m.$ShowElement(b)},a.$Clear=function(){m.$HideElement(b),m.$Empty(b)}}function v(a,b){function c(b){v&&v.$Revert(),u(a,b,0),G=f,v=new ca.$Class(a,ca,m.$ParseFloat(m.$AttributeEx(a,"idle"))||eb),v.$GoToPosition(0)}function h(){v.$Version<ca.$Version&&c()}function j(a,c,d){if(!E&&(E=f,A&&d)){var e=d.width,h=d.height,i=e,j=h;if(e&&h&&$.$FillMode){if(3&$.$FillMode&&(!(4&$.$FillMode)||e>Xa||h>Ya)){var k=g,l=Xa/Ya*h/e;1&$.$FillMode?k=l>1:2&$.$FillMode&&(k=l<1),i=k?e*Ya/h:Xa,j=k?Ya:h*Xa/e}m.$CssWidth(A,i),m.$CssHeight(A,j),m.$CssTop(A,(Ya-j)/2),m.$CssLeft(A,(Xa-i)/2)}m.$CssPosition(A,"absolute"),Z.$TriggerEvent(p.$EVT_LOAD_END,b)}m.$HideElement(c),a&&a(L)}function k(a,c,d,e){if(e==Ma&&Va==b&&Ea&&!Da){var f=O(a);nb.$Initialize(f,b,c,L,d),c.$HideContentForSlideshow(),Sa.$Shift(f-Sa.$GetPosition_OuterBegin()-1),Sa.$GoToPosition(f),Ta.$PlayCarousel(a,a,0)}}function l(c){if(c==Ma&&Va==b){if(!H){var d=e;nb&&(nb.$Index==b?d=nb.$GetProcessor():nb.$Clear()),h(),H=new w(a,b,d,v),H.$SetPlayer(J)}!H.$IsPlaying()&&H.$Replay()}}function o(a,c,f){if(a==b){a!=c?ub[c]&&ub[c].$ParkOut():!f&&H&&H.$AdjustIdleOnPark(),J&&J.$Enable();var g=Ma=m.$GetNow();L.$LoadImage(m.$CreateCallback(e,l,g))}else{var h=d.min(b,a),i=d.max(b,a),j=d.min(i-h,h+Wa-i),k=bb+$.$LazyLoading-1;(!F||j<=k)&&L.$LoadImage()}}function q(){Va==b&&H&&(H.$Stop(),J&&J.$Quit(),J&&J.$Disable(),H.$OpenSlideshowPanel())}function r(){Va==b&&H&&H.$Stop()}function s(a){!Ja&&Z.$TriggerEvent(p.$EVT_CLICK,b,a)}function t(){J=I.pInstance,H&&H.$SetPlayer(J)}function u(a,b,c){if(!m.$Attribute(a,"jssor-slider")){G||("IMG"==a.tagName&&(M.push(a),m.$Attribute(a,"src")||(F=f,a["display-origin"]=m.$CssDisplay(a),m.$HideElement(a))),m.$IsBrowserIe9Earlier()&&m.$CssZIndex(a,(m.$CssZIndex(a)||0)+1));var d=m.$Children(a);m.$Each(d,function(d){var e=d.tagName,h=m.$AttributeEx(d,"u");if("player"!=h||I||(I=d,I.pInstance?t():m.$AddEvent(I,"dataavailable",t)),"caption"==h){if(b)m.$CssTransformOrigin(d,m.$AttributeEx(d,"to")),m.$CssBackfaceVisibility(d,m.$AttributeEx(d,"bf")),m.$AttributeEx(d,"3d")&&m.$CssTransformStyle(d,"preserve-3d");else if(!m.$IsBrowserIE()){var i=m.$CloneNode(d,g,f);m.$InsertBefore(i,d,a),m.$RemoveElement(d,a),d=i,b=f}}else G||c||A||("A"==e?(A="image"==m.$AttributeEx(d,"u")?m.$FindChildByTag(d,"IMG"):m.$FindChild(d,"image",f),A&&(B=d,m.$CssDisplay(B,"block"),m.$SetStyles(B,ea),C=m.$CloneNode(B,f),m.$CssPosition(B,"relative"),m.$CssOpacity(C,0),m.$Css(C,"backgroundColor","#000"))):"IMG"==e&&"image"==m.$AttributeEx(d,"u")&&(A=d),A&&(A.border=0,m.$SetStyles(A,ea)));u(d,b,c+1)})}}var v,x,z,A,B,C,D,E,F,G,H,I,J,K,L=this,M=[];n.call(L,-bb,bb+1,{$SlideItemAnimator:f}),L.$LoadImage=function(a,c){c=c||z,M.length&&!E?(m.$ShowElement(c),D||(D=f,Z.$TriggerEvent(p.$EVT_LOAD_START,b),m.$Each(M,function(a){m.$Attribute(a,"src")||(a.src=m.$AttributeEx(a,"src2"),m.$CssDisplay(a,a["display-origin"]))})),m.$LoadImages(M,A,m.$CreateCallback(e,j,a,c))):j(a,c)},L.$GoForNextSlide=function(){var a=b;$.$AutoPlaySteps<0&&(a-=Wa);var c=a+$.$AutoPlaySteps*aa;if(2&hb&&(c=O(c)),1&hb||(c=d.max(0,d.min(c,Wa-bb))),c!=b){if(nb){var f=nb.$GetTransition(Wa);if(f){var g=Ma=m.$GetNow(),h=ub[O(c)];return h.$LoadImage(m.$CreateCallback(e,k,c,h,f,g),z)}}V(c)}},L.$TryActivate=function(){o(b,b,f)},L.$ParkOut=function(){J&&J.$Quit(),J&&J.$Disable(),L.$UnhideContentForSlideshow(),H&&H.$Abort(),H=e,c()},L.$StampSlideItemElements=function(a){a=K+"_"+a},L.$HideContentForSlideshow=function(){m.$HideElement(a)},L.$UnhideContentForSlideshow=function(){m.$ShowElement(a)},L.$EnablePlayer=function(){J&&J.$Enable()},L.$OnInnerOffsetChange=function(a,b){var c=bb-b;y(x,c)},L.$Index=b,i.call(L),m.$CssPerspective(a,m.$AttributeEx(a,"p")),m.$CssPerspectiveOrigin(a,m.$AttributeEx(a,"po"));var N=m.$FindChild(a,"thumb",f);N&&(L.$Thumb=m.$CloneNode(N),m.$HideElement(N)),m.$ShowElement(a),z=m.$CloneNode(ka),m.$CssZIndex(z,1e3),m.$AddEvent(a,"click",s),c(f),L.$Image=A,L.$Link=C,L.$Item=a,L.$Wrapper=x=a,m.$AppendChild(x,z),Z.$On(203,o),Z.$On(28,r),Z.$On(24,q)}function w(a,b,c,d){function e(){m.$Empty(ob),Ca&&q&&w.$Link&&m.$AppendChild(ob,w.$Link),m.$ShowElement(ob,!q&&w.$Image)}function h(){t.$Replay()}function i(a){s=a,t.$Stop(),t.$Replay()}var j,k,l,o,q,r,s,t=this,u=0,v=0,w=ub[b];n.call(t,0,0),t.$Replay=function(){var a=t.$GetPosition_Display();if(!La&&!Ka&&!s&&Va==b){a||(j&&!q&&(q=f,t.$OpenSlideshowPanel(f),Z.$TriggerEvent(p.$EVT_SLIDESHOW_START,b,u,v,j,o)),e());var c,d=p.$EVT_STATE_CHANGE;a!=o&&(c=a==l?o:a==k?l:a?t.$GetPlayToPosition():k),Z.$TriggerEvent(d,b,a,u,k,l,o);var g=Ea&&(!db||ib);a==o?(l!=o&&!(12&db)||g)&&w.$GoForNextSlide():(g||a!=l)&&t.$PlayToPosition(c,h)}},t.$AdjustIdleOnPark=function(){l==o&&l==t.$GetPosition_Display()&&t.$GoToPosition(k)},t.$Abort=function(){nb&&nb.$Index==b&&nb.$Clear();var a=t.$GetPosition_Display();a<o&&Z.$TriggerEvent(p.$EVT_STATE_CHANGE,b,-a-1,u,k,l,o)},t.$OpenSlideshowPanel=function(a){c&&m.$CssOverflow(va,a&&c.$Transition.$Outside?"":"hidden")},t.$OnInnerOffsetChange=function(a,c){q&&c>=j&&(q=g,e(),w.$UnhideContentForSlideshow(),nb.$Clear(),Z.$TriggerEvent(p.$EVT_SLIDESHOW_END,b,u,v,j,o)),Z.$TriggerEvent(p.$EVT_PROGRESS_CHANGE,b,c,u,k,l,o)},t.$SetPlayer=function(a){a&&!r&&(r=a,a.$On($JssorPlayer$.$EVT_SWITCH,i))},c&&t.$Chain(c),j=t.$GetPosition_OuterEnd(),t.$Chain(d),k=j+d.$IdleBegin,l=j+d.$IdleEnd,o=t.$GetPosition_OuterEnd()}function x(a,b,c){m.$CssLeft(a,b),m.$CssTop(a,c)}function y(a,b){var c=wa>0?wa:_,d=$a*b*(1&c),e=_a*b*(c>>1&1);x(a,d,e)}function z(){qb=Ka,rb=Ta.$GetPlayToPosition(),pb=Ra.$GetPosition()}function A(){z(),(La||!ib&&12&db)&&(Ta.$Stop(),Z.$TriggerEvent(p.$EVT_FREEZE))}function B(a){if(!La&&(ib||!(12&db))&&!Ta.$IsPlaying()){var b=Ra.$GetPosition(),c=d.ceil(pb);a&&d.abs(Na)>=$.$MinDragOffsetToSlide&&(c=d.ceil(b),c+=Pa),1&hb||(c=d.min(Wa-bb,d.max(c,0)));var e=d.abs(c-b);e=1-d.pow(1-e,5),!Ja&&qb?Ta.$Continue(rb):b==c?(ua.$EnablePlayer(),ua.$TryActivate()):Ta.$PlayCarousel(b,c,e*fb)}}function C(a){!m.$AttributeEx(m.$EvtSrc(a),"nodrag")&&m.$CancelEvent(a)}function D(a){E(a,1)}function E(a,b){a=m.$GetEvent(a);var d=m.$EvtSrc(a);if(!xa&&!m.$AttributeEx(d,"nodrag")&&L()&&(!b||1==a.touches.length)){if(La=f,ya=g,Ma=e,m.$AddEvent(c,b?"touchmove":"mousemove",F),m.$GetNow(),Ja=0,A(),qb||(wa=0),b){var h=a.touches[0];jb=h.clientX,kb=h.clientY}else{var i=m.$MousePosition(a);jb=i.x,kb=i.y}Na=0,Oa=0,Pa=0,Z.$TriggerEvent(p.$EVT_DRAG_START,O(pb),pb,a)}}function F(a){if(La){a=m.$GetEvent(a);var b;if("mousemove"!=a.type){var c=a.touches[0];b={x:c.clientX,y:c.clientY}}else b=m.$MousePosition(a);if(b){var e=b.x-jb,g=b.y-kb;if(d.floor(pb)!=pb&&(wa=wa||_&xa),!e&&!g||wa||(wa=3==xa?d.abs(g)>d.abs(e)?2:1:xa,wb&&1==wa&&d.abs(g)-d.abs(e)>3&&(ya=f)),wa){var h=g,i=_a;if(1==wa&&(h=e,i=$a),!(1&hb)){
if(h>0){var j=i*Va,k=h-j;k>0&&(h=j+5*d.sqrt(k))}if(h<0){var j=i*(Wa-bb-Va),k=-h-j;k>0&&(h=-j-5*d.sqrt(k))}}Na-Oa<-2?Pa=0:Na-Oa>2&&(Pa=-1),Oa=Na,Na=h,sb=pb-Na/i/(Ua||1),Na&&wa&&!ya&&(m.$CancelEvent(a),Ka?Ta.$SetStandByPosition(sb):Ta.$StandBy(sb))}}}}function G(){if(M(),La){La=g,m.$GetNow(),m.$RemoveEvent(c,"mousemove",F),m.$RemoveEvent(c,"touchmove",F),Ja=Na,Ta.$Stop();var a=Ra.$GetPosition();Z.$TriggerEvent(p.$EVT_DRAG_END,O(a),a,O(pb),pb),12&db&&z(),B(f)}}function H(a){if(Ja){m.$StopEvent(a);for(var b=m.$EvtSrc(a);b&&ja!==b;){"A"==b.tagName&&m.$CancelEvent(a);try{b=b.parentNode}catch(c){break}}}}function I(a){return ub[Va],Va=O(a),ua=ub[Va],K(a),Va}function J(a,b){wa=0,I(a),Z.$TriggerEvent(p.$EVT_PARK,O(a),b)}function K(a,b){ta=a,m.$Each(cb,function(c){c.$SetCurrentIndex(O(a),a,b)})}function L(){var a=p.$DragRegistry||0,b=Ia;return wb&&1&b&&(b&=1),p.$DragRegistry|=b,xa=b&~a}function M(){xa&&(p.$DragRegistry&=~Ia,xa=0)}function N(){var a=m.$CreateDiv();return m.$SetStyles(a,ea),m.$CssPosition(a,"absolute"),a}function O(a){return(a%Wa+Wa)%Wa}function P(a,b){b&&(hb?2&hb&&(a=O(a+ta),b=g):(a=d.min(d.max(a+ta,0),Wa-bb),b=g)),V(a,$.$SlideDuration,b)}function Q(){m.$Each(cb,function(a){a.$Show(a.$Options.$ChanceToShow<=ib)})}function R(){ib||(ib=1,Q(),La||(12&db&&B(),3&db&&ub[Va].$TryActivate()))}function S(){ib&&(ib=0,Q(),La||!(12&db)||A())}function T(){ea={$Width:Xa,$Height:Ya,$Top:0,$Left:0},m.$Each(ra,function(a){m.$SetStyles(a,ea),m.$CssPosition(a,"absolute"),m.$CssOverflow(a,"hidden"),m.$HideElement(a)}),m.$SetStyles(ka,ea)}function U(a,b){V(a,b,f)}function V(a,b,c){if(gb&&(!La&&(ib||!(12&db))||$.$NaviQuitDrag)){Ka=f,La=g,Ta.$Stop(),b==h&&(b=fb);var e=Qa.$GetPosition_Display(),i=a;c&&(i=e+a,i=a>0?d.ceil(i):d.floor(i)),2&hb&&(i=O(i)),1&hb||(i=d.max(0,d.min(i,Wa-bb)));var j=(i-e)%Wa;i=e+j;var k=e==i?0:b*d.abs(j);k=d.min(k,b*bb*1.5),Ta.$PlayCarousel(e,i,k||1)}}function W(){return m.$CssWidth(da||a)}function X(){return m.$CssHeight(da||a)}function Y(b,d){if(b==h)return m.$CssWidth(a);if(!da){var e=m.$CreateDiv(c);m.$ClassName(e,m.$ClassName(a)),m.$CssCssText(e,m.$CssCssText(a)),m.$CssDisplay(e,"block"),m.$CssPosition(e,"relative"),m.$CssTop(e,0),m.$CssLeft(e,0),m.$CssOverflow(e,"visible"),da=m.$CreateDiv(c),m.$CssPosition(da,"absolute"),m.$CssTop(da,0),m.$CssLeft(da,0),m.$CssWidth(da,m.$CssWidth(a)),m.$CssHeight(da,m.$CssHeight(a)),m.$CssTransformOrigin(da,"0 0"),m.$AppendChild(da,e);var f=m.$Children(a);m.$AppendChild(a,da),m.$Css(a,"backgroundImage",""),m.$Each(f,function(b){m.$AppendChild(m.$AttributeEx(b,"noscale")?a:e,b),m.$AttributeEx(b,"autocenter")&&mb.push(b)})}Ua=b/(d?m.$CssHeight:m.$CssWidth)(da),m.$CssScale(da,Ua);var g=d?Ua*W():b,i=d?b:Ua*X();m.$CssWidth(a,g),m.$CssHeight(a,i),m.$Each(mb,function(a){var b=m.$ParseInt(m.$AttributeEx(a,"autocenter"));m.$CenterElement(a,b)})}var Z=this;Z.$PlayTo=V,Z.$GoTo=function(a){Ra.$GoToPosition(I(a))},Z.$Next=function(){U(1)},Z.$Prev=function(){U(-1)},Z.$Pause=function(){Ea=g},Z.$Play=function(){Ea||(Ea=f,ub[Va]&&ub[Va].$TryActivate())},Z.$SetSlideshowTransitions=function(a){$.$SlideshowOptions.$Transitions=a},Z.$SetCaptionTransitions=function(a){ca.$Transitions=a,ca.$Version=m.$GetNow()},Z.$SlidesCount=function(){return ra.length},Z.$CurrentIndex=function(){return Va},Z.$IsAutoPlaying=function(){return Ea},Z.$IsDragging=function(){return La},Z.$IsSliding=function(){return Ka},Z.$IsMouseOver=function(){return!ib},Z.$LastDragSucceded=function(){return Ja},Z.$OriginalWidth=Z.$GetOriginalWidth=W,Z.$OriginalHeight=Z.$GetOriginalHeight=X,Z.$ScaleHeight=Z.$GetScaleHeight=function(b){return b==h?m.$CssHeight(a):void Y(b,f)},Z.$ScaleWidth=Z.$SetScaleWidth=Z.$GetScaleWidth=Y,Z.$GetVirtualIndex=function(a){var b=d.ceil(O(Ha/ab)),c=O(a-Va+b);return c>bb?a-Va>Wa/2?a-=Wa:a-Va<=-Wa/2&&(a+=Wa):a=Va+c-b,a},i.call(Z),Z.$Elmt=a=m.$GetElement(a);var $=m.$Extend({$FillMode:0,$LazyLoading:1,$ArrowKeyNavigation:1,$StartIndex:0,$AutoPlay:g,$Loop:1,$HWA:f,$NaviQuitDrag:f,$AutoPlaySteps:1,$AutoPlayInterval:3e3,$PauseOnHover:1,$SlideDuration:500,$SlideEasing:k.$EaseOutQuad,$MinDragOffsetToSlide:20,$SlideSpacing:0,$Cols:1,$Align:0,$UISearchMode:1,$PlayOrientation:1,$DragOrientation:1},l);$.$HWA=$.$HWA&&m.$IsBrowser3dSafe(),$.$Idle!=h&&($.$AutoPlayInterval=$.$Idle),$.$ParkingPosition!=h&&($.$Align=$.$ParkingPosition);var _=3&$.$PlayOrientation,aa=(4&$.$PlayOrientation)/-4||1,ba=$.$SlideshowOptions,ca=m.$Extend({$Class:j,$PlayInMode:1,$PlayOutMode:1,$HWA:$.$HWA},$.$CaptionSliderOptions);ca.$Transitions=ca.$Transitions||ca.$CaptionTransitions;var da,ea,fa=$.$BulletNavigatorOptions,ga=$.$ArrowNavigatorOptions,ha=$.$ThumbnailNavigatorOptions,ia=!$.$UISearchMode,ja=m.$FindChild(a,"slides",ia),ka=m.$FindChild(a,"loading",ia)||m.$CreateDiv(c),la=m.$FindChild(a,"navigator",ia),ma=m.$FindChild(a,"arrowleft",ia),na=m.$FindChild(a,"arrowright",ia),oa=m.$FindChild(a,"thumbnavigator",ia),pa=m.$CssWidth(ja),qa=m.$CssHeight(ja),ra=[],sa=m.$Children(ja);m.$Each(sa,function(a){"DIV"!=a.tagName||m.$AttributeEx(a,"u")?m.$IsBrowserIe9Earlier()&&m.$CssZIndex(a,(m.$CssZIndex(a)||0)+1):ra.push(a)});var ta,ua,va,wa,xa,ya,za,Aa,Ba,Ca,Da,Ea,Fa,Ga,Ha,Ia,Ja,Ka,La,Ma,Na,Oa,Pa,Qa,Ra,Sa,Ta,Ua,Va=-1,Wa=ra.length,Xa=$.$SlideWidth||pa,Ya=$.$SlideHeight||qa,Za=$.$SlideSpacing,$a=Xa+Za,_a=Ya+Za,ab=1&_?$a:_a,bb=d.min($.$Cols,Wa),cb=[],db=$.$PauseOnHover,eb=$.$AutoPlayInterval,fb=$.$SlideDuration,gb=bb<Wa,hb=gb?$.$Loop:0,ib=1,jb=0,kb=0,lb=new u,mb=[];if(Wa){$.$HWA&&(x=function(a,b,c){m.$SetStyleTransform(a,{$TranslateX:b,$TranslateY:c})}),Ea=$.$AutoPlay,Z.$Options=l,T(),m.$Attribute(a,"jssor-slider",f),m.$CssZIndex(ja,m.$CssZIndex(ja)||0),m.$CssPosition(ja,"absolute"),va=m.$CloneNode(ja,f),m.$InsertBefore(va,ja),ba&&(Ca=ba.$ShowLink,Fa=ba.$Class,Ga=1==bb&&Wa>1&&Fa&&(!m.$IsBrowserIE()||m.$BrowserVersion()>=8)),Ha=Ga||bb>=Wa||!(1&hb)?0:$.$Align,Ia=(bb>1||Ha?_:-1)&$.$DragOrientation;var nb,ob,pb,qb,rb,sb,tb=ja,ub=[],vb=m.$Device(),wb=vb.$Touchable;vb.$TouchActionAttr&&m.$Css(tb,vb.$TouchActionAttr,[e,"pan-y","pan-x","none"][Ia]||""),Sa=new s,Ga&&(nb=new Fa(lb,Xa,Ya,ba,wb)),m.$AppendChild(va,Sa.$Wrapper),m.$CssOverflow(ja,"hidden"),ob=N(),m.$Css(ob,"backgroundColor","#000"),m.$CssOpacity(ob,0),m.$InsertBefore(ob,tb.firstChild,tb);for(var xb=0;xb<ra.length;xb++){var yb=ra[xb],zb=new v(yb,xb);ub.push(zb)}m.$HideElement(ka),Qa=new r,Ta=new t(Qa,Sa),Ia&&(m.$AddEvent(ja,"mousedown",E),m.$AddEvent(ja,"touchstart",D),m.$AddEvent(ja,"dragstart",C),m.$AddEvent(ja,"selectstart",C),m.$AddEvent(c,"mouseup",G),m.$AddEvent(c,"touchend",G),m.$AddEvent(c,"touchcancel",G),m.$AddEvent(b,"blur",G)),db&=wb?10:5,la&&fa&&(za=new fa.$Class(la,fa,W(),X()),cb.push(za)),ga&&ma&&na&&(ga.$Loop=hb,ga.$Cols=bb,Aa=new ga.$Class(ma,na,ga,W(),X()),cb.push(Aa)),oa&&ha&&(ha.$StartIndex=$.$StartIndex,Ba=new ha.$Class(oa,ha),cb.push(Ba)),m.$Each(cb,function(a){a.$Reset(Wa,ub,ka),a.$On(q.$NAVIGATIONREQUEST,P)}),m.$Css(a,"visibility","visible"),Y(W()),m.$AddEvent(ja,"click",H,f),m.$AddEvent(a,"mouseout",m.$MouseOverOutFilter(R,a)),m.$AddEvent(a,"mouseover",m.$MouseOverOutFilter(S,a)),Q(),$.$ArrowKeyNavigation&&m.$AddEvent(c,"keydown",function(a){37==a.keyCode?U(-$.$ArrowKeyNavigation):39==a.keyCode&&U($.$ArrowKeyNavigation)});var Ab=$.$StartIndex;1&hb||(Ab=d.max(0,d.min(Ab,Wa-bb))),Ta.$PlayCarousel(Ab,Ab,0)}};p.$EVT_CLICK=21,p.$EVT_DRAG_START=22,p.$EVT_DRAG_END=23,p.$EVT_SWIPE_START=24,p.$EVT_SWIPE_END=25,p.$EVT_LOAD_START=26,p.$EVT_LOAD_END=27,p.$EVT_FREEZE=28,p.$EVT_POSITION_CHANGE=202,p.$EVT_PARK=203,p.$EVT_SLIDESHOW_START=206,p.$EVT_SLIDESHOW_END=207,p.$EVT_PROGRESS_CHANGE=208,p.$EVT_STATE_CHANGE=209;var q={$NAVIGATIONREQUEST:1,$INDEXCHANGE:2,$RESET:3};b.$JssorBulletNavigator$=function(a,b){function c(a){a!=-1&&B[a].$Selected(a==z)}function h(a){j.$TriggerEvent(q.$NAVIGATIONREQUEST,a*r)}var j=this;i.call(j),a=m.$GetElement(a);var k,l,n,o,p,r,s,t,u,v,w,x,y,z=0,A=[],B=[];j.$Elmt=a,j.$GetCurrentIndex=function(){return o},j.$SetCurrentIndex=function(a){if(a!=o){var b=z,e=d.floor(a/r);z=e,o=a,c(b),c(e)}},j.$Show=function(b){m.$ShowElement(a,b)};var C;j.$Reset=function(b){if(!C){k=d.ceil(b/r),z=0;var c=x+t,g=y+u,i=d.ceil(k/s)-1;l=x+c*(v?s-1:i),n=y+g*(v?i:s-1),m.$CssWidth(a,l),m.$CssHeight(a,n);for(var j=0;j<k;j++){var o=m.$CreateSpan();m.$InnerText(o,j+1);var q=m.$BuildElement(w,"numbertemplate",o,f);m.$CssPosition(q,"absolute");var D=j%(i+1);m.$CssLeft(q,v?j%s*c:c*D),m.$CssTop(q,v?g*D:d.floor(j/(i+1))*g),m.$AppendChild(a,q),A[j]=q,1&p.$ActionMode&&m.$AddEvent(q,"click",m.$CreateCallback(e,h,j)),2&p.$ActionMode&&m.$AddEvent(q,"mouseover",m.$MouseOverOutFilter(m.$CreateCallback(e,h,j),q)),B[j]=m.$Buttonize(q)}C=f}},j.$Options=p=m.$Extend({$SpacingX:10,$SpacingY:10,$Orientation:1,$ActionMode:1},b),w=m.$FindChild(a,"prototype"),x=m.$CssWidth(w),y=m.$CssHeight(w),m.$RemoveElement(w,a),r=p.$Steps||1,s=p.$Rows||1,t=p.$SpacingX,u=p.$SpacingY,v=p.$Orientation-1,p.$Scale==g&&m.$Attribute(a,"noscale",f),p.$AutoCenter&&m.$Attribute(a,"autocenter",p.$AutoCenter)},b.$JssorArrowNavigator$=function(a,b,c){function d(a){j.$TriggerEvent(q.$NAVIGATIONREQUEST,a,f)}function h(d){m.$ShowElement(a,d||!c.$Loop&&0==n),m.$ShowElement(b,d||!c.$Loop&&n>=l-c.$Cols),k=d}var j=this;i.call(j);var k,l,n,o,p;m.$CssWidth(a),m.$CssHeight(a),j.$GetCurrentIndex=function(){return n},j.$SetCurrentIndex=function(a,b,c){c?n=b:(n=a,h(k))},j.$Show=h;var r;j.$Reset=function(c){l=c,n=0,r||(m.$AddEvent(a,"click",m.$CreateCallback(e,d,-p)),m.$AddEvent(b,"click",m.$CreateCallback(e,d,p)),m.$Buttonize(a),m.$Buttonize(b),r=f)},j.$Options=o=m.$Extend({$Steps:1},c),p=o.$Steps,o.$Scale==g&&(m.$Attribute(a,"noscale",f),m.$Attribute(b,"noscale",f)),o.$AutoCenter&&(m.$Attribute(a,"autocenter",o.$AutoCenter),m.$Attribute(b,"autocenter",o.$AutoCenter))},b.$JssorThumbnailNavigator$=function(a,b){function c(a,b){function c(){h.$Selected(j==b)}function d(a){if(a||!w.$LastDragSucceded()){var c=o-b%o,d=w.$GetVirtualIndex((b+c)/o-1),e=d*o+o-c;z.$TriggerEvent(q.$NAVIGATIONREQUEST,e)}}var g,h,i,l=this;l.$Index=b,l.$Highlight=c,i=a.$Thumb||a.$Image||m.$CreateDiv(),l.$Wrapper=g=m.$BuildElement(y,"thumbnailtemplate",i,f),h=m.$Buttonize(g),1&k.$ActionMode&&m.$AddEvent(g,"click",m.$CreateCallback(e,d,0)),2&k.$ActionMode&&m.$AddEvent(g,"mouseover",m.$MouseOverOutFilter(m.$CreateCallback(e,d,1),g))}var h,j,k,l,n,o,r,s,t,u,v,w,x,y,z=this,A=[];i.call(z),a=m.$GetElement(a),z.$GetCurrentIndex=function(){return j},z.$SetCurrentIndex=function(a,b,c){var e=j;j=a,e!=-1&&A[e].$Highlight(),A[a].$Highlight(),!c&&w.$PlayTo(w.$GetVirtualIndex(d.floor(b/o)))},z.$Show=function(b){m.$ShowElement(a,b)};var B;z.$Reset=function(b,e){if(!B){h=b,d.ceil(h/o),j=-1,v=d.min(v,e.length);var i=1&k.$Orientation,q=t+(t+r)*(o-1)*(1-i),y=u+(u+s)*(o-1)*i,z=q+(q+r)*(v-1)*i,C=y+(y+s)*(v-1)*(1-i);m.$CssPosition(x,"absolute"),m.$CssOverflow(x,"hidden"),1&k.$AutoCenter&&m.$CssLeft(x,(l-z)/2),2&k.$AutoCenter&&m.$CssTop(x,(n-C)/2),m.$CssWidth(x,z),m.$CssHeight(x,C);var D=[];m.$Each(e,function(a,b){var e=new c(a,b),f=e.$Wrapper,g=d.floor(b/o),h=b%o;m.$CssLeft(f,(t+r)*h*(1-i)),m.$CssTop(f,(u+s)*h*i),D[g]||(D[g]=m.$CreateDiv(),m.$AppendChild(x,D[g])),m.$AppendChild(D[g],f),A.push(e)});var E=m.$Extend({$AutoPlay:g,$NaviQuitDrag:g,$SlideWidth:q,$SlideHeight:y,$SlideSpacing:r*i+s*(1-i),$MinDragOffsetToSlide:12,$SlideDuration:200,$PauseOnHover:1,$PlayOrientation:k.$Orientation,$DragOrientation:k.$NoDrag||k.$DisableDrag?0:k.$Orientation},k);w=new p(a,E),B=f}},z.$Options=k=m.$Extend({$SpacingX:0,$SpacingY:0,$Cols:1,$Orientation:1,$AutoCenter:3,$ActionMode:1},b),l=m.$CssWidth(a),n=m.$CssHeight(a),x=m.$FindChild(a,"slides",f),y=m.$FindChild(x,"prototype"),t=m.$CssWidth(y),u=m.$CssHeight(y),m.$RemoveElement(y,x),o=k.$Rows||1,r=k.$SpacingX,s=k.$SpacingY,v=k.$Cols,k.$Scale==g&&m.$Attribute(a,"noscale",f)},b.$JssorCaptionSlideo$=function(a,b,c){function d(a,b){var c={};return m.$Each(a,function(a,e){var f=p[e];f&&(m.$IsPlainObject(a)?a=d(a,b||"e"==e):b&&m.$IsNumeric(a)&&(a=k[a]),c[f]=a)}),c}function e(a,b){var c=[],d=m.$Children(a);return m.$Each(d,function(a){var d="caption"==m.$AttributeEx(a,"u");if(d){var f=m.$AttributeEx(a,"t"),g=q[m.$ParseInt(f)]||q[f],h={$Elmt:a,$Transition:g};c.push(h)}b<5&&(c=c.concat(e(a,b+1)))}),c}function g(a,b,c){return m.$Each(b,function(b){var e=d(b),f=m.$FormatEasings(e.$Easing);e.$Left&&(e.$MoveX=e.$Left,f.$MoveX=f.$Left,delete e.$Left),e.$Top&&(e.$MoveY=e.$Top,f.$MoveY=f.$Top,delete e.$Top);var g={$Easing:f,$OriginalWidth:c.$Width,$OriginalHeight:c.$Height},h=new n(b.b,b.d,g,a,c,e);r.$Combine(h),c=m.$AddDif(c,e)}),c}function h(a){m.$Each(a,function(a){var b=a.$Elmt,c=m.$CssWidth(b),d=m.$CssHeight(b),e={$Left:m.$CssLeft(b),$Top:m.$CssTop(b),$MoveX:0,$MoveY:0,$Opacity:1,$ZIndex:m.$CssZIndex(b)||0,$Rotate:0,$RotateX:0,$RotateY:0,$ScaleX:1,$ScaleY:1,$TranslateX:0,$TranslateY:0,$TranslateZ:0,$SkewX:0,$SkewY:0,$Width:c,$Height:d,$Clip:{$Top:0,$Right:c,$Bottom:d,$Left:0}};e.$OriginalX=e.$Left,e.$OriginalY=e.$Top,g(b,a.$Transition,e)})}function i(a,b,c){var d=a.b-b;if(d){var e=new n(b,d);e.$Combine(r,f),e.$Shift(c),o.$Combine(e)}return o.$Expand(a.d),d}function j(a){var b=r.$GetPosition_OuterBegin(),d=0;m.$Each(a,function(a,e){a=m.$Extend({d:c},a),i(a,b,d),b=a.b,d+=a.d,e&&2!=a.t||(o.$IdleBegin=b,o.$IdleEnd=b+a.d)})}var k,o=this,p={},q=b.$Transitions,r=new n(0,0);n.call(o,0,0),o.$Revert=function(){o.$GoToPosition(-1,f)},k=[l.$Swing,l.$Linear,l.$InQuad,l.$OutQuad,l.$InOutQuad,l.$InCubic,l.$OutCubic,l.$InOutCubic,l.$InQuart,l.$OutQuart,l.$InOutQuart,l.$InQuint,l.$OutQuint,l.$InOutQuint,l.$InSine,l.$OutSine,l.$InOutSine,l.$InExpo,l.$OutExpo,l.$InOutExpo,l.$InCirc,l.$OutCirc,l.$InOutCirc,l.$InElastic,l.$OutElastic,l.$InOutElastic,l.$InBack,l.$OutBack,l.$InOutBack,l.$InBounce,l.$OutBounce,l.$InOutBounce,l.$GoBack,l.$InWave,l.$OutWave,l.$OutJump,l.$InJump];var s={$Top:"y",$Left:"x",$Bottom:"m",$Right:"t",$Rotate:"r",$RotateX:"rX",$RotateY:"rY",$ScaleX:"sX",$ScaleY:"sY",$TranslateX:"tX",$TranslateY:"tY",$TranslateZ:"tZ",$SkewX:"kX",$SkewY:"kY",$Opacity:"o",$Easing:"e",$ZIndex:"i",$Clip:"c"};m.$Each(s,function(a,b){p[a]=b}),h(e(a,1)),r.$GoToPosition(-1);var t=b.$Breaks||[],u=[].concat(t[m.$ParseInt(m.$AttributeEx(a,"b"))]||[]);u.push({b:r.$GetPosition_OuterEnd(),d:u.length?0:c}),j(u),o.$GoToPosition(-1)}}(window,document,Math,null,!0,!1),window.EnterpriseView=countlyView.extend({initialize:function(){},beforeRender:function(){if(!this.template){var a=this;return $.when($.get(countlyGlobal.path+"/enterpriseinfo/templates/info.html",function(b){a.template=Handlebars.compile(b)})).then(function(){})}},pageScript:function(){var a={drill:jQuery.i18n.map["enterpriseinfo.drill-pitch"],funnels:jQuery.i18n.map["enterpriseinfo.funnels-pitch"],retention:jQuery.i18n.map["enterpriseinfo.retention-pitch"],revenue:jQuery.i18n.map["enterpriseinfo.revenue-pitch"],"user-profiles":jQuery.i18n.map["enterpriseinfo.user-profiles-pitch"],attribution:jQuery.i18n.map["enterpriseinfo.attribution-pitch"],scalability:jQuery.i18n.map["enterpriseinfo.scalability-pitch"],support:jQuery.i18n.map["enterpriseinfo.support-pitch"],"raw-data":jQuery.i18n.map["enterpriseinfo.raw-data-pitch"]};$("#enterprise-sections").find(".app-container").on("click",function(){var b=$(this).data("section");$(".enterprise-content").hide(),$(".enterprise-content."+b).show();var c=$(".enterprise-content."+b+" .text").data("localization");$(".enterprise-content."+b+" .text").html(jQuery.i18n.map[c]),$("#enterprise-sections").find(".app-container").removeClass("active"),$(this).addClass("active"),$(".widget-header .title").text(a[b]||"")}),$("#enterprise-sections").find(".app-container").first().click()},renderCommon:function(){$(this.el).html(this.template(this.templateData)),this.pageScript()}}),app.enterpriseView=new EnterpriseView,app.route("/enterprise","enterprise",function(){this.renderWhenReady(this.enterpriseView)}),$(document).ready(function(){var a='<a class="item" id="enterprise-menu" href="#/enterprise"><div class="logo ion-ios-infinite"></div><div class="text" data-localize="enterpriseinfo.title">Enterprise</div></a>';if($("#sidebar-menu .sidebar-menu").append(a),"undefined"!=typeof countlyGlobalEE&&countlyGlobalEE.discount){var b={title:"5000+ users reached",message:"<a href='https://count.ly/enterprise-edition/' target='_blank'>To get 20% off Enterprise edition contact us with code:<br/><strong>"+countlyGlobalEE.discount+"</strong></a>",info:"Thank you for being with us",sticky:!0,closeOnClick:!1};CountlyHelpers.notify(b)}}),function(a,b,c){var d={};a.initialize=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"logs"},success:function(a){d=a}})},a.getData=function(){return d}}(window.countlyLogger=window.countlyLogger||{},jQuery),window.LoggerView=countlyView.extend({initialize:function(){this.filter=store.get("countly_loggerfilter")?store.get("countly_loggerfilter"):"logger-all"},beforeRender:function(){if(this.template)return $.when(countlyLogger.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/logger/templates/logger.html",function(b){a.template=Handlebars.compile(b)}),countlyLogger.initialize()).then(function(){})},renderCommon:function(a){var b=countlyLogger.getData();this.templateData={"page-title":jQuery.i18n.map["logger.title"]};var c=this;a||($(this.el).html(this.template(this.templateData)),$("#"+this.filter).addClass("selected").addClass("active"),$.fn.dataTableExt.afnFiltering.push(function(a,b,d){return!$(a.nTable).hasClass("logger-filter")||!("logger-event"==c.filter&&"Event"!=b[0]||"logger-session"==c.filter&&"Session"!=b[0]||"logger-metric"==c.filter&&"Metrics"!=b[0]||"logger-user"==c.filter&&"User details"!=b[0]||"logger-crash"==c.filter&&"Crash"!=b[0])}),this.dtable=$("#logger-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b,aoColumns:[{mData:function(a,b){return a.t.charAt(0).toUpperCase()+a.t.slice(1).replace(/_/g," ")},sType:"string",sTitle:jQuery.i18n.map["logger.type"]},{mData:function(a,b){return"display"==b?moment(1e3*a.ts).format("MMMM Do YYYY, hh:mm:ss"):a.ts},sType:"string",sTitle:jQuery.i18n.map["logger.timestamp"]},{mData:function(a,b){return"display"==b?moment(1e3*a.reqts).format("MMMM Do YYYY, hh:mm:ss"):a.reqts},sType:"string",sTitle:jQuery.i18n.map["logger.requestts"]},{mData:function(a,b){return a.v?a.v.replace(new RegExp(":","g"),"."):""},sType:"string",sTitle:jQuery.i18n.map["logger.version"]},{mData:function(a,b){var c="Device ID: "+a.d.id;return a.d.d&&(c+="<br/>"+a.d.d,a.d.p&&(c+=" ("+a.d.p,a.d.pv&&(c+=" "+a.d.pv.substring(1).replace(new RegExp(":","g"),".")),c+=")")),c},sType:"string",sTitle:jQuery.i18n.map["logger.device"]},{mData:function(a,b){return a.s?(a.s.name||"")+" "+(a.s.version||""):""},sType:"string",sTitle:jQuery.i18n.map["logger.sdk"]},{mData:function(a,b){var c="";return a.l.cc&&(c+='<div class="flag" style="background-image: url(images/flags/'+a.l.cc.toLowerCase()+'.png);"></div>'+a.l.cc,a.l.cty&&(c+=" ("+a.l.cty+")")),a.l.ip&&(c+="<br/>"+a.l.ip),c},sType:"string",sTitle:jQuery.i18n.map["logger.location"]},{mData:function(a,b){return"object"==typeof a.i?"<pre style='white-space:pre-wrap;'>"+JSON.stringify(a.i,null,2)+"</pre>":a.i},sType:"string",sTitle:jQuery.i18n.map["logger.info"]}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[1,"desc"]]))},refresh:function(){var a=this;$.when(countlyLogger.initialize()).then(function(){if(app.activeView!=a)return!1;var b=countlyLogger.getData();CountlyHelpers.refreshTable(a.dtable,b),app.localize()})},filterLog:function(a){this.filter=a,store.set("countly_loggerfilter",a),$("#"+this.filter).addClass("selected").addClass("active"),this.dtable.fnDraw()}}),app.loggerView=new LoggerView,app.route("/manage/logger","logger",function(){this.renderWhenReady(this.loggerView)}),app.addPageScript("/manage/logger",function(){$("#logger-selector").find(">.button").click(function(){if($(this).hasClass("selected"))return!0;$(".logger-selector").removeClass("selected").removeClass("active");var a=$(this).attr("id");app.activeView.filterLog(a)})}),$(document).ready(function(){var a='<a href="#/manage/logger" class="item"><div class="logo-icon fa fa-bars"></div><div class="text" data-localize="logger.title"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a)}),function(a,b,c){var d={};a.initialize=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"systemlogs"},success:function(a){d=a}})},a.getData=function(){return d}}(window.countlySystemLogs=window.countlySystemLogs||{},jQuery),window.SystemLogsView=countlyView.extend({initialize:function(){},beforeRender:function(){if(this.template)return $.when(countlySystemLogs.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/systemlogs/templates/logs.html",function(b){a.template=Handlebars.compile(b)}),countlySystemLogs.initialize()).then(function(){})},renderCommon:function(a){var b=countlySystemLogs.getData();this.templateData={"page-title":jQuery.i18n.map["systemlogs.title"]};a||($(this.el).html(this.template(this.templateData)),this.dtable=$("#systemlogs-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b,aoColumns:[{mData:function(a,b){return"display"==b?moment(1e3*a.ts).format("MMMM Do YYYY, hh:mm:ss"):a.ts},sType:"string",sTitle:jQuery.i18n.map["systemlogs.timestamp"]},{mData:function(a,b){return a.u},sType:"string",sTitle:jQuery.i18n.map["systemlogs.user"]},{mData:function(a,b){return a.a},sType:"string",sTitle:jQuery.i18n.map["systemlogs.action"]},{mData:function(a,b){return a.ip},sType:"string",sTitle:jQuery.i18n.map["systemlogs.ip-address"]},{mData:function(a,b){return"object"==typeof a.i?"<pre style='white-space:pre-wrap;'>"+JSON.stringify(a.i,null,2)+"</pre>":a.i},sType:"string",sTitle:jQuery.i18n.map["systemlogs.info"]}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[0,"desc"]]))},refresh:function(){var a=this;$.when(countlySystemLogs.initialize()).then(function(){if(app.activeView!=a)return!1;var b=countlySystemLogs.getData();CountlyHelpers.refreshTable(a.dtable,b),app.localize()})}}),app.systemLogsView=new SystemLogsView,countlyGlobal.member.global_admin&&app.route("/manage/systemlogs","systemlogs",function(){this.renderWhenReady(this.systemLogsView)}),$(document).ready(function(){if(countlyGlobal.member.global_admin){var a='<a href="#/manage/systemlogs" class="item"><div class="logo-icon fa fa-user-secret"></div><div class="text" data-localize="systemlogs.title"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a)}}),function(a,b,c){var d={};a.initialize=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/errorlogs",data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID},success:function(a){d=a}})},a.getData=function(){return d},a.del=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/errorlogs",data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,log:a}})}}(window.countlyErrorLogs=window.countlyErrorLogs||{},jQuery),window.ErrorLogsView=countlyView.extend({initialize:function(){},beforeRender:function(){if(this.template)return $.when(countlyErrorLogs.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/errorlogs/templates/logs.html",function(b){a.template=Handlebars.compile(b)}),countlyErrorLogs.initialize()).then(function(){})},renderCommon:function(a){var b=countlyErrorLogs.getData(),c=countlyGlobal.path+"/o/errorlogs?api_key="+countlyGlobal.member.api_key+"&app_id="+countlyCommon.ACTIVE_APP_ID+"&download=true&log=";this.templateData={"page-title":jQuery.i18n.map["errorlogs.title"],download:c,logs:b};var d=this;a||($(this.el).html(this.template(this.templateData)),$("#tabs").tabs(),$(".btn-clear-log").on("click",function(){var a=$(this).data("id");CountlyHelpers.confirm(jQuery.i18n.map["errorlogs.confirm-delete"],"red",function(b){return!b||void $.when(countlyErrorLogs.del(a)).then(function(a){"Success"==a.result?$.when(countlyErrorLogs.initialize()).then(function(){d.renderCommon(),app.localize()}):CountlyHelpers.alert(a.result,"red")})})}))},refresh:function(){}}),app.errorLogsView=new ErrorLogsView,countlyGlobal.member.global_admin&&app.route("/manage/errorlogs","errorlogs",function(){this.renderWhenReady(this.errorLogsView)}),$(document).ready(function(){if(countlyGlobal.member.global_admin){var a='<a href="#/manage/errorlogs" class="item"><div class="logo-icon fa fa-exclamation-triangle"></div><div class="text" data-localize="errorlogs.title"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a)}}),function(a,b,c){function d(a,b){return Math.floor(Math.random()*(b-a+1))+a}function e(a){return a.charAt(0).toUpperCase()+a.slice(1)}function f(){var a={"Facebook Login":Math.random()>.5,"Twitter Login":Math.random()>.5};return a["Twitter Login"]&&(a["Twitter Login name"]=chance.twitter()),Math.random()>.5&&(a["Has Apple Watch OS"]=Math.random()>.5),a}function g(a){for(var b="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",c="",e=0;e<a;e++)c+=b[d(0,b.length)];return c}function h(a){return p[a][Math.floor(Math.random()*p[a].length)]}function i(b){this.getId=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},this.getProp=h;var c=this;this.stats={u:0,s:0,x:0,d:0,e:0,r:0,b:0,c:0,p:0},this.id=this.getId(),this.isRegistered=!1,this.iap=countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].iap_event||"",""!=this.iap&&(q[this.iap]=r.Buy),this.hasSession=!1,s.length>0&&Math.random()>=.5?this.ip=s.pop():this.ip=chance.ip(),this.userdetails={name:chance.name(),username:chance.twitter().substring(1),email:chance.email(),organization:e(chance.word()),phone:chance.phone(),gender:chance.gender().charAt(0),byear:chance.birthday().getFullYear(),custom:f()},this.metrics={},this.startTs=u,this.endTs=v,this.events=[],this.ts=d(this.startTs,this.endTs);for(var i in p)"_os"==i||"_os_web"==i?"_os_web"==i&&"web"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type?(this.platform=this.getProp(i),this.metrics._os=this.platform):(this.platform=this.getProp(i),this.metrics[i]=this.platform):"_store"!=i&&"_source"!=i&&(this.metrics[i]=this.getProp(i));"web"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type?this.metrics._store=this.getProp("_source"):"Android"==this.platform&&(this.metrics._store=this.getProp("_store")),this.getCrash=function(){var a={};a._os=this.getProp("_os"),a._os_version=this.getProp("_os_version"),a._device=this.getProp("_device"),a._manufacture=this.getProp("_manufacture"),a._resolution=this.getProp("_resolution"),a._app_version=this.getProp("_app_version"),a._cpu=this.getProp("_cpu"),a._opengl=this.getProp("_opengl"),a._ram_total=1024*d(1,4),a._ram_current=d(1,a._ram_total),a._disk_total=1024*d(1,20),a._disk_current=d(1,a._disk_total),a._bat_total=100,a._bat_current=d(1,a._bat_total),a._orientation=Math.random()>.5?"landscape":"portrait",a._root=Math.random()>.5,a._online=Math.random()>.5,a._signal=Math.random()>.5,a._muted=Math.random()>.5,a._background=Math.random()>.5,a._error=this.getError(),a._logs=this.getLog(),a._nonfatal=Math.random()>.5,a._run=d(1,1800);var b=["facebook","gideros","admob","chartboost","googleplay"];a._custom={};for(var c=0;c<b.length;c++)Math.random()>.5&&(a._custom[b[c]]=d(1,2)+"."+d(0,9));return a},this.getError=function(){for(var a=["java.lang.RuntimeException","java.lang.NullPointerException","java.lang.NoSuchMethodError","java.lang.NoClassDefFoundError","java.lang.ExceptionInInitializerError","java.lang.IllegalStateException"],b=a[Math.floor(Math.random()*a.length)]+": com.domain.app.Exception<init>\n",c=d(5,9),e=0;e<c;e++)b+="at com.domain.app.<init>(Activity.java:"+32*e+")\n";return b},this.getLog=function(){for(var a=["clicked button 1","clicked button 2","clicked button 3","clicked button 4","clicked button 5","rotated phone","clicked back","entered screen","left screen","touched screen","taped screen","long touched screen","swipe left detected","swipe right detected","swipe up detected","swipe down detected","gesture detected","shake detected"],b=d(5,10),c=[],e=0;e<b;e++)c.push(a[d(0,a.length-1)]);return c.join("\n")},this.getEvent=function(a){this.stats.e++,a||(a=this.previousEventId?q[this.previousEventId][Math.floor(Math.random()*q[this.previousEventId].length)]:"Login"),a in q&&(this.previousEventId=a);var b={key:a,count:1,timestamp:this.ts,hour:d(0,23),dow:d(0,6)};if(this.ts+=1e3,a==this.iap){this.stats.b++,b.sum=d(100,500)/100;var c;b.segmentation={};for(var e in r.Buy)c=r.Buy[e],b.segmentation[e]=c[Math.floor(Math.random()*c.length)]}else if(r[a]){var c;b.segmentation={};for(var e in r[a])c=r[a][e],b.segmentation[e]=c[Math.floor(Math.random()*c.length)]}return"[CLY]_view"==a?b.dur=d(0,100):b.dur=d(0,10),[b]},this.getEvents=function(a){for(var b=[],c=0;c<a;c++)b.push(this.getEvent()[0]);return b},this.getPushEvents=function(){var a=this.getPushEvent("[CLY]_push_sent");return Math.random()>=.5&&(a=a.concat(this.getPushEvent("[CLY]_push_open")),Math.random()>=.8&&(a=a.concat(this.getPushEvent("[CLY]_push_action")))),a},this.getPushEvent=function(a){this.stats.e++;var b={key:a,count:1,timestamp:this.ts,hour:d(0,23),dow:d(0,6),test:1};if(this.ts+=1e3,r[a]){var c;b.segmentation={};for(var e in r[a])c=r[a][e],b.segmentation[e]=c[Math.floor(Math.random()*c.length)]}return[b]},this.startSession=function(){this.ts=this.ts+86400+100,this.stats.s++;var a={};if(this.isRegistered){var b=this.getEvent("Login").concat(this.getEvent("[CLY]_view")).concat(this.getEvents(4));a={timestamp:this.ts,begin_session:1,events:b}}else{this.isRegistered=!0,this.stats.u++;var b=this.getEvent("Login").concat(this.getEvent("[CLY]_view")).concat(this.getEvents(4));a={timestamp:this.ts,begin_session:1,metrics:this.metrics,user_details:this.userdetails,events:b},Math.random()>.5&&(this.hasPush=!0,this.stats.p++,a.token_session=1,a.test_mode=0,a.events=a.events.concat(this.getPushEvents()),a[this.platform.toLowerCase()+"_token"]=g(8))}""!=this.iap&&Math.random()>.5&&(a.events=a.events.concat(this.getEvent(this.iap))),Math.random()>.5&&(this.stats.c++,a.crash=this.getCrash()),this.hasSession=!0,this.request(a),this.timer=setTimeout(function(){c.extendSession()},w)},this.extendSession=function(){if(this.hasSession){var a={};this.ts=this.ts+30,this.stats.x++,this.stats.d+=30;var b=this.getEvent("[CLY]_view").concat(this.getEvents(2));a={timestamp:this.ts,session_duration:30,events:b},Math.random()>.8?this.timer=setTimeout(function(){c.extendSession()},w):(Math.random()>.5&&(this.stats.c++,a.crash=this.getCrash()),this.timer=setTimeout(function(){c.endSession()},w)),this.request(a)}},this.endSession=function(){if(this.timer&&(clearTimeout(this.timer),this.timer=null),this.hasSession){this.hasSession=!1;var a=this.getEvents(2).concat(this.getEvent("Logout"));this.request({timestamp:this.ts,end_session:1,events:a})}},this.request=function(b){this.stats.r++,b.device_id=this.id,b.ip_address=this.ip,b.hour=d(0,23),b.dow=d(0,6),b.stats=JSON.parse(JSON.stringify(this.stats)),t.push(b),this.stats={u:0,s:0,x:0,d:0,e:0,r:0,b:0,c:0,p:0},a.sync()}}function j(a){for(var c in a)D[c]+=a[c],b("#populate-stats-"+c).text(D[c])}function k(a,c,d,e,f){b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/campaign/create",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify({_id:a+countlyCommon.ACTIVE_APP_ID,name:c,link:"http://count.ly",cost:d,costtype:e,fingerprint:!1,links:{},postbacks:[],app_id:countlyCommon.ACTIVE_APP_ID})},success:f,error:f})}function l(a){var c=chance.ip();s.length&&Math.random()>.5?c=s[Math.floor(Math.random()*s.length)]:s.push(c),b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/campaign/click/"+a+countlyCommon.ACTIVE_APP_ID,data:{ip_address:c,
test:!0,timestamp:d(u,v)}})}function m(a){if("undefined"==typeof countlyAttribution)return void a();var b=["social","ads","landing"];k("social","Social Campaign","0.5","click",function(){k("ads","Ads Campaign","1","install",function(){k("landing","Landing page","30","campaign",function(){for(var c=0;c<100;c++)setTimeout(function(){l(b[d(0,b.length-1)])},1);setTimeout(a,3e3)})})})}function n(a,c,g,i){for(var j=[],k=0;k<c;k++)for(var l=0;l<g.length;l++){var m={};for(var k in p)"_os"==k||"_os_web"==k?"_os_web"==k&&"web"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type?m._os=h(k):m[k]=h(k):"_store"!=k&&"_source"!=k&&(m[k]=h(k));"web"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type?m._store=h("_source"):"Android"==this.platform&&(m._store=h("_store"));var n={name:chance.name(),username:chance.twitter().substring(1),email:chance.email(),organization:e(chance.word()),phone:chance.phone(),gender:chance.gender().charAt(0),byear:chance.birthday().getFullYear(),custom:f()};j.push({ip_address:chance.ip(),device_id:k+""+g[l],begin_session:1,metrics:m,user_details:n,timestamp:a,hour:d(0,23),dow:d(0,6)}),D.s++,D.u++}D.r++,b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/bulk",data:{app_key:countlyCommon.ACTIVE_APP_KEY,requests:JSON.stringify(j)},success:i,error:i})}function o(a){if("undefined"==typeof countlyRetention)return void a();var b=v-777600,c=[b],d=10;n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,function(){b+=86400,c.push(b),n(b,d--,c,a)})})})})})})})}var p={_os:["Android","iOS","Windows Phone"],_os_web:["Android","iOS","Windows Phone","Windows","OSX"],_os_version:["2.2","2.3","3.1","3.2","4.0","4.1","4.2","4.3","4.4","5.0","5.1","6.0","6.1","7.0","7.1","8.0","8.1"],_resolution:["320x480","768x1024","640x960","1536x2048","320x568","640x1136","480x800","240x320","540x960","480x854","240x400","360x640","800x1280","600x1024","600x800","768x1366","720x1280","1080x1920"],_device:["One Touch Idol X","Kindle Fire HDX","Fire Phone","iPhone 5","iPhone Mini","iPhone 4S","iPhone 5C","iPad 4","iPad Air","iPhone 6","Nexus 7","Nexus 10","Nexus 4","Nexus 5","Windows Phone","One S","Optimus L5","Lumia 920","Galaxy Note","Xperia Z"],_manufacture:["Samsung","Sony Ericsson","LG","Google","HTC","Nokia","Apple","Huaiwei","Lenovo","Acer"],_carrier:["Telus","Rogers Wireless","T-Mobile","Bell Canada","\tAT&T","Verizon","Vodafone","Cricket Communications","O2","Tele2","Turkcell","Orange","Sprint","Metro PCS"],_app_version:["1.0","1.1","1.2","1.3","1.4","1.5","1.6","1.7","1.8","1.9","2.0","2.1","2.2","2.3","2.4","2.5","2.6","2.7","2.8","2.9","3.0","3.1","3.2"],_cpu:["armv6","armv7","x86"],_opengl:["opengl_es1","opengl_es2"],_density:["120dpi","160dpi","240dpi","320dpi","480dpi","640dpi"],_locale:["en_CA","fr_FR","de_DE","it_IT","ja_JP","ko_KR","en_US"],_browser:["Opera","Chrome","Internet Explorer","Safari","Firefox"],_store:["com.android.vending","com.google.android.feedback","com.google.vending","com.slideme.sam.manager","com.amazon.venezia","com.sec.android.app.samsungapps","com.nokia.payment.iapenabler","com.qihoo.appstore","cn.goapk.market","com.wandoujia.phoenix2","com.hiapk.marketpho","com.hiapk.marketpad","com.dragon.android.pandaspace","me.onemobile.android","com.aspire.mm","com.xiaomi.market","com.miui.supermarket","com.baidu.appsearch","com.tencent.android.qqdownloader","com.android.browser","com.bbk.appstore","cm.aptoide.pt","com.nduoa.nmarket","com.rim.marketintent","com.lenovo.leos.appstore","com.lenovo.leos.appstore.pad","com.keenhi.mid.kitservice","com.yingyonghui.market","com.moto.mobile.appstore","com.aliyun.wireless.vos.appstore","com.appslib.vending","com.mappn.gfan","com.diguayouxi","um.market.android","com.huawei.appmarket","com.oppo.market","com.taobao.appcenter"],_source:["https://www.google.lv","https://www.google.co.in/","https://www.google.ru/","http://stackoverflow.com/questions","http://stackoverflow.com/unanswered","http://stackoverflow.com/tags","http://r.search.yahoo.com/"]},q={Login:["Lost","Won"],Logout:[],Lost:["Won","Achievement","Lost"],Won:["Lost","Achievement"],Achievement:["Sound","Shared"],Sound:["Lost","Won"],Shared:["Lost","Won"]},r={Login:{referer:["twitter","notification","unknown"]},Buy:{screen:["End Level","Main screen","Before End"]},Lost:{level:[1,2,3,4,5,6,7,8,9,10,11],mode:["arcade","physics","story"],difficulty:["easy","medium","hard"]},Won:{level:[1,2,3,4,5,6,7,8,9,10,11],mode:["arcade","physics","story"],difficulty:["easy","medium","hard"]},Achievement:{name:["Runner","Jumper","Shooter","Berserker","Tester"]},Sound:{state:["on","off"]}};r["[CLY]_push_open"]={i:"123456789012345678901234"},r["[CLY]_push_action"]={i:"123456789012345678901234"},r["[CLY]_push_sent"]={i:"123456789012345678901234"},r["[CLY]_view"]={name:["Settings Page","Purchase Page","Credit Card Entry","Profile page","Start page","Message page"],visit:[1],start:[0,1],exit:[0,1],bounce:[0,1]};var s=[],t=[],u=1356998400,v=(new Date).getTime()/1e3,w=1e3,x=50,y=!1,z=null,A=[],B=1e3,C=0,D={u:0,s:0,x:0,d:0,e:0,r:0,b:0,c:0,p:0};a.setStartTime=function(a){u=a},a.getStartTime=function(a){return u},a.setEndTime=function(a){v=a},a.getEndTime=function(a){return v},a.getUserAmount=function(a){return B},a.generateUI=function(a){for(var c in D)b("#populate-stats-"+c).text(D[c])},a.generateUsers=function(b){function c(){var a=new i;A.push(a),a.timer=setTimeout(function(){a.startSession()},Math.random()*w)}function d(a){a&&!a.hasSession&&(a.timer=setTimeout(function(){a.startSession()},Math.random()*w))}function e(){for(var c=0;c<b;c++)d(A[c]);A.length>0&&y?setTimeout(e,w):a.sync(!0)}z=null,B=b,t=[],D={u:0,s:0,x:0,d:0,e:0,r:0,b:0,c:0,p:0},x=Math.max(b/50,10);var f=Math.round(C/10)+1;w=10*x*f*f,y=!0,o(function(){m(function(){for(var a=0;a<b;a++)c();setTimeout(e,w)})})},a.stopGenerating=function(b){y=!1,z=b;for(var c,d=0;d<A.length;d++)c=A[d],c&&c.endSession();A=[],!a.bulking&&z&&a.ensureJobs()},a.isGenerating=function(){return y},a.sync=function(c){if(y&&(c||t.length>x)&&!a.bulking){C++;var d=Math.round(C/10)+1;w=10*x*d*d,b("#populate-stats-br").text(C),a.bulking=!0;var e=t.splice(0,x),f={u:0,s:0,x:0,d:0,e:0,r:0,b:0,c:0,p:0};for(var g in e)if(e[g].stats){for(var h in e[g].stats)f[h]+=e[g].stats[h];delete e[g].stats}b.ajax({type:"POST",url:countlyCommon.API_URL+"/i/bulk",data:{app_key:countlyCommon.ACTIVE_APP_KEY,requests:JSON.stringify(e)},success:function(c){C--,b("#populate-stats-br").text(C),j(f),a.bulking=!1,a.sync(),!y&&z&&a.ensureJobs()},error:function(){C--,b("#populate-stats-br").text(C),a.bulking=!1,a.sync(),!y&&z&&a.ensureJobs()}})}};var E=!1;a.ensureJobs=function(){return"undefined"==typeof countlyFlow?void(z&&z(!0)):void(E||(E=!0,b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/flows/lastJob",data:{app_key:countlyCommon.ACTIVE_APP_KEY},success:function(a){function c(){b.ajax({type:"GET",url:countlyCommon.API_URL+"/i/flows/lastJob",data:{job:a.job,app_key:countlyCommon.ACTIVE_APP_KEY},success:function(a){a&&a.done?(E=!1,z&&z(!0)):(z&&z(!1),setTimeout(c,3e3))},error:function(a,b,c){E=!1,z&&z(c)}})}a&&a.job?c():a&&a.done?z&&z(!0):(E=!1,z&&z(a))},error:function(a,b,c){E=!1,a.responseText&&a.responseText.indexOf("Invalid path")!==-1?z&&z(!0):z&&z(c)}})))}}(window.countlyPopulator=window.countlyPopulator||{},jQuery),function(){function a(b){if(!(this instanceof a))return new a(b);if("function"==typeof b)return this.random=b,this;var c;arguments.length&&(this.seed=0);for(var d=0;d<arguments.length;d++){if(c=0,"string"==typeof arguments[d])for(var e=0;e<arguments[d].length;e++)c+=(arguments[d].length-e)*arguments[d].charCodeAt(e);else c=arguments[d];this.seed+=(arguments.length-d)*c}return this.mt=this.mersenne_twister(this.seed),this.random=function(){return this.mt.random(this.seed)},this}function b(a,b){if(a||(a={}),b)for(var c in b)"undefined"==typeof a[c]&&(a[c]=b[c]);return a}function c(a,b){if(a)throw new RangeError(b)}function d(a){return function(){return this.natural(a)}}function e(a,b){for(var c,d=r(a),e=0,f=d.length;e<f;e++)c=d[e],b[c]=a[c]||b[c]}function f(a,b){for(var c=0,d=a.length;c<d;c++)b[c]=a[c]}function g(a,b){var c=Array.isArray(a),d=b||(c?new Array(a.length):{});return c?f(a,d):e(a,d),d}var h=9007199254740992,i=-h,j="0123456789",k="abcdefghijklmnopqrstuvwxyz",l=k.toUpperCase(),m=j+"abcdef",n=Array.prototype.slice;a.prototype.VERSION="0.7.2";var o=function(){throw new Error("No Base64 encoder available.")};!function(){"function"==typeof btoa?o=btoa:"function"==typeof Buffer&&(o=function(a){return new Buffer(a).toString("base64")})}(),a.prototype.bool=function(a){return a=b(a,{likelihood:50}),c(a.likelihood<0||a.likelihood>100,"Chance: Likelihood accepts values from 0 to 100."),100*this.random()<a.likelihood},a.prototype.character=function(a){a=b(a);var d,e,f="!@#$%^&*()[]";return c(a.alpha&&a.symbols,"Chance: Cannot specify both alpha and symbols."),d="lower"===a.casing?k:"upper"===a.casing?l:k+l,e=a.pool?a.pool:a.alpha?d:a.symbols?f:d+j+f,e.charAt(this.natural({max:e.length-1}))},a.prototype.floating=function(a){var d;a=b(a,{fixed:4});var e=Math.pow(10,a.fixed);c(a.fixed&&a.precision,"Chance: Cannot specify both fixed and precision.");var f=h/e,g=-f;c(a.min&&a.fixed&&a.min<g,"Chance: Min specified is out of range with fixed. Min should be, at least, "+g),c(a.max&&a.fixed&&a.max>f,"Chance: Max specified is out of range with fixed. Max should be, at most, "+f),a=b(a,{min:g,max:f}),d=this.integer({min:a.min*e,max:a.max*e});var i=(d/e).toFixed(a.fixed);return parseFloat(i)},a.prototype.integer=function(a){return a=b(a,{min:i,max:h}),c(a.min>a.max,"Chance: Min cannot be greater than Max."),Math.floor(this.random()*(a.max-a.min+1)+a.min)},a.prototype.natural=function(a){return a=b(a,{min:0,max:h}),this.integer(a)},a.prototype.string=function(a){a=b(a);var c=a.length||this.natural({min:5,max:20}),d=a.pool,e=this.n(this.character,c,{pool:d});return e.join("")},a.prototype.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substr(1)},a.prototype.mixin=function(b){for(var c in b)a.prototype[c]=b[c];return this},a.prototype.unique=function(a,c,d){d=b(d,{comparator:function(a,b){return a.indexOf(b)!==-1}});for(var e,f=[],g=0,h=50*c,i=n.call(arguments,2);f.length<c;)if(e=a.apply(this,i),d.comparator(f,e)||(f.push(e),g=0),++g>h)throw new RangeError("Chance: num is likely too large for sample set");return f},a.prototype.n=function(a,b){"undefined"==typeof b&&(b=1);var c=b,d=[],e=n.call(arguments,2);for(c=Math.max(0,c),null;c--;null)d.push(a.apply(this,e));return d},a.prototype.pad=function(a,b,c){return c=c||"0",a+="",a.length>=b?a:new Array(b-a.length+1).join(c)+a},a.prototype.pick=function(a,b){if(0===a.length)throw new RangeError("Chance: Cannot pick() from an empty array");return b&&1!==b?this.shuffle(a).slice(0,b):a[this.natural({max:a.length-1})]},a.prototype.shuffle=function(a){for(var b=a.slice(0),c=[],d=0,e=Number(b.length),f=0;f<e;f++)d=this.natural({max:b.length-1}),c[f]=b[d],b.splice(d,1);return c},a.prototype.weighted=function(a,b){if(a.length!==b.length)throw new RangeError("Chance: length of array and weights must match");for(var c=b.length-1;c>=0;--c)b[c]<=0&&(a.splice(c,1),b.splice(c,1));if(b.some(function(a){return a<1})){var d=b.reduce(function(a,b){return b<a?b:a},b[0]),e=1/d;b=b.map(function(a){return a*e})}var f,g=b.reduce(function(a,b){return a+b},0),h=this.natural({min:1,max:g}),i=0;return b.some(function(b,c){return h<=i+b?(f=a[c],!0):(i+=b,!1)}),f},a.prototype.paragraph=function(a){a=b(a);var c=a.sentences||this.natural({min:3,max:7}),d=this.n(this.sentence,c);return d.join(" ")},a.prototype.sentence=function(a){a=b(a);var c,d=a.words||this.natural({min:12,max:18}),e=this.n(this.word,d);return c=e.join(" "),c=this.capitalize(c)+"."},a.prototype.syllable=function(a){a=b(a);for(var c,d=a.length||this.natural({min:2,max:3}),e="bcdfghjklmnprstvwz",f="aeiou",g=e+f,h="",i=0;i<d;i++)c=0===i?this.character({pool:g}):e.indexOf(c)===-1?this.character({pool:e}):this.character({pool:f}),h+=c;return h},a.prototype.word=function(a){a=b(a),c(a.syllables&&a.length,"Chance: Cannot specify both syllables AND length.");var d=a.syllables||this.natural({min:1,max:3}),e="";if(a.length){do e+=this.syllable();while(e.length<a.length);e=e.substring(0,a.length)}else for(var f=0;f<d;f++)e+=this.syllable();return e},a.prototype.age=function(a){a=b(a);var c;switch(a.type){case"child":c={min:1,max:12};break;case"teen":c={min:13,max:19};break;case"adult":c={min:18,max:65};break;case"senior":c={min:65,max:100};break;case"all":c={min:1,max:100};break;default:c={min:18,max:65}}return this.natural(c)},a.prototype.birthday=function(a){return a=b(a,{year:(new Date).getFullYear()-this.age(a)}),this.date(a)},a.prototype.cpf=function(){var a=this.n(this.natural,9,{max:9}),b=2*a[8]+3*a[7]+4*a[6]+5*a[5]+6*a[4]+7*a[3]+8*a[2]+9*a[1]+10*a[0];b=11-b%11,b>=10&&(b=0);var c=2*b+3*a[8]+4*a[7]+5*a[6]+6*a[5]+7*a[4]+8*a[3]+9*a[2]+10*a[1]+11*a[0];return c=11-c%11,c>=10&&(c=0),""+a[0]+a[1]+a[2]+"."+a[3]+a[4]+a[5]+"."+a[6]+a[7]+a[8]+"-"+b+c},a.prototype.first=function(a){return a=b(a,{gender:this.gender()}),this.pick(this.get("firstNames")[a.gender.toLowerCase()])},a.prototype.gender=function(){return this.pick(["Male","Female"])},a.prototype.last=function(){return this.pick(this.get("lastNames"))},a.prototype.name=function(a){a=b(a);var c,d=this.first(a),e=this.last();return c=a.middle?d+" "+this.first(a)+" "+e:a.middle_initial?d+" "+this.character({alpha:!0,casing:"upper"})+". "+e:d+" "+e,a.prefix&&(c=this.prefix(a)+" "+c),a.suffix&&(c=c+" "+this.suffix(a)),c},a.prototype.name_prefixes=function(a){a=a||"all",a=a.toLowerCase();var b=[{name:"Doctor",abbreviation:"Dr."}];return"male"!==a&&"all"!==a||b.push({name:"Mister",abbreviation:"Mr."}),"female"!==a&&"all"!==a||(b.push({name:"Miss",abbreviation:"Miss"}),b.push({name:"Misses",abbreviation:"Mrs."})),b},a.prototype.prefix=function(a){return this.name_prefix(a)},a.prototype.name_prefix=function(a){return a=b(a,{gender:"all"}),a.full?this.pick(this.name_prefixes(a.gender)).name:this.pick(this.name_prefixes(a.gender)).abbreviation},a.prototype.ssn=function(a){a=b(a,{ssnFour:!1,dashes:!0});var c,d="1234567890",e=a.dashes?"-":"";return c=a.ssnFour?this.string({pool:d,length:4}):this.string({pool:d,length:3})+e+this.string({pool:d,length:2})+e+this.string({pool:d,length:4})},a.prototype.name_suffixes=function(){var a=[{name:"Doctor of Osteopathic Medicine",abbreviation:"D.O."},{name:"Doctor of Philosophy",abbreviation:"Ph.D."},{name:"Esquire",abbreviation:"Esq."},{name:"Junior",abbreviation:"Jr."},{name:"Juris Doctor",abbreviation:"J.D."},{name:"Master of Arts",abbreviation:"M.A."},{name:"Master of Business Administration",abbreviation:"M.B.A."},{name:"Master of Science",abbreviation:"M.S."},{name:"Medical Doctor",abbreviation:"M.D."},{name:"Senior",abbreviation:"Sr."},{name:"The Third",abbreviation:"III"},{name:"The Fourth",abbreviation:"IV"}];return a},a.prototype.suffix=function(a){return this.name_suffix(a)},a.prototype.name_suffix=function(a){return a=b(a),a.full?this.pick(this.name_suffixes()).name:this.pick(this.name_suffixes()).abbreviation},a.prototype.android_id=function(){return"APA91"+this.string({pool:"0123456789abcefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-_",length:178})},a.prototype.apple_token=function(){return this.string({pool:"abcdef1234567890",length:64})},a.prototype.wp8_anid2=function(){return o(this.hash({length:32}))},a.prototype.wp7_anid=function(){return"A="+this.guid().replace(/-/g,"").toUpperCase()+"&E="+this.hash({length:3})+"&W="+this.integer({min:0,max:9})},a.prototype.bb_pin=function(){return this.hash({length:8})},a.prototype.color=function(a){function c(a,b){return[a,a,a].join(b||"")}a=b(a,{format:this.pick(["hex","shorthex","rgb","0x"]),grayscale:!1,casing:"lower"});var d,e=a.grayscale;if("hex"===a.format)d="#"+(e?c(this.hash({length:2})):this.hash({length:6}));else if("shorthex"===a.format)d="#"+(e?c(this.hash({length:1})):this.hash({length:3}));else if("rgb"===a.format)d=e?"rgb("+c(this.natural({max:255}),",")+")":"rgb("+this.natural({max:255})+","+this.natural({max:255})+","+this.natural({max:255})+")";else{if("0x"!==a.format)throw new Error('Invalid format provided. Please provide one of "hex", "shorthex", "rgb" or "0x".');d="0x"+(e?c(this.hash({length:2})):this.hash({length:6}))}return"upper"===a.casing&&(d=d.toUpperCase()),d},a.prototype.domain=function(a){return a=b(a),this.word()+"."+(a.tld||this.tld())},a.prototype.email=function(a){return a=b(a),this.word({length:a.length})+"@"+(a.domain||this.domain())},a.prototype.fbid=function(){return parseInt("10000"+this.natural({max:1e11}),10)},a.prototype.google_analytics=function(){var a=this.pad(this.natural({max:999999}),6),b=this.pad(this.natural({max:99}),2);return"UA-"+a+"-"+b},a.prototype.hashtag=function(){return"#"+this.word()},a.prototype.ip=function(){return this.natural({max:255})+"."+this.natural({max:255})+"."+this.natural({max:255})+"."+this.natural({max:255})},a.prototype.ipv6=function(){var a=this.n(this.hash,8,{length:4});return a.join(":")},a.prototype.klout=function(){return this.natural({min:1,max:99})},a.prototype.tlds=function(){return["com","org","edu","gov","co.uk","net","io"]},a.prototype.tld=function(){return this.pick(this.tlds())},a.prototype.twitter=function(){return"@"+this.word()},a.prototype.url=function(a){a=b(a,{protocol:"http",domain:this.domain(a),domain_prefix:"",path:this.word(),extensions:[]});var c=a.extensions.length>0?"."+this.pick(a.extensions):"",d=a.domain_prefix?a.domain_prefix+"."+a.domain:a.domain;return a.protocol+"://"+d+"/"+a.path+c},a.prototype.address=function(a){return a=b(a),this.natural({min:5,max:2e3})+" "+this.street(a)},a.prototype.altitude=function(a){return a=b(a,{fixed:5,max:8848}),this.floating({min:0,max:a.max,fixed:a.fixed})},a.prototype.areacode=function(a){a=b(a,{parens:!0});var c=this.natural({min:2,max:9}).toString()+this.natural({min:0,max:8}).toString()+this.natural({min:0,max:9}).toString();return a.parens?"("+c+")":c},a.prototype.city=function(){return this.capitalize(this.word({syllables:3}))},a.prototype.coordinates=function(a){return a=b(a),this.latitude(a)+", "+this.longitude(a)},a.prototype.countries=function(){return this.get("countries")},a.prototype.country=function(a){a=b(a);var c=this.pick(this.countries());return a.full?c.name:c.abbreviation},a.prototype.depth=function(a){return a=b(a,{fixed:5,min:-2550}),this.floating({min:a.min,max:0,fixed:a.fixed})},a.prototype.geohash=function(a){return a=b(a,{length:7}),this.string({length:a.length,pool:"0123456789bcdefghjkmnpqrstuvwxyz"})},a.prototype.geojson=function(a){return a=b(a),this.latitude(a)+", "+this.longitude(a)+", "+this.altitude(a)},a.prototype.latitude=function(a){return a=b(a,{fixed:5,min:-90,max:90}),this.floating({min:a.min,max:a.max,fixed:a.fixed})},a.prototype.longitude=function(a){return a=b(a,{fixed:5,min:-180,max:180}),this.floating({min:a.min,max:a.max,fixed:a.fixed})},a.prototype.phone=function(a){var c,d=this,e=function(a){var b=[];return a.sections.forEach(function(a){b.push(d.string({pool:"0123456789",length:a}))}),a.area+b.join(" ")};a=b(a,{formatted:!0,country:"us",mobile:!1}),a.formatted||(a.parens=!1);var f;switch(a.country){case"fr":a.mobile?(c=this.pick(["06","07"])+d.string({pool:"0123456789",length:8}),f=a.formatted?c.match(/../g).join(" "):c):(c=this.pick(["01"+this.pick(["30","34","39","40","41","42","43","44","45","46","47","48","49","53","55","56","58","60","64","69","70","72","73","74","75","76","77","78","79","80","81","82","83"])+d.string({pool:"0123456789",length:6}),"02"+this.pick(["14","18","22","23","28","29","30","31","32","33","34","35","36","37","38","40","41","43","44","45","46","47","48","49","50","51","52","53","54","56","57","61","62","69","72","76","77","78","85","90","96","97","98","99"])+d.string({pool:"0123456789",length:6}),"03"+this.pick(["10","20","21","22","23","24","25","26","27","28","29","39","44","45","51","52","54","55","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","80","81","82","83","84","85","86","87","88","89","90"])+d.string({pool:"0123456789",length:6}),"04"+this.pick(["11","13","15","20","22","26","27","30","32","34","37","42","43","44","50","56","57","63","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","88","89","90","91","92","93","94","95","97","98"])+d.string({pool:"0123456789",length:6}),"05"+this.pick(["08","16","17","19","24","31","32","33","34","35","40","45","46","47","49","53","55","56","57","58","59","61","62","63","64","65","67","79","81","82","86","87","90","94"])+d.string({pool:"0123456789",length:6}),"09"+d.string({pool:"0123456789",length:8})]),f=a.formatted?c.match(/../g).join(" "):c);break;case"uk":a.mobile?(c=this.pick([{area:"07"+this.pick(["4","5","7","8","9"]),sections:[2,6]},{area:"07624 ",sections:[6]}]),f=a.formatted?e(c):e(c).replace(" ","")):(c=this.pick([{area:"01"+this.character({pool:"234569"})+"1 ",sections:[3,4]},{area:"020 "+this.character({pool:"378"}),sections:[3,4]},{area:"023 "+this.character({pool:"89"}),sections:[3,4]},{area:"024 7",sections:[3,4]},{area:"028 "+this.pick(["25","28","37","71","82","90","92","95"]),sections:[2,4]},{area:"012"+this.pick(["04","08","54","76","97","98"])+" ",sections:[5]},{area:"013"+this.pick(["63","64","84","86"])+" ",sections:[5]},{area:"014"+this.pick(["04","20","60","61","80","88"])+" ",sections:[5]},{area:"015"+this.pick(["24","27","62","66"])+" ",sections:[5]},{area:"016"+this.pick(["06","29","35","47","59","95"])+" ",sections:[5]},{area:"017"+this.pick(["26","44","50","68"])+" ",sections:[5]},{area:"018"+this.pick(["27","37","84","97"])+" ",sections:[5]},{area:"019"+this.pick(["00","05","35","46","49","63","95"])+" ",sections:[5]}]),f=a.formatted?e(c):e(c).replace(" ","","g"));break;case"us":var g=this.areacode(a).toString(),h=this.natural({min:2,max:9}).toString()+this.natural({min:0,max:9}).toString()+this.natural({min:0,max:9}).toString(),i=this.natural({min:1e3,max:9999}).toString();f=a.formatted?g+" "+h+"-"+i:g+h+i}return f},a.prototype.postal=function(){var a=this.character({pool:"XVTSRPNKLMHJGECBA"}),b=a+this.natural({max:9})+this.character({alpha:!0,casing:"upper"}),c=this.natural({max:9})+this.character({alpha:!0,casing:"upper"})+this.natural({max:9});return b+" "+c},a.prototype.provinces=function(){return this.get("provinces")},a.prototype.province=function(a){return a&&a.full?this.pick(this.provinces()).name:this.pick(this.provinces()).abbreviation},a.prototype.state=function(a){return a&&a.full?this.pick(this.states(a)).name:this.pick(this.states(a)).abbreviation},a.prototype.states=function(a){a=b(a);var c,d=this.get("us_states_and_dc"),e=this.get("territories"),f=this.get("armed_forces");return c=d,a.territories&&(c=c.concat(e)),a.armed_forces&&(c=c.concat(f)),c},a.prototype.street=function(a){a=b(a);var c=this.word({syllables:2});return c=this.capitalize(c),c+=" ",c+=a.short_suffix?this.street_suffix().abbreviation:this.street_suffix().name},a.prototype.street_suffix=function(){return this.pick(this.street_suffixes())},a.prototype.street_suffixes=function(){return this.get("street_suffixes")},a.prototype.zip=function(a){var b=this.n(this.natural,5,{max:9});return a&&a.plusfour===!0&&(b.push("-"),b=b.concat(this.n(this.natural,4,{max:9}))),b.join("")},a.prototype.ampm=function(){return this.bool()?"am":"pm"},a.prototype.date=function(a){var c,d;if(a&&(a.min||a.max)){a=b(a,{american:!0,string:!1});var e="undefined"!=typeof a.min?a.min.getTime():1,f="undefined"!=typeof a.max?a.max.getTime():864e13;d=new Date(this.natural({min:e,max:f}))}else{var g=this.month({raw:!0});a=b(a,{year:parseInt(this.year(),10),month:g.numeric-1,day:this.natural({min:1,max:g.days}),hour:this.hour(),minute:this.minute(),second:this.second(),millisecond:this.millisecond(),american:!0,string:!1}),d=new Date(a.year,a.month,a.day,a.hour,a.minute,a.second,a.millisecond)}return c=a.american?d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear():d.getDate()+"/"+(d.getMonth()+1)+"/"+d.getFullYear(),a.string?c:d},a.prototype.hammertime=function(a){return this.date(a).getTime()},a.prototype.hour=function(a){return a=b(a,{min:1,max:a&&a.twentyfour?24:12}),c(a.min<1,"Chance: Min cannot be less than 1."),c(a.twentyfour&&a.max>24,"Chance: Max cannot be greater than 24 for twentyfour option."),c(!a.twentyfour&&a.max>12,"Chance: Max cannot be greater than 12."),c(a.min>a.max,"Chance: Min cannot be greater than Max."),this.natural({min:a.min,max:a.max})},a.prototype.millisecond=function(){return this.natural({max:999})},a.prototype.minute=a.prototype.second=function(a){return a=b(a,{min:0,max:59}),c(a.min<0,"Chance: Min cannot be less than 0."),c(a.max>59,"Chance: Max cannot be greater than 59."),c(a.min>a.max,"Chance: Min cannot be greater than Max."),this.natural({min:a.min,max:a.max})},a.prototype.month=function(a){a=b(a,{min:1,max:12}),c(a.min<1,"Chance: Min cannot be less than 1."),c(a.max>12,"Chance: Max cannot be greater than 12."),c(a.min>a.max,"Chance: Min cannot be greater than Max.");var d=this.pick(this.months().slice(a.min-1,a.max));return a.raw?d:d.name},a.prototype.months=function(){return this.get("months")},a.prototype.second=function(){return this.natural({max:59})},a.prototype.timestamp=function(){return this.natural({min:1,max:parseInt((new Date).getTime()/1e3,10)})},a.prototype.year=function(a){return a=b(a,{min:(new Date).getFullYear()}),a.max="undefined"!=typeof a.max?a.max:a.min+100,this.natural(a).toString()},a.prototype.cc=function(a){a=b(a);var c,d,e;return c=a.type?this.cc_type({name:a.type,raw:!0}):this.cc_type({raw:!0}),d=c.prefix.split(""),e=c.length-c.prefix.length-1,d=d.concat(this.n(this.integer,e,{min:0,max:9})),d.push(this.luhn_calculate(d.join(""))),d.join("")},a.prototype.cc_types=function(){return this.get("cc_types")},a.prototype.cc_type=function(a){a=b(a);var c=this.cc_types(),d=null;if(a.name){for(var e=0;e<c.length;e++)if(c[e].name===a.name||c[e].short_name===a.name){d=c[e];break}if(null===d)throw new Error("Credit card type '"+a.name+"'' is not supported")}else d=this.pick(c);return a.raw?d:d.name},a.prototype.currency_types=function(){return this.get("currency_types")},a.prototype.currency=function(){return this.pick(this.currency_types())},a.prototype.currency_pair=function(a){var b=this.unique(this.currency,2,{comparator:function(a,b){return a.reduce(function(a,c){return a||c.code===b.code},!1)}});return a?b[0]+"/"+b[1]:b},a.prototype.dollar=function(a){a=b(a,{max:1e4,min:0});var c=this.floating({min:a.min,max:a.max,fixed:2}).toString(),d=c.split(".")[1];return void 0===d?c+=".00":d.length<2&&(c+="0"),c<0?"-$"+c.replace("-",""):"$"+c},a.prototype.exp=function(a){a=b(a);var c={};return c.year=this.exp_year(),c.year===(new Date).getFullYear()?c.month=this.exp_month({future:!0}):c.month=this.exp_month(),a.raw?c:c.month+"/"+c.year},a.prototype.exp_month=function(a){a=b(a);var c,d,e=(new Date).getMonth();if(a.future){do c=this.month({raw:!0}).numeric,d=parseInt(c,10);while(d<e)}else c=this.month({raw:!0}).numeric;return c},a.prototype.exp_year=function(){return this.year({max:(new Date).getFullYear()+10})},a.prototype.d4=d({min:1,max:4}),a.prototype.d6=d({min:1,max:6}),a.prototype.d8=d({min:1,max:8}),a.prototype.d10=d({min:1,max:10}),a.prototype.d12=d({min:1,max:12}),a.prototype.d20=d({min:1,max:20}),a.prototype.d30=d({min:1,max:30}),a.prototype.d100=d({min:1,max:100}),a.prototype.rpg=function(a,c){if(c=b(c),null===a)throw new Error("A type of die roll must be included");var d=a.toLowerCase().split("d"),e=[];if(2!==d.length||!parseInt(d[0],10)||!parseInt(d[1],10))throw new Error("Invalid format provided. Please provide #d# where the first # is the number of dice to roll, the second # is the max of each die");for(var f=d[0];f>0;f--)e[f-1]=this.natural({min:1,max:d[1]});return"undefined"!=typeof c.sum&&c.sum?e.reduce(function(a,b){return a+b}):e},a.prototype.guid=function(a){a=b(a,{version:5});var c="abcdef1234567890",d="ab89",e=this.string({pool:c,length:8})+"-"+this.string({pool:c,length:4})+"-"+a.version+this.string({pool:c,length:3})+"-"+this.string({pool:d,length:1})+this.string({pool:c,length:3})+"-"+this.string({pool:c,length:12});return e},a.prototype.hash=function(a){a=b(a,{length:40,casing:"lower"});var c="upper"===a.casing?m.toUpperCase():m;return this.string({pool:c,length:a.length})},a.prototype.luhn_check=function(a){var b=a.toString(),c=+b.substring(b.length-1);return c===this.luhn_calculate(+b.substring(0,b.length-1))},a.prototype.luhn_calculate=function(a){for(var b,c=a.toString().split("").reverse(),d=0,e=0,f=c.length;f>e;++e)b=+c[e],e%2===0&&(b*=2,b>9&&(b-=9)),d+=b;return 9*d%10};var p={firstNames:{male:["James","John","Robert","Michael","William","David","Richard","Joseph","Charles","Thomas","Christopher","Daniel","Matthew","George","Donald","Anthony","Paul","Mark","Edward","Steven","Kenneth","Andrew","Brian","Joshua","Kevin","Ronald","Timothy","Jason","Jeffrey","Frank","Gary","Ryan","Nicholas","Eric","Stephen","Jacob","Larry","Jonathan","Scott","Raymond","Justin","Brandon","Gregory","Samuel","Benjamin","Patrick","Jack","Henry","Walter","Dennis","Jerry","Alexander","Peter","Tyler","Douglas","Harold","Aaron","Jose","Adam","Arthur","Zachary","Carl","Nathan","Albert","Kyle","Lawrence","Joe","Willie","Gerald","Roger","Keith","Jeremy","Terry","Harry","Ralph","Sean","Jesse","Roy","Louis","Billy","Austin","Bruce","Eugene","Christian","Bryan","Wayne","Russell","Howard","Fred","Ethan","Jordan","Philip","Alan","Juan","Randy","Vincent","Bobby","Dylan","Johnny","Phillip","Victor","Clarence","Ernest","Martin","Craig","Stanley","Shawn","Travis","Bradley","Leonard","Earl","Gabriel","Jimmy","Francis","Todd","Noah","Danny","Dale","Cody","Carlos","Allen","Frederick","Logan","Curtis","Alex","Joel","Luis","Norman","Marvin","Glenn","Tony","Nathaniel","Rodney","Melvin","Alfred","Steve","Cameron","Chad","Edwin","Caleb","Evan","Antonio","Lee","Herbert","Jeffery","Isaac","Derek","Ricky","Marcus","Theodore","Elijah","Luke","Jesus","Eddie","Troy","Mike","Dustin","Ray","Adrian","Bernard","Leroy","Angel","Randall","Wesley","Ian","Jared","Mason","Hunter","Calvin","Oscar","Clifford","Jay","Shane","Ronnie","Barry","Lucas","Corey","Manuel","Leo","Tommy","Warren","Jackson","Isaiah","Connor","Don","Dean","Jon","Julian","Miguel","Bill","Lloyd","Charlie","Mitchell","Leon","Jerome","Darrell","Jeremiah","Alvin","Brett","Seth","Floyd","Jim","Blake","Micheal","Gordon","Trevor","Lewis","Erik","Edgar","Vernon","Devin","Gavin","Jayden","Chris","Clyde","Tom","Derrick","Mario","Brent","Marc","Herman","Chase","Dominic","Ricardo","Franklin","Maurice","Max","Aiden","Owen","Lester","Gilbert","Elmer","Gene","Francisco","Glen","Cory","Garrett","Clayton","Sam","Jorge","Chester","Alejandro","Jeff","Harvey","Milton","Cole","Ivan","Andre","Duane","Landon"],female:["Mary","Emma","Elizabeth","Minnie","Margaret","Ida","Alice","Bertha","Sarah","Annie","Clara","Ella","Florence","Cora","Martha","Laura","Nellie","Grace","Carrie","Maude","Mabel","Bessie","Jennie","Gertrude","Julia","Hattie","Edith","Mattie","Rose","Catherine","Lillian","Ada","Lillie","Helen","Jessie","Louise","Ethel","Lula","Myrtle","Eva","Frances","Lena","Lucy","Edna","Maggie","Pearl","Daisy","Fannie","Josephine","Dora","Rosa","Katherine","Agnes","Marie","Nora","May","Mamie","Blanche","Stella","Ellen","Nancy","Effie","Sallie","Nettie","Della","Lizzie","Flora","Susie","Maud","Mae","Etta","Harriet","Sadie","Caroline","Katie","Lydia","Elsie","Kate","Susan","Mollie","Alma","Addie","Georgia","Eliza","Lulu","Nannie","Lottie","Amanda","Belle","Charlotte","Rebecca","Ruth","Viola","Olive","Amelia","Hannah","Jane","Virginia","Emily","Matilda","Irene","Kathryn","Esther","Willie","Henrietta","Ollie","Amy","Rachel","Sara","Estella","Theresa","Augusta","Ora","Pauline","Josie","Lola","Sophia","Leona","Anne","Mildred","Ann","Beulah","Callie","Lou","Delia","Eleanor","Barbara","Iva","Louisa","Maria","Mayme","Evelyn","Estelle","Nina","Betty","Marion","Bettie","Dorothy","Luella","Inez","Lela","Rosie","Allie","Millie","Janie","Cornelia","Victoria","Ruby","Winifred","Alta","Celia","Christine","Beatrice","Birdie","Harriett","Mable","Myra","Sophie","Tillie","Isabel","Sylvia","Carolyn","Isabelle","Leila","Sally","Ina","Essie","Bertie","Nell","Alberta","Katharine","Lora","Rena","Mina","Rhoda","Mathilda","Abbie","Eula","Dollie","Hettie","Eunice","Fanny","Ola","Lenora","Adelaide","Christina","Lelia","Nelle","Sue","Johanna","Lilly","Lucinda","Minerva","Lettie","Roxie","Cynthia","Helena","Hilda","Hulda","Bernice","Genevieve","Jean","Cordelia","Marian","Francis","Jeanette","Adeline","Gussie","Leah","Lois","Lura","Mittie","Hallie","Isabella","Olga","Phoebe","Teresa","Hester","Lida","Lina","Winnie","Claudia","Marguerite","Vera","Cecelia","Bess","Emilie","John","Rosetta","Verna","Myrtie","Cecilia","Elva","Olivia","Ophelia","Georgie","Elnora","Violet","Adele","Lily","Linnie","Loretta","Madge","Polly","Virgie","Eugenia","Lucile","Lucille","Mabelle","Rosalie"]
},lastNames:["Smith","Johnson","Williams","Jones","Brown","Davis","Miller","Wilson","Moore","Taylor","Anderson","Thomas","Jackson","White","Harris","Martin","Thompson","Garcia","Martinez","Robinson","Clark","Rodriguez","Lewis","Lee","Walker","Hall","Allen","Young","Hernandez","King","Wright","Lopez","Hill","Scott","Green","Adams","Baker","Gonzalez","Nelson","Carter","Mitchell","Perez","Roberts","Turner","Phillips","Campbell","Parker","Evans","Edwards","Collins","Stewart","Sanchez","Morris","Rogers","Reed","Cook","Morgan","Bell","Murphy","Bailey","Rivera","Cooper","Richardson","Cox","Howard","Ward","Torres","Peterson","Gray","Ramirez","James","Watson","Brooks","Kelly","Sanders","Price","Bennett","Wood","Barnes","Ross","Henderson","Coleman","Jenkins","Perry","Powell","Long","Patterson","Hughes","Flores","Washington","Butler","Simmons","Foster","Gonzales","Bryant","Alexander","Russell","Griffin","Diaz","Hayes","Myers","Ford","Hamilton","Graham","Sullivan","Wallace","Woods","Cole","West","Jordan","Owens","Reynolds","Fisher","Ellis","Harrison","Gibson","McDonald","Cruz","Marshall","Ortiz","Gomez","Murray","Freeman","Wells","Webb","Simpson","Stevens","Tucker","Porter","Hunter","Hicks","Crawford","Henry","Boyd","Mason","Morales","Kennedy","Warren","Dixon","Ramos","Reyes","Burns","Gordon","Shaw","Holmes","Rice","Robertson","Hunt","Black","Daniels","Palmer","Mills","Nichols","Grant","Knight","Ferguson","Rose","Stone","Hawkins","Dunn","Perkins","Hudson","Spencer","Gardner","Stephens","Payne","Pierce","Berry","Matthews","Arnold","Wagner","Willis","Ray","Watkins","Olson","Carroll","Duncan","Snyder","Hart","Cunningham","Bradley","Lane","Andrews","Ruiz","Harper","Fox","Riley","Armstrong","Carpenter","Weaver","Greene","Lawrence","Elliott","Chavez","Sims","Austin","Peters","Kelley","Franklin","Lawson","Fields","Gutierrez","Ryan","Schmidt","Carr","Vasquez","Castillo","Wheeler","Chapman","Oliver","Montgomery","Richards","Williamson","Johnston","Banks","Meyer","Bishop","McCoy","Howell","Alvarez","Morrison","Hansen","Fernandez","Garza","Harvey","Little","Burton","Stanley","Nguyen","George","Jacobs","Reid","Kim","Fuller","Lynch","Dean","Gilbert","Garrett","Romero","Welch","Larson","Frazier","Burke","Hanson","Day","Mendoza","Moreno","Bowman","Medina","Fowler","Brewer","Hoffman","Carlson","Silva","Pearson","Holland","Douglas","Fleming","Jensen","Vargas","Byrd","Davidson","Hopkins","May","Terry","Herrera","Wade","Soto","Walters","Curtis","Neal","Caldwell","Lowe","Jennings","Barnett","Graves","Jimenez","Horton","Shelton","Barrett","Obrien","Castro","Sutton","Gregory","McKinney","Lucas","Miles","Craig","Rodriquez","Chambers","Holt","Lambert","Fletcher","Watts","Bates","Hale","Rhodes","Pena","Beck","Newman","Haynes","McDaniel","Mendez","Bush","Vaughn","Parks","Dawson","Santiago","Norris","Hardy","Love","Steele","Curry","Powers","Schultz","Barker","Guzman","Page","Munoz","Ball","Keller","Chandler","Weber","Leonard","Walsh","Lyons","Ramsey","Wolfe","Schneider","Mullins","Benson","Sharp","Bowen","Daniel","Barber","Cummings","Hines","Baldwin","Griffith","Valdez","Hubbard","Salazar","Reeves","Warner","Stevenson","Burgess","Santos","Tate","Cross","Garner","Mann","Mack","Moss","Thornton","Dennis","McGee","Farmer","Delgado","Aguilar","Vega","Glover","Manning","Cohen","Harmon","Rodgers","Robbins","Newton","Todd","Blair","Higgins","Ingram","Reese","Cannon","Strickland","Townsend","Potter","Goodwin","Walton","Rowe","Hampton","Ortega","Patton","Swanson","Joseph","Francis","Goodman","Maldonado","Yates","Becker","Erickson","Hodges","Rios","Conner","Adkins","Webster","Norman","Malone","Hammond","Flowers","Cobb","Moody","Quinn","Blake","Maxwell","Pope","Floyd","Osborne","Paul","McCarthy","Guerrero","Lindsey","Estrada","Sandoval","Gibbs","Tyler","Gross","Fitzgerald","Stokes","Doyle","Sherman","Saunders","Wise","Colon","Gill","Alvarado","Greer","Padilla","Simon","Waters","Nunez","Ballard","Schwartz","McBride","Houston","Christensen","Klein","Pratt","Briggs","Parsons","McLaughlin","Zimmerman","French","Buchanan","Moran","Copeland","Roy","Pittman","Brady","McCormick","Holloway","Brock","Poole","Frank","Logan","Owen","Bass","Marsh","Drake","Wong","Jefferson","Park","Morton","Abbott","Sparks","Patrick","Norton","Huff","Clayton","Massey","Lloyd","Figueroa","Carson","Bowers","Roberson","Barton","Tran","Lamb","Harrington","Casey","Boone","Cortez","Clarke","Mathis","Singleton","Wilkins","Cain","Bryan","Underwood","Hogan","McKenzie","Collier","Luna","Phelps","McGuire","Allison","Bridges","Wilkerson","Nash","Summers","Atkins"],countries:[{name:"Afghanistan",abbreviation:"AF"},{name:"Albania",abbreviation:"AL"},{name:"Algeria",abbreviation:"DZ"},{name:"American Samoa",abbreviation:"AS"},{name:"Andorra",abbreviation:"AD"},{name:"Angola",abbreviation:"AO"},{name:"Anguilla",abbreviation:"AI"},{name:"Antarctica",abbreviation:"AQ"},{name:"Antigua and Barbuda",abbreviation:"AG"},{name:"Argentina",abbreviation:"AR"},{name:"Armenia",abbreviation:"AM"},{name:"Aruba",abbreviation:"AW"},{name:"Australia",abbreviation:"AU"},{name:"Austria",abbreviation:"AT"},{name:"Azerbaijan",abbreviation:"AZ"},{name:"Bahamas",abbreviation:"BS"},{name:"Bahrain",abbreviation:"BH"},{name:"Bangladesh",abbreviation:"BD"},{name:"Barbados",abbreviation:"BB"},{name:"Belarus",abbreviation:"BY"},{name:"Belgium",abbreviation:"BE"},{name:"Belize",abbreviation:"BZ"},{name:"Benin",abbreviation:"BJ"},{name:"Bermuda",abbreviation:"BM"},{name:"Bhutan",abbreviation:"BT"},{name:"Bolivia",abbreviation:"BO"},{name:"Bosnia and Herzegovina",abbreviation:"BA"},{name:"Botswana",abbreviation:"BW"},{name:"Bouvet Island",abbreviation:"BV"},{name:"Brazil",abbreviation:"BR"},{name:"British Antarctic Territory",abbreviation:"BQ"},{name:"British Indian Ocean Territory",abbreviation:"IO"},{name:"British Virgin Islands",abbreviation:"VG"},{name:"Brunei",abbreviation:"BN"},{name:"Bulgaria",abbreviation:"BG"},{name:"Burkina Faso",abbreviation:"BF"},{name:"Burundi",abbreviation:"BI"},{name:"Cambodia",abbreviation:"KH"},{name:"Cameroon",abbreviation:"CM"},{name:"Canada",abbreviation:"CA"},{name:"Canton and Enderbury Islands",abbreviation:"CT"},{name:"Cape Verde",abbreviation:"CV"},{name:"Cayman Islands",abbreviation:"KY"},{name:"Central African Republic",abbreviation:"CF"},{name:"Chad",abbreviation:"TD"},{name:"Chile",abbreviation:"CL"},{name:"China",abbreviation:"CN"},{name:"Christmas Island",abbreviation:"CX"},{name:"Cocos [Keeling] Islands",abbreviation:"CC"},{name:"Colombia",abbreviation:"CO"},{name:"Comoros",abbreviation:"KM"},{name:"Congo - Brazzaville",abbreviation:"CG"},{name:"Congo - Kinshasa",abbreviation:"CD"},{name:"Cook Islands",abbreviation:"CK"},{name:"Costa Rica",abbreviation:"CR"},{name:"Croatia",abbreviation:"HR"},{name:"Cuba",abbreviation:"CU"},{name:"Cyprus",abbreviation:"CY"},{name:"Czech Republic",abbreviation:"CZ"},{name:"Côte d’Ivoire",abbreviation:"CI"},{name:"Denmark",abbreviation:"DK"},{name:"Djibouti",abbreviation:"DJ"},{name:"Dominica",abbreviation:"DM"},{name:"Dominican Republic",abbreviation:"DO"},{name:"Dronning Maud Land",abbreviation:"NQ"},{name:"East Germany",abbreviation:"DD"},{name:"Ecuador",abbreviation:"EC"},{name:"Egypt",abbreviation:"EG"},{name:"El Salvador",abbreviation:"SV"},{name:"Equatorial Guinea",abbreviation:"GQ"},{name:"Eritrea",abbreviation:"ER"},{name:"Estonia",abbreviation:"EE"},{name:"Ethiopia",abbreviation:"ET"},{name:"Falkland Islands",abbreviation:"FK"},{name:"Faroe Islands",abbreviation:"FO"},{name:"Fiji",abbreviation:"FJ"},{name:"Finland",abbreviation:"FI"},{name:"France",abbreviation:"FR"},{name:"French Guiana",abbreviation:"GF"},{name:"French Polynesia",abbreviation:"PF"},{name:"French Southern Territories",abbreviation:"TF"},{name:"French Southern and Antarctic Territories",abbreviation:"FQ"},{name:"Gabon",abbreviation:"GA"},{name:"Gambia",abbreviation:"GM"},{name:"Georgia",abbreviation:"GE"},{name:"Germany",abbreviation:"DE"},{name:"Ghana",abbreviation:"GH"},{name:"Gibraltar",abbreviation:"GI"},{name:"Greece",abbreviation:"GR"},{name:"Greenland",abbreviation:"GL"},{name:"Grenada",abbreviation:"GD"},{name:"Guadeloupe",abbreviation:"GP"},{name:"Guam",abbreviation:"GU"},{name:"Guatemala",abbreviation:"GT"},{name:"Guernsey",abbreviation:"GG"},{name:"Guinea",abbreviation:"GN"},{name:"Guinea-Bissau",abbreviation:"GW"},{name:"Guyana",abbreviation:"GY"},{name:"Haiti",abbreviation:"HT"},{name:"Heard Island and McDonald Islands",abbreviation:"HM"},{name:"Honduras",abbreviation:"HN"},{name:"Hong Kong SAR China",abbreviation:"HK"},{name:"Hungary",abbreviation:"HU"},{name:"Iceland",abbreviation:"IS"},{name:"India",abbreviation:"IN"},{name:"Indonesia",abbreviation:"ID"},{name:"Iran",abbreviation:"IR"},{name:"Iraq",abbreviation:"IQ"},{name:"Ireland",abbreviation:"IE"},{name:"Isle of Man",abbreviation:"IM"},{name:"Israel",abbreviation:"IL"},{name:"Italy",abbreviation:"IT"},{name:"Jamaica",abbreviation:"JM"},{name:"Japan",abbreviation:"JP"},{name:"Jersey",abbreviation:"JE"},{name:"Johnston Island",abbreviation:"JT"},{name:"Jordan",abbreviation:"JO"},{name:"Kazakhstan",abbreviation:"KZ"},{name:"Kenya",abbreviation:"KE"},{name:"Kiribati",abbreviation:"KI"},{name:"Kuwait",abbreviation:"KW"},{name:"Kyrgyzstan",abbreviation:"KG"},{name:"Laos",abbreviation:"LA"},{name:"Latvia",abbreviation:"LV"},{name:"Lebanon",abbreviation:"LB"},{name:"Lesotho",abbreviation:"LS"},{name:"Liberia",abbreviation:"LR"},{name:"Libya",abbreviation:"LY"},{name:"Liechtenstein",abbreviation:"LI"},{name:"Lithuania",abbreviation:"LT"},{name:"Luxembourg",abbreviation:"LU"},{name:"Macau SAR China",abbreviation:"MO"},{name:"Macedonia",abbreviation:"MK"},{name:"Madagascar",abbreviation:"MG"},{name:"Malawi",abbreviation:"MW"},{name:"Malaysia",abbreviation:"MY"},{name:"Maldives",abbreviation:"MV"},{name:"Mali",abbreviation:"ML"},{name:"Malta",abbreviation:"MT"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Martinique",abbreviation:"MQ"},{name:"Mauritania",abbreviation:"MR"},{name:"Mauritius",abbreviation:"MU"},{name:"Mayotte",abbreviation:"YT"},{name:"Metropolitan France",abbreviation:"FX"},{name:"Mexico",abbreviation:"MX"},{name:"Micronesia",abbreviation:"FM"},{name:"Midway Islands",abbreviation:"MI"},{name:"Moldova",abbreviation:"MD"},{name:"Monaco",abbreviation:"MC"},{name:"Mongolia",abbreviation:"MN"},{name:"Montenegro",abbreviation:"ME"},{name:"Montserrat",abbreviation:"MS"},{name:"Morocco",abbreviation:"MA"},{name:"Mozambique",abbreviation:"MZ"},{name:"Myanmar [Burma]",abbreviation:"MM"},{name:"Namibia",abbreviation:"NA"},{name:"Nauru",abbreviation:"NR"},{name:"Nepal",abbreviation:"NP"},{name:"Netherlands",abbreviation:"NL"},{name:"Netherlands Antilles",abbreviation:"AN"},{name:"Neutral Zone",abbreviation:"NT"},{name:"New Caledonia",abbreviation:"NC"},{name:"New Zealand",abbreviation:"NZ"},{name:"Nicaragua",abbreviation:"NI"},{name:"Niger",abbreviation:"NE"},{name:"Nigeria",abbreviation:"NG"},{name:"Niue",abbreviation:"NU"},{name:"Norfolk Island",abbreviation:"NF"},{name:"North Korea",abbreviation:"KP"},{name:"North Vietnam",abbreviation:"VD"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Norway",abbreviation:"NO"},{name:"Oman",abbreviation:"OM"},{name:"Pacific Islands Trust Territory",abbreviation:"PC"},{name:"Pakistan",abbreviation:"PK"},{name:"Palau",abbreviation:"PW"},{name:"Palestinian Territories",abbreviation:"PS"},{name:"Panama",abbreviation:"PA"},{name:"Panama Canal Zone",abbreviation:"PZ"},{name:"Papua New Guinea",abbreviation:"PG"},{name:"Paraguay",abbreviation:"PY"},{name:"People's Democratic Republic of Yemen",abbreviation:"YD"},{name:"Peru",abbreviation:"PE"},{name:"Philippines",abbreviation:"PH"},{name:"Pitcairn Islands",abbreviation:"PN"},{name:"Poland",abbreviation:"PL"},{name:"Portugal",abbreviation:"PT"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Qatar",abbreviation:"QA"},{name:"Romania",abbreviation:"RO"},{name:"Russia",abbreviation:"RU"},{name:"Rwanda",abbreviation:"RW"},{name:"Réunion",abbreviation:"RE"},{name:"Saint Barthélemy",abbreviation:"BL"},{name:"Saint Helena",abbreviation:"SH"},{name:"Saint Kitts and Nevis",abbreviation:"KN"},{name:"Saint Lucia",abbreviation:"LC"},{name:"Saint Martin",abbreviation:"MF"},{name:"Saint Pierre and Miquelon",abbreviation:"PM"},{name:"Saint Vincent and the Grenadines",abbreviation:"VC"},{name:"Samoa",abbreviation:"WS"},{name:"San Marino",abbreviation:"SM"},{name:"Saudi Arabia",abbreviation:"SA"},{name:"Senegal",abbreviation:"SN"},{name:"Serbia",abbreviation:"RS"},{name:"Serbia and Montenegro",abbreviation:"CS"},{name:"Seychelles",abbreviation:"SC"},{name:"Sierra Leone",abbreviation:"SL"},{name:"Singapore",abbreviation:"SG"},{name:"Slovakia",abbreviation:"SK"},{name:"Slovenia",abbreviation:"SI"},{name:"Solomon Islands",abbreviation:"SB"},{name:"Somalia",abbreviation:"SO"},{name:"South Africa",abbreviation:"ZA"},{name:"South Georgia and the South Sandwich Islands",abbreviation:"GS"},{name:"South Korea",abbreviation:"KR"},{name:"Spain",abbreviation:"ES"},{name:"Sri Lanka",abbreviation:"LK"},{name:"Sudan",abbreviation:"SD"},{name:"Suriname",abbreviation:"SR"},{name:"Svalbard and Jan Mayen",abbreviation:"SJ"},{name:"Swaziland",abbreviation:"SZ"},{name:"Sweden",abbreviation:"SE"},{name:"Switzerland",abbreviation:"CH"},{name:"Syria",abbreviation:"SY"},{name:"São Tomé and Príncipe",abbreviation:"ST"},{name:"Taiwan",abbreviation:"TW"},{name:"Tajikistan",abbreviation:"TJ"},{name:"Tanzania",abbreviation:"TZ"},{name:"Thailand",abbreviation:"TH"},{name:"Timor-Leste",abbreviation:"TL"},{name:"Togo",abbreviation:"TG"},{name:"Tokelau",abbreviation:"TK"},{name:"Tonga",abbreviation:"TO"},{name:"Trinidad and Tobago",abbreviation:"TT"},{name:"Tunisia",abbreviation:"TN"},{name:"Turkey",abbreviation:"TR"},{name:"Turkmenistan",abbreviation:"TM"},{name:"Turks and Caicos Islands",abbreviation:"TC"},{name:"Tuvalu",abbreviation:"TV"},{name:"U.S. Minor Outlying Islands",abbreviation:"UM"},{name:"U.S. Miscellaneous Pacific Islands",abbreviation:"PU"},{name:"U.S. Virgin Islands",abbreviation:"VI"},{name:"Uganda",abbreviation:"UG"},{name:"Ukraine",abbreviation:"UA"},{name:"Union of Soviet Socialist Republics",abbreviation:"SU"},{name:"United Arab Emirates",abbreviation:"AE"},{name:"United Kingdom",abbreviation:"GB"},{name:"United States",abbreviation:"US"},{name:"Unknown or Invalid Region",abbreviation:"ZZ"},{name:"Uruguay",abbreviation:"UY"},{name:"Uzbekistan",abbreviation:"UZ"},{name:"Vanuatu",abbreviation:"VU"},{name:"Vatican City",abbreviation:"VA"},{name:"Venezuela",abbreviation:"VE"},{name:"Vietnam",abbreviation:"VN"},{name:"Wake Island",abbreviation:"WK"},{name:"Wallis and Futuna",abbreviation:"WF"},{name:"Western Sahara",abbreviation:"EH"},{name:"Yemen",abbreviation:"YE"},{name:"Zambia",abbreviation:"ZM"},{name:"Zimbabwe",abbreviation:"ZW"},{name:"Åland Islands",abbreviation:"AX"}],provinces:[{name:"Alberta",abbreviation:"AB"},{name:"British Columbia",abbreviation:"BC"},{name:"Manitoba",abbreviation:"MB"},{name:"New Brunswick",abbreviation:"NB"},{name:"Newfoundland and Labrador",abbreviation:"NL"},{name:"Nova Scotia",abbreviation:"NS"},{name:"Ontario",abbreviation:"ON"},{name:"Prince Edward Island",abbreviation:"PE"},{name:"Quebec",abbreviation:"QC"},{name:"Saskatchewan",abbreviation:"SK"},{name:"Northwest Territories",abbreviation:"NT"},{name:"Nunavut",abbreviation:"NU"},{name:"Yukon",abbreviation:"YT"}],us_states_and_dc:[{name:"Alabama",abbreviation:"AL"},{name:"Alaska",abbreviation:"AK"},{name:"Arizona",abbreviation:"AZ"},{name:"Arkansas",abbreviation:"AR"},{name:"California",abbreviation:"CA"},{name:"Colorado",abbreviation:"CO"},{name:"Connecticut",abbreviation:"CT"},{name:"Delaware",abbreviation:"DE"},{name:"District of Columbia",abbreviation:"DC"},{name:"Florida",abbreviation:"FL"},{name:"Georgia",abbreviation:"GA"},{name:"Hawaii",abbreviation:"HI"},{name:"Idaho",abbreviation:"ID"},{name:"Illinois",abbreviation:"IL"},{name:"Indiana",abbreviation:"IN"},{name:"Iowa",abbreviation:"IA"},{name:"Kansas",abbreviation:"KS"},{name:"Kentucky",abbreviation:"KY"},{name:"Louisiana",abbreviation:"LA"},{name:"Maine",abbreviation:"ME"},{name:"Maryland",abbreviation:"MD"},{name:"Massachusetts",abbreviation:"MA"},{name:"Michigan",abbreviation:"MI"},{name:"Minnesota",abbreviation:"MN"},{name:"Mississippi",abbreviation:"MS"},{name:"Missouri",abbreviation:"MO"},{name:"Montana",abbreviation:"MT"},{name:"Nebraska",abbreviation:"NE"},{name:"Nevada",abbreviation:"NV"},{name:"New Hampshire",abbreviation:"NH"},{name:"New Jersey",abbreviation:"NJ"},{name:"New Mexico",abbreviation:"NM"},{name:"New York",abbreviation:"NY"},{name:"North Carolina",abbreviation:"NC"},{name:"North Dakota",abbreviation:"ND"},{name:"Ohio",abbreviation:"OH"},{name:"Oklahoma",abbreviation:"OK"},{name:"Oregon",abbreviation:"OR"},{name:"Pennsylvania",abbreviation:"PA"},{name:"Rhode Island",abbreviation:"RI"},{name:"South Carolina",abbreviation:"SC"},{name:"South Dakota",abbreviation:"SD"},{name:"Tennessee",abbreviation:"TN"},{name:"Texas",abbreviation:"TX"},{name:"Utah",abbreviation:"UT"},{name:"Vermont",abbreviation:"VT"},{name:"Virginia",abbreviation:"VA"},{name:"Washington",abbreviation:"WA"},{name:"West Virginia",abbreviation:"WV"},{name:"Wisconsin",abbreviation:"WI"},{name:"Wyoming",abbreviation:"WY"}],territories:[{name:"American Samoa",abbreviation:"AS"},{name:"Federated States of Micronesia",abbreviation:"FM"},{name:"Guam",abbreviation:"GU"},{name:"Marshall Islands",abbreviation:"MH"},{name:"Northern Mariana Islands",abbreviation:"MP"},{name:"Puerto Rico",abbreviation:"PR"},{name:"Virgin Islands, U.S.",abbreviation:"VI"}],armed_forces:[{name:"Armed Forces Europe",abbreviation:"AE"},{name:"Armed Forces Pacific",abbreviation:"AP"},{name:"Armed Forces the Americas",abbreviation:"AA"}],street_suffixes:[{name:"Avenue",abbreviation:"Ave"},{name:"Boulevard",abbreviation:"Blvd"},{name:"Center",abbreviation:"Ctr"},{name:"Circle",abbreviation:"Cir"},{name:"Court",abbreviation:"Ct"},{name:"Drive",abbreviation:"Dr"},{name:"Extension",abbreviation:"Ext"},{name:"Glen",abbreviation:"Gln"},{name:"Grove",abbreviation:"Grv"},{name:"Heights",abbreviation:"Hts"},{name:"Highway",abbreviation:"Hwy"},{name:"Junction",abbreviation:"Jct"},{name:"Key",abbreviation:"Key"},{name:"Lane",abbreviation:"Ln"},{name:"Loop",abbreviation:"Loop"},{name:"Manor",abbreviation:"Mnr"},{name:"Mill",abbreviation:"Mill"},{name:"Park",abbreviation:"Park"},{name:"Parkway",abbreviation:"Pkwy"},{name:"Pass",abbreviation:"Pass"},{name:"Path",abbreviation:"Path"},{name:"Pike",abbreviation:"Pike"},{name:"Place",abbreviation:"Pl"},{name:"Plaza",abbreviation:"Plz"},{name:"Point",abbreviation:"Pt"},{name:"Ridge",abbreviation:"Rdg"},{name:"River",abbreviation:"Riv"},{name:"Road",abbreviation:"Rd"},{name:"Square",abbreviation:"Sq"},{name:"Street",abbreviation:"St"},{name:"Terrace",abbreviation:"Ter"},{name:"Trail",abbreviation:"Trl"},{name:"Turnpike",abbreviation:"Tpke"},{name:"View",abbreviation:"Vw"},{name:"Way",abbreviation:"Way"}],months:[{name:"January",short_name:"Jan",numeric:"01",days:31},{name:"February",short_name:"Feb",numeric:"02",days:28},{name:"March",short_name:"Mar",numeric:"03",days:31},{name:"April",short_name:"Apr",numeric:"04",days:30},{name:"May",short_name:"May",numeric:"05",days:31},{name:"June",short_name:"Jun",numeric:"06",days:30},{name:"July",short_name:"Jul",numeric:"07",days:31},{name:"August",short_name:"Aug",numeric:"08",days:31},{name:"September",short_name:"Sep",numeric:"09",days:30},{name:"October",short_name:"Oct",numeric:"10",days:31},{name:"November",short_name:"Nov",numeric:"11",days:30},{name:"December",short_name:"Dec",numeric:"12",days:31}],cc_types:[{name:"American Express",short_name:"amex",prefix:"34",length:15},{name:"Bankcard",short_name:"bankcard",prefix:"5610",length:16},{name:"China UnionPay",short_name:"chinaunion",prefix:"62",length:16},{name:"Diners Club Carte Blanche",short_name:"dccarte",prefix:"300",length:14},{name:"Diners Club enRoute",short_name:"dcenroute",prefix:"2014",length:15},{name:"Diners Club International",short_name:"dcintl",prefix:"36",length:14},{name:"Diners Club United States & Canada",short_name:"dcusc",prefix:"54",length:16},{name:"Discover Card",short_name:"discover",prefix:"6011",length:16},{name:"InstaPayment",short_name:"instapay",prefix:"637",length:16},{name:"JCB",short_name:"jcb",prefix:"3528",length:16},{name:"Laser",short_name:"laser",prefix:"6304",length:16},{name:"Maestro",short_name:"maestro",prefix:"5018",length:16},{name:"Mastercard",short_name:"mc",prefix:"51",length:16},{name:"Solo",short_name:"solo",prefix:"6334",length:16},{name:"Switch",short_name:"switch",prefix:"4903",length:16},{name:"Visa",short_name:"visa",prefix:"4",length:16},{name:"Visa Electron",short_name:"electron",prefix:"4026",length:16}],currency_types:[{code:"AED",name:"United Arab Emirates Dirham"},{code:"AFN",name:"Afghanistan Afghani"},{code:"ALL",name:"Albania Lek"},{code:"AMD",name:"Armenia Dram"},{code:"ANG",name:"Netherlands Antilles Guilder"},{code:"AOA",name:"Angola Kwanza"},{code:"ARS",name:"Argentina Peso"},{code:"AUD",name:"Australia Dollar"},{code:"AWG",name:"Aruba Guilder"},{code:"AZN",name:"Azerbaijan New Manat"},{code:"BAM",name:"Bosnia and Herzegovina Convertible Marka"},{code:"BBD",name:"Barbados Dollar"},{code:"BDT",name:"Bangladesh Taka"},{code:"BGN",name:"Bulgaria Lev"},{code:"BHD",name:"Bahrain Dinar"},{code:"BIF",name:"Burundi Franc"},{code:"BMD",name:"Bermuda Dollar"},{code:"BND",name:"Brunei Darussalam Dollar"},{code:"BOB",name:"Bolivia Boliviano"},{code:"BRL",name:"Brazil Real"},{code:"BSD",name:"Bahamas Dollar"},{code:"BTN",name:"Bhutan Ngultrum"},{code:"BWP",name:"Botswana Pula"},{code:"BYR",name:"Belarus Ruble"},{code:"BZD",name:"Belize Dollar"},{code:"CAD",name:"Canada Dollar"},{code:"CDF",name:"Congo/Kinshasa Franc"},{code:"CHF",name:"Switzerland Franc"},{code:"CLP",name:"Chile Peso"},{code:"CNY",name:"China Yuan Renminbi"},{code:"COP",name:"Colombia Peso"},{code:"CRC",name:"Costa Rica Colon"},{code:"CUC",name:"Cuba Convertible Peso"},{code:"CUP",name:"Cuba Peso"},{code:"CVE",name:"Cape Verde Escudo"},{code:"CZK",name:"Czech Republic Koruna"},{code:"DJF",name:"Djibouti Franc"},{code:"DKK",name:"Denmark Krone"},{code:"DOP",name:"Dominican Republic Peso"},{code:"DZD",name:"Algeria Dinar"},{code:"EGP",name:"Egypt Pound"},{code:"ERN",name:"Eritrea Nakfa"},{code:"ETB",name:"Ethiopia Birr"},{code:"EUR",name:"Euro Member Countries"},{code:"FJD",name:"Fiji Dollar"},{code:"FKP",name:"Falkland Islands (Malvinas) Pound"},{code:"GBP",name:"United Kingdom Pound"},{code:"GEL",name:"Georgia Lari"},{code:"GGP",name:"Guernsey Pound"},{code:"GHS",name:"Ghana Cedi"},{code:"GIP",name:"Gibraltar Pound"},{code:"GMD",name:"Gambia Dalasi"},{code:"GNF",name:"Guinea Franc"},{code:"GTQ",name:"Guatemala Quetzal"},{code:"GYD",name:"Guyana Dollar"},{code:"HKD",name:"Hong Kong Dollar"},{code:"HNL",name:"Honduras Lempira"},{code:"HRK",name:"Croatia Kuna"},{code:"HTG",name:"Haiti Gourde"},{code:"HUF",name:"Hungary Forint"},{code:"IDR",name:"Indonesia Rupiah"},{code:"ILS",name:"Israel Shekel"},{code:"IMP",name:"Isle of Man Pound"},{code:"INR",name:"India Rupee"},{code:"IQD",name:"Iraq Dinar"},{code:"IRR",name:"Iran Rial"},{code:"ISK",name:"Iceland Krona"},{code:"JEP",name:"Jersey Pound"},{code:"JMD",name:"Jamaica Dollar"},{code:"JOD",name:"Jordan Dinar"},{code:"JPY",name:"Japan Yen"},{code:"KES",name:"Kenya Shilling"},{code:"KGS",name:"Kyrgyzstan Som"},{code:"KHR",name:"Cambodia Riel"},{code:"KMF",name:"Comoros Franc"},{code:"KPW",name:"Korea (North) Won"},{code:"KRW",name:"Korea (South) Won"},{code:"KWD",name:"Kuwait Dinar"},{code:"KYD",name:"Cayman Islands Dollar"},{code:"KZT",name:"Kazakhstan Tenge"},{code:"LAK",name:"Laos Kip"},{code:"LBP",name:"Lebanon Pound"},{code:"LKR",name:"Sri Lanka Rupee"},{code:"LRD",name:"Liberia Dollar"},{code:"LSL",name:"Lesotho Loti"},{code:"LTL",name:"Lithuania Litas"},{code:"LYD",name:"Libya Dinar"},{code:"MAD",name:"Morocco Dirham"},{code:"MDL",name:"Moldova Leu"},{code:"MGA",name:"Madagascar Ariary"},{code:"MKD",name:"Macedonia Denar"},{code:"MMK",name:"Myanmar (Burma) Kyat"},{code:"MNT",name:"Mongolia Tughrik"},{code:"MOP",name:"Macau Pataca"},{code:"MRO",name:"Mauritania Ouguiya"},{code:"MUR",name:"Mauritius Rupee"},{code:"MVR",name:"Maldives (Maldive Islands) Rufiyaa"},{code:"MWK",name:"Malawi Kwacha"},{code:"MXN",name:"Mexico Peso"},{code:"MYR",name:"Malaysia Ringgit"},{code:"MZN",name:"Mozambique Metical"},{code:"NAD",name:"Namibia Dollar"},{code:"NGN",name:"Nigeria Naira"},{code:"NIO",name:"Nicaragua Cordoba"},{code:"NOK",name:"Norway Krone"},{code:"NPR",name:"Nepal Rupee"},{code:"NZD",name:"New Zealand Dollar"},{code:"OMR",name:"Oman Rial"},{code:"PAB",name:"Panama Balboa"},{code:"PEN",name:"Peru Nuevo Sol"},{code:"PGK",name:"Papua New Guinea Kina"},{code:"PHP",name:"Philippines Peso"},{code:"PKR",name:"Pakistan Rupee"},{code:"PLN",name:"Poland Zloty"},{code:"PYG",name:"Paraguay Guarani"},{code:"QAR",name:"Qatar Riyal"},{code:"RON",name:"Romania New Leu"},{code:"RSD",name:"Serbia Dinar"},{code:"RUB",name:"Russia Ruble"},{code:"RWF",name:"Rwanda Franc"},{code:"SAR",name:"Saudi Arabia Riyal"},{code:"SBD",name:"Solomon Islands Dollar"},{code:"SCR",name:"Seychelles Rupee"},{code:"SDG",name:"Sudan Pound"},{code:"SEK",name:"Sweden Krona"},{code:"SGD",name:"Singapore Dollar"},{code:"SHP",name:"Saint Helena Pound"},{code:"SLL",name:"Sierra Leone Leone"},{code:"SOS",name:"Somalia Shilling"},{code:"SPL",name:"Seborga Luigino"},{code:"SRD",name:"Suriname Dollar"},{code:"STD",name:"São Tomé and Príncipe Dobra"},{code:"SVC",name:"El Salvador Colon"},{code:"SYP",name:"Syria Pound"},{code:"SZL",name:"Swaziland Lilangeni"},{code:"THB",name:"Thailand Baht"},{code:"TJS",name:"Tajikistan Somoni"},{code:"TMT",name:"Turkmenistan Manat"},{code:"TND",name:"Tunisia Dinar"},{code:"TOP",name:"Tonga Pa'anga"},{code:"TRY",name:"Turkey Lira"},{code:"TTD",name:"Trinidad and Tobago Dollar"},{code:"TVD",name:"Tuvalu Dollar"},{code:"TWD",name:"Taiwan New Dollar"},{code:"TZS",name:"Tanzania Shilling"},{code:"UAH",name:"Ukraine Hryvnia"},{code:"UGX",name:"Uganda Shilling"},{code:"USD",name:"United States Dollar"},{code:"UYU",name:"Uruguay Peso"},{code:"UZS",name:"Uzbekistan Som"},{code:"VEF",name:"Venezuela Bolivar"},{code:"VND",name:"Viet Nam Dong"},{code:"VUV",name:"Vanuatu Vatu"},{code:"WST",name:"Samoa Tala"},{code:"XAF",name:"Communauté Financière Africaine (BEAC) CFA Franc BEAC"},{code:"XCD",name:"East Caribbean Dollar"},{code:"XDR",name:"International Monetary Fund (IMF) Special Drawing Rights"},{code:"XOF",name:"Communauté Financière Africaine (BCEAO) Franc"},{code:"XPF",name:"Comptoirs Français du Pacifique (CFP) Franc"},{code:"YER",name:"Yemen Rial"},{code:"ZAR",name:"South Africa Rand"},{code:"ZMW",name:"Zambia Kwacha"},{code:"ZWD",name:"Zimbabwe Dollar"}]},q=Object.prototype.hasOwnProperty,r=Object.keys||function(a){var b=[];for(var c in a)q.call(a,c)&&b.push(c);return b};a.prototype.get=function(a){return g(p[a])},a.prototype.mac_address=function(a){a=b(a),a.separator||(a.separator=a.networkVersion?".":":");var c="ABCDEF1234567890",d="";return d=a.networkVersion?this.n(this.string,3,{pool:c,length:4}).join(a.separator):this.n(this.string,6,{pool:c,length:2}).join(a.separator)},a.prototype.normal=function(a){a=b(a,{mean:0,dev:1});var c,d,e,f,g=a.mean,h=a.dev;do d=2*this.random()-1,e=2*this.random()-1,c=d*d+e*e;while(c>=1);return f=d*Math.sqrt(-2*Math.log(c)/c),h*f+g},a.prototype.radio=function(a){a=b(a,{side:"?"});var c="";switch(a.side.toLowerCase()){case"east":case"e":c="W";break;case"west":case"w":c="K";break;default:c=this.character({pool:"KW"})}return c+this.character({alpha:!0,casing:"upper"})+this.character({alpha:!0,casing:"upper"})+this.character({alpha:!0,casing:"upper"})},a.prototype.set=function(a,b){"string"==typeof a?p[a]=b:p=g(a,p)},a.prototype.tv=function(a){return this.radio(a)},a.prototype.cnpj=function(){var a=this.n(this.natural,8,{max:9}),b=2+6*a[7]+7*a[6]+8*a[5]+9*a[4]+2*a[3]+3*a[2]+4*a[1]+5*a[0];b=11-b%11,b>=10&&(b=0);var c=2*b+3+7*a[7]+8*a[6]+9*a[5]+2*a[4]+3*a[3]+4*a[2]+5*a[1]+6*a[0];return c=11-c%11,c>=10&&(c=0),""+a[0]+a[1]+"."+a[2]+a[3]+a[4]+"."+a[5]+a[6]+a[7]+"/0001-"+b+c},a.prototype.mersenne_twister=function(a){return new s(a)};var s=function(a){void 0===a&&(a=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(a)};s.prototype.init_genrand=function(a){for(this.mt[0]=a>>>0,this.mti=1;this.mti<this.N;this.mti++)a=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((4294901760&a)>>>16)<<16)+1812433253*(65535&a)+this.mti,this.mt[this.mti]>>>=0},s.prototype.init_by_array=function(a,b){var c,d,e=1,f=0;for(this.init_genrand(19650218),c=this.N>b?this.N:b;c;c--)d=this.mt[e-1]^this.mt[e-1]>>>30,this.mt[e]=(this.mt[e]^(1664525*((4294901760&d)>>>16)<<16)+1664525*(65535&d))+a[f]+f,this.mt[e]>>>=0,e++,f++,e>=this.N&&(this.mt[0]=this.mt[this.N-1],e=1),f>=b&&(f=0);for(c=this.N-1;c;c--)d=this.mt[e-1]^this.mt[e-1]>>>30,this.mt[e]=(this.mt[e]^(1566083941*((4294901760&d)>>>16)<<16)+1566083941*(65535&d))-e,this.mt[e]>>>=0,e++,e>=this.N&&(this.mt[0]=this.mt[this.N-1],e=1);this.mt[0]=2147483648},s.prototype.genrand_int32=function(){var a,b=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var c;for(this.mti===this.N+1&&this.init_genrand(5489),c=0;c<this.N-this.M;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+this.M]^a>>>1^b[1&a];for(;c<this.N-1;c++)a=this.mt[c]&this.UPPER_MASK|this.mt[c+1]&this.LOWER_MASK,this.mt[c]=this.mt[c+(this.M-this.N)]^a>>>1^b[1&a];a=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^a>>>1^b[1&a],this.mti=0}return a=this.mt[this.mti++],a^=a>>>11,a^=a<<7&2636928640,a^=a<<15&4022730752,a^=a>>>18,a>>>0},s.prototype.genrand_int31=function(){return this.genrand_int32()>>>1},s.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)},s.prototype.random=function(){return this.genrand_int32()*(1/4294967296)},s.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)},s.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,b=this.genrand_int32()>>>6;return(67108864*a+b)*(1/9007199254740992)},"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=a),exports.Chance=a),"function"==typeof define&&define.amd&&define([],function(){return a}),"undefined"!=typeof importScripts&&(chance=new a),"object"==typeof window&&"object"==typeof window.document&&(window.Chance=a,window.chance=new a)}(),window.PopulatorView=countlyView.extend({initialize:function(){},beforeRender:function(){if(!this.template){var a=this;return $.when($.get(countlyGlobal.path+"/populator/templates/populate.html",function(b){a.template=Handlebars.compile(b)})).then(function(){})}},renderCommon:function(a){this.templateData={"page-title":jQuery.i18n.map["populator.title"]};var b,c=new Date,d=new Date(c.getTime()-2592e6),e=c,f=60;$(this.el).html(this.template(this.templateData)),$("#start-populate").on("click",function(){CountlyHelpers.confirm(jQuery.i18n.map["populator.warning1"]+" ("+countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].name+").<br/>"+jQuery.i18n.map["populator.warning2"],"red",function(a){return!a||(f=parseInt($("#populate-maxtime").val())||f,b=setTimeout(function(){$("#populator-status").fadeOut().text(jQuery.i18n.map["populator.processing"]).fadeIn(),countlyPopulator.stopGenerating(function(a){a===!0?($("#stop-populate").hide(),$("#start-populate").show(),$("#populator-status").fadeOut().text(jQuery.i18n.map["populator.done"]).fadeIn().delay(2e3).text(""),CountlyHelpers.confirm(jQuery.i18n.map["populator.success"],"green",function(a){return!a||void(window.location="/dashboard")}),$("#populate-bar div").css({width:0})):a===!1?($("#populator-status").html(jQuery.i18n.map["populator.jobs"]),$("#stop-populate").hide()):(CountlyHelpers.alert(a,"red"),
$("#stop-populate").hide(),$("#start-populate").show(),$("#populator-status").hide(),$("#populate-bar div").css({width:0}))})},1e3*f),d=$("#populate-from").datepicker("getDate")||d,e=$("#populate-to").datepicker("getDate")||e,countlyPopulator.setStartTime(d.getTime()/1e3),countlyPopulator.setEndTime(e.getTime()/1e3),countlyPopulator.generateUsers(250),$("#start-populate").hide(),$("#stop-populate").show(),$("#populator-status").fadeOut().text(jQuery.i18n.map["populator.generating"]).fadeIn(),void $("#populate-bar div").animate({width:"100%"},1e3*f))})}),$("#stop-populate").on("click",function(){b&&(clearTimeout(b),b=null),countlyPopulator.stopGenerating(),$("#stop-populate").hide(),$("#start-populate").show(),$("#populate-bar div").stop(!0),$("#populate-bar div").width(0),CountlyHelpers.confirm(jQuery.i18n.map["populator.success"],"green",function(a){return!a||void(window.location="/dashboard")})}),$("#populate-explain").on("click",function(){CountlyHelpers.alert(jQuery.i18n.map["populator.help"],"green")}),countlyPopulator.isGenerating()?($("#start-populate").hide(),$("#stop-populate").show(),countlyPopulator.generateUI(),$("#populate-from").val(moment(1e3*countlyPopulator.getStartTime()).format("YYYY-MM-DD")),$("#populate-to").val(moment(1e3*countlyPopulator.getEndTime()).format("YYYY-MM-DD")),$("#populate-from").datepicker({dateFormat:"yy-mm-dd",defaultDate:new Date(1e3*countlyPopulator.getStartTime()),constrainInput:!0,maxDate:c}),$("#populate-to").datepicker({dateFormat:"yy-mm-dd",defaultDate:new Date(1e3*countlyPopulator.getEndTime()),constrainInput:!0,maxDate:c})):($("#populate-from").val(moment(d).format("YYYY-MM-DD")),$("#populate-to").val(moment(e).format("YYYY-MM-DD")),$("#populate-from").datepicker({dateFormat:"yy-mm-dd",defaultDate:-30,constrainInput:!0,maxDate:c}),$("#populate-to").datepicker({dateFormat:"yy-mm-dd",constrainInput:!0,maxDate:c})),app.localize(),"/autostart"==this.state&&$("#start-populate").click()},refresh:function(){}}),app.populatorView=new PopulatorView,app.route("/manage/populate*state","populate",function(a){countlyGlobal.member.global_admin||countlyGlobal.admin_apps[countlyCommon.ACTIVE_APP_ID]?(this.populatorView.state=a,this.renderWhenReady(this.populatorView)):app.navigate("/",!0)});var start_populating=!1;app.addPageScript("/manage/apps",function(){var a='<tr class="populate-demo-data"><td><span data-localize="populator.demo-data"></span></td><td><input type="checkbox" id="populate-app-after"/>&nbsp;&nbsp;&nbsp;<span data-localize="populator.tooltip"></span></td></tr>';$("#add-new-app table .table-add").before(a);var b=countlyCommon.ACTIVE_APP_ID;!countlyGlobal.apps[b]||"mobile"!=countlyGlobal.apps[b].type&&"web"!=countlyGlobal.apps[b].type?$(".populate-demo-data").hide():$(".populate-demo-data").show(),$("#save-app-add").click(function(){$("#add-new-app table #populate-app-after").is(":checked")&&(start_populating=!0,setTimeout(function(){start_populating=!1},5e3))})}),app.addAppManagementSwitchCallback(function(a,b){"mobile"==b||"web"==b?$(".populate-demo-data").show():$(".populate-demo-data").hide()}),app.addAppManagementSwitchCallback(function(a,b){start_populating&&(start_populating=!1,setTimeout(function(){var a=$("#view-app-id").text();countlyCommon.setActiveApp(a),$("#sidebar-app-select").find(".logo").css("background-image","url('"+countlyGlobal.cdn+"appimages/"+a+".png')"),$("#sidebar-app-select").find(".text").text(countlyGlobal.apps[a].name),app.onAppSwitch(a,!0),app.navigate("/manage/populate/autostart",!0)},1e3))}),$(document).ready(function(){production||CountlyHelpers.loadJS("populator/javascripts/chance.js");var a="display:none;";(countlyGlobal.member.global_admin||countlyGlobal.admin_apps[countlyCommon.ACTIVE_APP_ID])&&(a="");var b='<a href="#/manage/populate" class="item populator-menu" style="'+a+'"><div class="logo-icon fa fa-random"></div><div class="text" data-localize="populator.title"></div></a>';$(".sidebar-menu #management-submenu .help-toggle").length&&$(".sidebar-menu #management-submenu .help-toggle").before(b),app.addAppSwitchCallback(function(a){countlyGlobal.member.global_admin||countlyGlobal.admin_apps[a]?$(".populator-menu").show():$(".populator-menu").hide()})}),function(a,b,c){var d={};a.initialize=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r+"/reports/all",data:{api_key:countlyGlobal.member.api_key},success:function(a){d=a}})},a.getData=function(){return d},a.create=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/reports/create",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify(a)}})},a.update=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/reports/update",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify(a)}})},a.del=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/reports/delete",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify({_id:a})}})},a.send=function(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/reports/send",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify({_id:a})}})}}(window.countlyReporting=window.countlyReporting||{},jQuery),window.ReportingView=countlyView.extend({initialize:function(){},beforeRender:function(){if(this.template)return $.when(countlyReporting.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/reports/templates/reports.html",function(b){a.template=Handlebars.compile(b)}),countlyReporting.initialize()).then(function(){})},getDayName:function(a){switch(a){case 1:return jQuery.i18n.map["reports.monday"];case 2:return jQuery.i18n.map["reports.tuesday"];case 3:return jQuery.i18n.map["reports.wednesday"];case 4:return jQuery.i18n.map["reports.thursday"];case 5:return jQuery.i18n.map["reports.friday"];case 6:return jQuery.i18n.map["reports.saturday"];case 7:return jQuery.i18n.map["reports.sunday"];default:return""}},getDayNumber:function(a){switch(a){case jQuery.i18n.map["reports.monday"]:return"1";case jQuery.i18n.map["reports.tuesday"]:return"2";case jQuery.i18n.map["reports.wednesday"]:return"3";case jQuery.i18n.map["reports.thursday"]:return"4";case jQuery.i18n.map["reports.friday"]:return"5";case jQuery.i18n.map["reports.saturday"]:return"6";case jQuery.i18n.map["reports.sunday"]:return"7";default:return"1"}},renderCommon:function(a){var b=app.manageAppsView.getTimeZones(),c={},d={},e=[];for(var f in b)for(var g=0;g<b[f].z.length;g++)for(var h in b[f].z[g])e.push(h),c[h]=b[f].z[g][h],d[b[f].z[g][h]]=h;for(var i=countlyReporting.getData(),f=0;f<i.length;f++)i[f].apps&&i[f].apps.length&&(i[f].appNames=CountlyHelpers.appIdsToNames(i[f].apps).split(", "),i[f].hour<10&&(i[f].hour="0"+i[f].hour),i[f].minute<10&&(i[f].minute="0"+i[f].minute),i[f].dayname=this.getDayName(i[f].day),i[f].zoneName=d[i[f].timezone]||"(GMT+00:00) GMT (no daylight saving)");e.sort(function(a,b){return a=parseFloat(a.split(")")[0].replace(":",".").substring(4)),b=parseFloat(b.split(")")[0].replace(":",".").substring(4)),a<b?-1:a>b?1:0}),this.zoneNames=e,this.zones=c,this.templateData={"page-title":jQuery.i18n.map["reports.title"],data:i,apps:countlyGlobal.member.global_admin?countlyGlobal.apps:countlyGlobal.admin_apps,zoneNames:e,member:countlyGlobal.member,hasCrash:"undefined"!=typeof countlyCrashes,hasPush:"undefined"!=typeof countlyPush,hasRevenue:"undefined"!=typeof countlyRevenue,hasViews:"undefined"!=typeof countlyViews};var j=this;a||($(this.el).html(this.template(this.templateData)),j.dtable=$("#reports-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:i,fnRowCallback:function(a,b,c,d){$(a).attr("id",b._id)},aoColumns:[{mData:function(a,b){return a.appNames.join("<br/>")},sType:"string",sTitle:jQuery.i18n.map["reports.apps"]},{mData:function(a,b){return a.emails.join("<br/>")},sType:"string",sTitle:jQuery.i18n.map["reports.emails"]},{mData:function(a,b){var c="";for(var d in a.metrics)c+=jQuery.i18n.map["reports."+d]+"<br/>";return c},sType:"string",sTitle:jQuery.i18n.map["reports.metrics"]},{mData:function(a,b){return jQuery.i18n.map["reports."+a.frequency]},sType:"string",sTitle:jQuery.i18n.map["reports.frequency"]},{mData:function(a,b){var c=jQuery.i18n.map["reports.at"]+" "+a.hour+":"+a.minute+"<br/>"+a.zoneName;return"weekly"==a.frequency&&(c+="<br/>"+jQuery.i18n.map["reports.on"]+" "+a.dayname),c},sType:"string",sTitle:jQuery.i18n.map["reports.time"]}]})),j.dtable.fnSort([[0,"desc"]]),j.dtable.stickyTableHeaders(),CountlyHelpers.expandRows(j.dtable,j.editReport,j),j.initTable(),$("#add-report").on("click",function(){CountlyHelpers.closeRows(j.dtable),$("#listof-apps").hide(),$(".row").removeClass("selected"),$(".create-report-row").is(":visible")?$(".create-report-row").slideUp():($(".create-report-row").slideDown(),j.initTable())}),$(".create-report").on("click",function(){$("#listof-apps").hide();var a={},b=$(".user-details:visible");a.frequency=b.find("input[name=frequency]:checked").val();var c=b.find(".reports-time .text").text().split(":");a.hour=c[0],a.minute=c[1],a.day=app.reportingView.getDayNumber(b.find(".reports-day .text").text()),a.timezone=j.zones[b.find(".reports-timezone .text").text()]||"Etc/GMT",a.emails=[];for(var d=b.find(".reports-emails").val().split(/\n/),e=0;e<d.length;e++)/\S/.test(d[e])&&a.emails.push($.trim(d[e]));a.apps=b.find(".app-list").val().split(","),a.metrics={},b.find(".reports-metrics:checked").each(function(){a.metrics[$(this).attr("name")]=!0}),$(".required").fadeOut().remove();var f=$("<span>").addClass("required").text("*");return a.frequency&&a.frequency.length||b.find(".reports-frequency-title").after(f.clone()),a.hour.length||b.find(".reports-hour").after(f.clone()),a.minute.length||b.find(".reports-minute").after(f.clone()),a.day.length||b.find(".reports-day").after(f.clone()),a.emails.length||b.find(".reports-emails").after(f.clone()),a.apps.length&&""!=a.apps[0]||b.find(".user-admin-list").before(f.clone()),"{}"==JSON.stringify(a.metrics)&&b.find(".reports-include").append(f.clone()),$(".required").length?($(".required").fadeIn(),!1):!$(".red-text").length&&void $.when(countlyReporting.create(a)).then(function(a){"Success"==a.result?app.activeView.render():CountlyHelpers.alert(a.result,"red")})}),$("#select-all").on("click",function(){$("#listof-apps .app:not(.disabled)").addClass("selected");var a=[],b=[];$("#listof-apps .app.selected").each(function(){a[a.length]=$(this).find(".name").text(),b[b.length]=$(this).find(".app_id").val()}),activeRow.find(".user-admin-list").text(a.join(", ")),activeRow.find(".app-list").val(b.join(",")),activeRow.find(".no-apps").hide(),$(this).hide(),$("#deselect-all").show()}),$("#deselect-all").on("click",function(){$("#listof-apps").find(".app:not(.disabled)").removeClass("selected"),adminsOf=[];var a=[];$("#listof-apps .app.selected").each(function(){adminsOf[adminsOf.length]=$(this).find(".name").text(),a[a.length]=$(this).find(".app_id").val()}),activeRow.find(".user-admin-list").text(adminsOf.join(", ")),activeRow.find(".app-list").val(a.join(",")),0==$("#listof-apps .app.selected").length?activeRow.find(".no-apps").show():activeRow.find(".no-apps").hide(),$(this).hide(),$("#select-all").show()}),$("#listof-apps .app").on("click",function(){if($(this).hasClass("disabled"))return!0;$(this).toggleClass("selected"),$("#listof-apps .app.selected").length==$("#listof-apps .app").length?($("#select-all").hide(),$("#deselect-all").show()):($("#select-all").show(),$("#deselect-all").hide()),adminsOf=[];var a=[];$("#listof-apps .app.selected").each(function(){adminsOf[adminsOf.length]=$(this).find(".name").text(),a[a.length]=$(this).find(".app_id").val()}),0==$("#listof-apps .app.selected").length?activeRow.find(".no-apps").show():activeRow.find(".no-apps").hide(),activeRow.find(".user-admin-list").text(adminsOf.join(", ")),activeRow.find(".app-list").val(a.join(","));var b=activeRow.next(".user-apps");if(b.length)for(var c=b.find(".app-list").val(),d=c?c.split(","):[],e=0;e<a.length;e++)d.indexOf(a[e])==-1&&(0==d.length&&0==e?(b.find(".user-admin-list").text(adminsOf[e]),b.find(".app-list").val(a[e])):(b.find(".user-admin-list").text(b.find(".user-admin-list").text().trim()+", "+adminsOf[e]),b.find(".app-list").val(b.find(".app-list").val()+","+a[e])),b.find(".no-apps").hide())}),$("#done").on("click",function(){$("#listof-apps").hide()}))},initTable:function(){function a(){CountlyHelpers.closeRows(b.dtable),$("#listof-apps").hide()}var b=this;$(".select-apps").off("click").on("click",function(){$("#listof-apps .app").removeClass("selected"),activeRow=$(this).parent(".row");var a=$(this).offset();if(a.top+=26,a.left-=18,$("#listof-apps").is(":visible")&&JSON.stringify(a)===JSON.stringify(previousSelectAppPos))return $("#listof-apps").hide(),!0;previousSelectAppPos=a;var b=activeRow.find(".app-list").val().split(",");$("#listof-apps").find(".app_id").each(function(){b.indexOf($(this).val())!=-1&&$(this).parent().addClass("selected")}),0==$("#listof-apps .app:not(.disabled)").length?($("#select-all").hide(),$("#deselect-all").hide()):$("#listof-apps .app.selected").length==$("#listof-apps .app").length?($("#select-all").hide(),$("#deselect-all").show()):($("#select-all").show(),$("#deselect-all").hide()),$("#listof-apps").show().offset(a)}),$(".save-report").off("click").on("click",function(){$("#listof-apps").hide(),lastUserSaved=!0;var a={},c=$(".user-details:visible");a.frequency=c.find("input[name=frequency]:checked").val();var d=c.find(".reports-time .text").text().split(":");a.hour=d[0],a.minute=d[1],a.day=app.reportingView.getDayNumber(c.find(".reports-day .text").text()),a.timezone=b.zones[c.find(".reports-timezone .text").text()]||"Etc/GMT",a.emails=[];for(var e=c.find(".reports-emails").val().split(/\n/),f=0;f<e.length;f++)/\S/.test(e[f])&&a.emails.push($.trim(e[f]));a.apps=c.find(".app-list").val().split(","),a.metrics={},c.find(".reports-metrics:checked").each(function(){a.metrics[$(this).attr("name")]=!0}),a._id=c.find("._id").val(),$(".required").fadeOut().remove();var g=$("<span>").addClass("required").text("*");return a.frequency&&a.frequency.length||c.find(".reports-frequency-title").after(g.clone()),a.hour.length||c.find(".reports-hour").after(g.clone()),a.minute.length||c.find(".reports-minute").after(g.clone()),a.day.length||c.find(".reports-day").after(g.clone()),a.emails.length||c.find(".reports-emails").after(g.clone()),a.apps.length&&""!=a.apps[0]||c.find(".user-admin-list").before(g.clone()),"{}"==JSON.stringify(a.metrics)&&c.find(".reports-include").append(g.clone()),$(".required").length?($(".required").fadeIn(),!1):!$(".red-text").length&&void $.when(countlyReporting.update(a)).then(function(a){"Success"==a.result?app.activeView.render():CountlyHelpers.alert(a.result,"red")})}),$(".cancel-report").off("click").on("click",function(){a()}),$(".delete-report").off("click").on("click",function(){var a=($(".user-details:visible"),$(this));CountlyHelpers.confirm(jQuery.i18n.map["reports.confirm"],"red",function(b){if(!b)return!1;var c=a.parent(".button-container").find("._id").val();$.when(countlyReporting.del(c)).then(function(a){"Success"==a.result?app.activeView.render():CountlyHelpers.alert(a.result,"red")})})}),$(".send-report").on("click",function(){var a=($(".user-details:visible"),$(this).parent(".button-container").find("._id").val()),b=$("#overlay").clone();$("body").append(b),b.show(),$.when(countlyReporting.send(a)).always(function(a){b.hide(),a&&"Success"==a.result?CountlyHelpers.alert(jQuery.i18n.map["reports.sent"],"green"):a&&a.result?CountlyHelpers.alert(a.result,"red"):CountlyHelpers.alert(jQuery.i18n.map["reports.too-long"],"red")})}),$("input[name=frequency]").off("click").on("click",function(){switch(currUserDetails=$(".user-details:visible"),$(this).val()){case"daily":currUserDetails.find(".reports-dow").hide();break;case"weekly":currUserDetails.find(".reports-dow").show()}}),CountlyHelpers.initializeSelect($(".user-details"))},editReport:function(a,b){$(".create-report-row").slideUp(),$("#listof-apps").hide(),$(".row").removeClass("selected"),CountlyHelpers.closeRows(b.dtable);var c="";if(a){c+='<div class="user-details datatablesubrow">',c+="<div>",c+='<div class="row help-zone-vs">',c+='<div class="title reports-frequency-title" data-localize="reports.frequency">'+jQuery.i18n.map["reports.frequency"]+"</div>",c+='<div class="detail">',"daily"==a.frequency?(c+='<input class="reports-frequency" type="radio" name="frequency" value="daily" checked="checked"><span data-localize="reports.daily">'+jQuery.i18n.map["reports.daily"]+"</span>&nbsp;",c+='<input class="reports-frequency" type="radio" name="frequency" value="weekly"><span data-localize="reports.weekly">'+jQuery.i18n.map["reports.weekly"]+"</span>&nbsp;"):(c+='<input class="reports-frequency" type="radio" name="frequency" value="daily"><span data-localize="reports.daily">'+jQuery.i18n.map["reports.daily"]+"</span>&nbsp;",c+='<input class="reports-frequency" type="radio" name="frequency" value="weekly" checked="checked"><span data-localize="reports.weekly">'+jQuery.i18n.map["reports.weekly"]+"</span>&nbsp;"),c+="</div>",c+="</div>",c+='<div class="row help-zone-vs">',c+='<div class="title" data-localize="reports.time">'+jQuery.i18n.map["reports.time"]+"</div>",c+='<div class="detail">',c+='<div class="cly-select reports-time">',c+='<div class="select-inner">',c+='<div class="text-container">',c+='<div class="text">'+a.hour+":"+a.minute+"</div>",c+="</div>",c+='<div class="right combo"></div>',c+="</div>",c+='<div class="select-items square">',c+="<div>",c+='<div data-value="00:00" class="segmentation-option item">00:00</div>',c+='<div data-value="01:00" class="segmentation-option item">01:00</div>',c+='<div data-value="02:00" class="segmentation-option item">02:00</div>',c+='<div data-value="03:00" class="segmentation-option item">03:00</div>',c+='<div data-value="04:00" class="segmentation-option item">04:00</div>',c+='<div data-value="05:00" class="segmentation-option item">05:00</div>',c+='<div data-value="06:00" class="segmentation-option item">06:00</div>',c+='<div data-value="07:00" class="segmentation-option item">07:00</div>',c+='<div data-value="08:00" class="segmentation-option item">08:00</div>',c+='<div data-value="09:00" class="segmentation-option item">09:00</div>',c+='<div data-value="10:00" class="segmentation-option item">10:00</div>',c+='<div data-value="11:00" class="segmentation-option item">11:00</div>',c+='<div data-value="12:00" class="segmentation-option item">12:00</div>',c+='<div data-value="13:00" class="segmentation-option item">13:00</div>',c+='<div data-value="14:00" class="segmentation-option item">14:00</div>',c+='<div data-value="15:00" class="segmentation-option item">15:00</div>',c+='<div data-value="16:00" class="segmentation-option item">16:00</div>',c+='<div data-value="17:00" class="segmentation-option item">17:00</div>',c+='<div data-value="18:00" class="segmentation-option item">18:00</div>',c+='<div data-value="19:00" class="segmentation-option item">19:00</div>',c+='<div data-value="20:00" class="segmentation-option item">20:00</div>',c+='<div data-value="21:00" class="segmentation-option item">21:00</div>',c+='<div data-value="22:00" class="segmentation-option item">22:00</div>',c+='<div data-value="23:00" class="segmentation-option item">23:00</div>',c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+='<div class="row help-zone-vs">',c+='<div class="title" data-localize="reports.timezone">'+jQuery.i18n.map["reports.timezone"]+"</div>",c+='<div class="detail">',c+='<div class="cly-select reports-timezone">',c+='<div class="select-inner">',c+='<div class="text-container">',c+='<div class="text">'+a.zoneName+"</div>",c+="</div>",c+='<div class="right combo"></div>',c+="</div>",c+='<div class="select-items square">',c+="<div>";for(var d=0;d<b.zoneNames.length;d++)c+='<div data-value="'+b.zoneNames[d]+'" class="segmentation-option item">'+b.zoneNames[d]+"</div>";c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+="weekly"==a.frequency?'<div class="row reports-dow" style="display:block;">':'<div class="row reports-dow">',c+='<div class="title"><span data-localize="reports.dow">'+jQuery.i18n.map["reports.dow"]+"</span></div>",c+='<div class="detail">',c+='<div class="cly-select reports-day">',c+='<div class="select-inner">',c+='<div class="text-container">',c+='<div class="text">'+a.dayname+"</div>",c+="</div>",c+='<div class="right combo"></div>',c+="</div>",c+='<div class="select-items square">',c+="<div>",c+='<div data-value="1" class="segmentation-option item" data-localize="reports.monday">'+jQuery.i18n.map["reports.monday"]+"</div>",c+='<div data-value="2" class="segmentation-option item" data-localize="reports.tuesday">'+jQuery.i18n.map["reports.tuesday"]+"</div>",c+='<div data-value="3" class="segmentation-option item" data-localize="reports.wednesday">'+jQuery.i18n.map["reports.wednesday"]+"</div>",c+='<div data-value="4" class="segmentation-option item" data-localize="reports.thursday">'+jQuery.i18n.map["reports.thursday"]+"</div>",c+='<div data-value="5" class="segmentation-option item" data-localize="reports.friday">'+jQuery.i18n.map["reports.friday"]+"</div>",c+='<div data-value="6" class="segmentation-option item" data-localize="reports.saturday">'+jQuery.i18n.map["reports.saturday"]+"</div>",c+='<div data-value="7" class="segmentation-option item" data-localize="reports.sunday">'+jQuery.i18n.map["reports.sunday"]+"</div>",c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+="</div>",c+='<div class="row">',c+='<div class="title"><span data-localize="reports.emails">'+jQuery.i18n.map["reports.emails"]+"</span><br/>",c+='(<span data-localize="reports.help-emails">'+jQuery.i18n.map["reports.help-emails"]+"</span>)</div>",c+='<div class="detail">',c+='<textarea name="emails" class="reports-emails" cols="20" rows="5">',c+=a.emails.join("\n"),c+="</textarea>",c+="</div>",c+="</div>",c+='<div class="row admin-apps help-zone-vs">',c+='<div class="title" data-localize="reports.apps">'+jQuery.i18n.map["reports.apps"]+"</div>",c+='<div class="select-apps">',c+='<input type="hidden" value="'+a.apps+'" class="app-list"/>',c+="</div>",c+='<div class="detail user-admin-list">',c+=a.apps?CountlyHelpers.appIdsToNames(a.apps):'<span data-localize="reports.help-apps">'+jQuery.i18n.map["reports.help-apps"]+"</span>",c+="</div>",c+='<div class="no-apps" data-localize="reports.help-apps">'+jQuery.i18n.map["reports.help-apps"]+"</div>",c+="</div>",c+='<div class="row help-zone-vs">',c+='<div class="title reports-include" data-localize="reports.include-metrics">'+jQuery.i18n.map["reports.include-metrics"]+"</div>",c+='<div class="detail">',c+='<input type="checkbox" class="reports-metrics" name="analytics"',a.metrics.analytics&&(c+=" checked "),c+='/>&nbsp;<span data-localize="reports.analytics">'+jQuery.i18n.map["reports.analytics"]+"</span><br/>",c+='<input type="checkbox" class="reports-metrics" name="events"',a.metrics.events&&(c+=" checked "),c+='/>&nbsp;<span data-localize="reports.events">'+jQuery.i18n.map["reports.events"]+"</span><br/>","undefined"!=typeof countlyRevenue&&(c+='<input type="checkbox" class="reports-metrics" name="revenue"',a.metrics.revenue&&(c+=" checked "),c+='/>&nbsp;<span data-localize="reports.revenue">'+jQuery.i18n.map["reports.revenue"]+"</span><br/>"),"undefined"!=typeof countlyPush&&(c+='<input type="checkbox" class="reports-metrics" name="push"',a.metrics.push&&(c+=" checked "),c+='/>&nbsp;<span data-localize="reports.push">'+jQuery.i18n.map["reports.push"]+"</span><br/>"),"undefined"!=typeof countlyCrashes&&(c+='<input type="checkbox" class="reports-metrics" name="crash"',a.metrics.crash&&(c+=" checked "),c+='/>&nbsp;<span data-localize="reports.crash">'+jQuery.i18n.map["reports.crash"]+"</span><br/>"),c+="</div>",c+="</div>",c+='<div class="button-container">',c+='<input class="_id" type="hidden" value="'+a._id+'"/>',c+="<a href='/i/reports/preview?api_key="+countlyGlobal.member.api_key+"&args="+JSON.stringify({_id:a._id})+'\' target="_blank" class="icon-button green" data-localize="reports.preview">'+jQuery.i18n.map["reports.preview"]+"</a>",c+='<a class="icon-button green send-report" data-localize="reports.send">'+jQuery.i18n.map["reports.send"]+"</a>",c+='<a class="icon-button light save-report" data-localize="common.save">'+jQuery.i18n.map["common.save"]+"</a>",c+='<a class="icon-button light cancel-report" data-localize="common.cancel">'+jQuery.i18n.map["common.cancel"]+"</a>",c+='<a class="icon-button red delete-report" data-localize="reports.delete">'+jQuery.i18n.map["reports.delete"]+"</a>",c+="</div>",c+="</div>",c+="</div>"}return setTimeout(function(){b.initTable()},1),c}}),app.reportingView=new ReportingView,(countlyGlobal.member.global_admin||countlyGlobal.member.admin_of.length)&&app.route("/manage/reports","reports",function(){this.renderWhenReady(this.reportingView)}),$(document).ready(function(){if(countlyGlobal.member.global_admin||countlyGlobal.member.admin_of.length){var a='<a href="#/manage/reports" class="item"><div class="logo-icon fa fa-envelope"></div><div class="text" data-localize="reports.title"></div></a>';$("#management-submenu .help-toggle").length&&$("#management-submenu .help-toggle").before(a)}app.configurationsView&&(app.configurationsView.registerLabel("reports","Reports"),app.configurationsView.registerLabel("reports-use_cron","Create cronjobs for reports"))}),function(a,b,c){function d(){if(h.meta)for(var a in h.meta)_metas[a]=h.meta[a]?h.meta[a]:[]}var e={},f={},g={},h={},i={},j=0,k=!1,l={},m={},n={},o=null,p={};a.loadList=function(a){b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:a,method:"crashes",list:1},dataType:"json",success:function(a){for(var b=0;b<a.length;b++)i[a[b]._id]=a[b].name}})},countlyGlobal.member&&countlyGlobal.member.api_key&&a.loadList(countlyCommon.ACTIVE_APP_ID),a.initialize=function(c){return j=countlyCommon.ACTIVE_APP_KEY,k=!0,n={os_name:jQuery.i18n.map["crashes.os"],browser:jQuery.i18n.map["crashes.browser"],view:jQuery.i18n.map["crashes.view"],app_version:jQuery.i18n.map["crashes.app_version"],os_version:jQuery.i18n.map["crashes.os_version"],manufacture:jQuery.i18n.map["crashes.manufacture"],device:jQuery.i18n.map["crashes.device"],resolution:jQuery.i18n.map["crashes.resolution"],orientation:jQuery.i18n.map["crashes.orientation"],cpu:jQuery.i18n.map["crashes.cpu"],opengl:jQuery.i18n.map["crashes.opengl"]},l=countlyCommon.getPeriodForAjax(),c?(o=c,b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"crashes",period:l,group:c},dataType:"jsonp",success:function(b){f=b,i[f._id]=f.name,f.dp={};for(var c in n)f[c]&&(p[c]=n[c],f.dp[c]=a.processMetric(f[c],c,n[c]));if(f.custom)for(var c in f.custom)f.dp[c]=a.processMetric(f.custom[c],c,c),p[c]=c.charAt(0).toUpperCase()+c.slice(1)},error:function(){CountlyHelpers.alert(jQuery.i18n.map["crashes.not-found"],"red"),app.navigate("/crashes",!0)}})):b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,period:l,method:"crashes",graph:1},dataType:"jsonp",success:function(a){e=a,h=a.data,d(),""==e.crashes.latest_version&&(e.crashes.latest_version="None"),""==e.crashes.error&&(e.crashes.error="None"),""==e.crashes.os&&(e.crashes.os="None"),""==e.crashes.highest_app&&(e.crashes.highest_app="None")}})},a.getCrashName=function(a){return i[a]?i[a]:a},a.getRequestData=function(){return{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"crashes",group:o,userlist:!0}},a.getId=function(){return o},a.common=function(a,c,d){b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/crashes/"+c,data:{args:JSON.stringify({crash_id:a}),app_id:countlyCommon.ACTIVE_APP_ID,api_key:countlyGlobal.member.api_key},dataType:"json",success:function(a){d&&d(a)},error:function(){d&&d(!1)}})},a.markResolve=function(b,c){a.common(b,"resolve",function(a){a&&a.version?c(a.version.replace(/:/g,".")):c()})},a.markUnresolve=function(b,c){a.common(b,"unresolve",c)},a.share=function(b,c){a.common(b,"share",c)},a.unshare=function(b,c){a.common(b,"unshare",c)},a.hide=function(b,c){a.common(b,"hide",c)},a.show=function(b,c){a.common(b,"show",c)},a.del=function(b,c){a.common(b,"delete",c)},a.modifyShare=function(a,c,d){b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/crashes/modify_share",data:{args:JSON.stringify({crash_id:a,data:c}),app_id:countlyCommon.ACTIVE_APP_ID,api_key:countlyGlobal.member.api_key},dataType:"jsonp",success:function(a){d&&d(!0)},error:function(){d&&d(!1)}})},a.addComment=function(a,c,d){c=c||{},c.app_id=countlyCommon.ACTIVE_APP_ID,c.crash_id=a,b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/crashes/add_comment",data:{args:JSON.stringify(c),api_key:countlyGlobal.member.api_key},dataType:"json",success:function(a){d&&d(!0)},error:function(){d&&d(!1)}})},a.editComment=function(a,c,d){c=c||{},c.app_id=countlyCommon.ACTIVE_APP_ID,c.crash_id=a,b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/crashes/edit_comment",data:{args:JSON.stringify(c),api_key:countlyGlobal.member.api_key},dataType:"json",success:function(a){d&&d(!0)},error:function(){d&&d(!1)}})},a.deleteComment=function(a,c,d){c=c||{},c.app_id=countlyCommon.ACTIVE_APP_ID,c.crash_id=a,b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.w+"/crashes/delete_comment",data:{args:JSON.stringify(c),api_key:countlyGlobal.member.api_key},dataType:"json",success:function(a){d&&d(!0)},error:function(){d&&d(!1)}})},a.refresh=function(c){return l=countlyCommon.getPeriodForAjax(),c?b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"crashes",period:l,group:c},dataType:"jsonp",success:function(b){f=b,i[f._id]=f.name,f.dp={};for(var c in n)f[c]&&(p[c]=n[c],f.dp[c]=a.processMetric(f[c],c,n[c]));if(f.custom)for(var c in f.custom)f.dp[c]=a.processMetric(f.custom[c],c,c),p[c]=c.charAt(0).toUpperCase()+c.slice(1)}}):b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,period:l,method:"crashes",graph:1},dataType:"jsonp",success:function(a){e=a,""==e.crashes.latest_version&&(e.crashes.latest_version="None"),""==e.crashes.error&&(e.crashes.error="None"),""==e.crashes.os&&(e.crashes.os="None"),""==e.crashes.highest_app&&(e.crashes.highest_app="None"),countlyCommon.extendDbObj(h,a.data)}})},a.reset=function(){e={},f={},g={},h={},n={},p={}},a.processMetric=function(a,b,c){var d={dp:[{data:[[-1,null]],label:c}],ticks:[[-1,""]]};if(a){var e=0;for(var f in a){d.dp[0].data.push([e,a[f]]);var g=f.replace(/:/g,".");"device"==b&&countlyDeviceList&&countlyDeviceList[g]&&(g=countlyDeviceList[g]),d.ticks.push([e,g]),e++}d.dp[0].data.push([e,null])}return d},a.getChartData=function(b,c){var d=[{data:[],label:c,color:"#DDDDDD",mode:"ghost"},{data:[],label:c,color:"#333933"}],e=[{name:"p"+b,func:function(a){return a[b]},period:"previous"},{name:b}];return countlyCommon.extractChartData(h,a.clearObject,d,e)},a.getMetrics=function(){return p},a.getData=function(){return e},a.getGroupData=function(){return f},a.setGroupData=function(b){n={os_name:jQuery.i18n.map["crashes.os"],browser:jQuery.i18n.map["crashes.browser"],view:jQuery.i18n.map["crashes.view"],os_version:jQuery.i18n.map["crashes.os_version"],app_version:jQuery.i18n.map["crashes.app_version"],manufacture:jQuery.i18n.map["crashes.manufacture"],device:jQuery.i18n.map["crashes.device"],resolution:jQuery.i18n.map["crashes.resolution"],orientation:jQuery.i18n.map["crashes.orientation"],cpu:jQuery.i18n.map["crashes.cpu"],opengl:jQuery.i18n.map["crashes.opengl"]},f=b,f.dp={};for(var c in n)f[c]&&(p[c]=n[c],f.dp[c]=a.processMetric(f[c],c,n[c]));if(f.custom)for(var c in f.custom)f.dp[c]=a.processMetric(f.custom[c],c,c),p[c]=c.charAt(0).toUpperCase()+c.slice(1);
},a.getReportData=function(){return g},a.getErrorName=function(){var a=e.crashes.error.split(":")[0];return a},a.getAffectedUsers=function(){if(e.users.total>0){var a=[],b=e.users.affected/e.users.total*100,c=e.users.fatal/e.users.total*100,d=(e.users.affected-e.users.fatal)/e.users.total*100,f=Math.round(c)+"% "+jQuery.i18n.map["crashes.fatal"];c>0&&a.push({name:f,percent:c});var g=Math.round(d)+"% "+jQuery.i18n.map["crashes.nonfatal"];d>0&&a.push({name:g,percent:d});var h=Math.round(100-b)+"% "+jQuery.i18n.map["crashes.notaffected"];return 100-b>0&&a.push({name:h,percent:100-b}),a}return[]},a.getFatalBars=function(){if(e.crashes.total>0){var a=[],b=e.crashes.fatal+e.crashes.nonfatal,c=e.crashes.fatal/b*100,d=e.crashes.nonfatal/b*100,f=Math.round(c)+"% "+jQuery.i18n.map["crashes.fatal"];c>0&&a.push({name:f,percent:c});var g=Math.round(d)+"% "+jQuery.i18n.map["crashes.nonfatal"];return d>0&&a.push({name:g,percent:d}),a}return[]},a.getResolvedBars=function(){if(e.crashes.unique>0){var a=[],b=Math.max(e.crashes.resolved,0)+Math.max(e.crashes.unresolved,0),c=e.crashes.resolved/b*100,d=e.crashes.unresolved/b*100,f=Math.round(c)+"% "+jQuery.i18n.map["crashes.resolved"];c>0&&a.push({name:f,percent:c});var g=Math.round(d)+"% "+jQuery.i18n.map["crashes.unresolved"];return d>0&&a.push({name:g,percent:d}),a}return[]},a.getPlatformBars=function(){var a=[],b=[],c=0;for(var d in e.crashes.os)e.crashes.os[d]>0&&b.push([d,e.crashes.os[d]]);b.sort(function(a,b){return b[1]-a[1]});var f=3;b.length<f&&(f=b.length);for(var d=0;d<f;d++)c+=b[d][1];for(var d=0;d<f;d++)a.push({name:b[d][0],percent:b[d][1]/c*100});return a},a.getBoolBars=function(a){if(f[a]){f[a].yes=f[a].yes||0,f[a].no=f[a].no||0;var b=f[a].yes+f[a].no,c=f[a].yes/b*100,d=f[a].no/b*100,e=[];return c>0?(e.push({name:c.toFixed(2)+"%",percent:c}),e.push({name:d.toFixed(2)+"%",percent:d})):e.push({name:c.toFixed(2)+"%",percent:d,background:"#86CBDD"}),e}return[]},a.getDashboardData=function(){m=countlyCommon.periodObj;var b,c,d={},e=0,f=0,g=0,i=0,j=0,k=0,l=0,n=0,o=0,p=0;if(m.isSpecialPeriod){for(var q=0;q<m.uniquePeriodArr.length;q++)b=countlyCommon.getDescendantProp(h,m.uniquePeriodArr[q]),b=a.clearObject(b),g+=b.cru;for(var r,s=0,q=0;q<m.uniquePeriodCheckArr.length;q++)r=countlyCommon.getDescendantProp(h,m.uniquePeriodCheckArr[q]),r=a.clearObject(r),s+=r.cru;g>s&&(g=s);for(var q=0;q<m.previousUniquePeriodArr.length;q++)c=countlyCommon.getDescendantProp(h,m.previousUniquePeriodArr[q]),c=a.clearObject(c),i+=c.cru;for(var t,u=0,q=0;q<m.previousUniquePeriodCheckArr.length;q++)t=countlyCommon.getDescendantProp(h,m.previousUniquePeriodCheckArr[q]),t=a.clearObject(t),u+=t.cru;i>u&&(i=u);for(var q=0;q<m.currentPeriodArr.length;q++)b=countlyCommon.getDescendantProp(h,m.currentPeriodArr[q]),b=a.clearObject(b),e+=b.cr,j+=b.crnf,l+=b.crf,o+=b.crru;for(var q=0;q<m.previousPeriodArr.length;q++)c=countlyCommon.getDescendantProp(h,m.previousPeriodArr[q]),c=a.clearObject(c),f+=c.cr,k+=c.crnf,n+=c.crf,p+=c.crru}else b=countlyCommon.getDescendantProp(h,m.activePeriod),c=countlyCommon.getDescendantProp(h,m.previousPeriod),b=a.clearObject(b),c=a.clearObject(c),e=b.cr,f=c.cr,j=b.crnf,k=c.crnf,g=b.cru,i=c.cru,l=b.crf,n=c.crf,o=b.crru,p=c.crru;var v=countlyCommon.getPercentChange(f,e),w=countlyCommon.getPercentChange(k,j),x=countlyCommon.getPercentChange(i,g),y=countlyCommon.getPercentChange(n,l);return changeResolved=countlyCommon.getPercentChange(p,o),d={usage:{total:{total:e,change:v.percent,trend:v.trend,isEstimate:!1},unique:{total:g,"prev-total":i,change:x.percent,trend:x.trend,isEstimate:!1},nonfatal:{total:j,"prev-total":k,change:w.percent,trend:w.trend,isEstimate:!1},fatal:{total:l,change:y.percent,trend:y.trend,isEstimate:!1},resolved:{total:o,change:changeResolved.percent,trend:changeResolved.trend,isEstimate:!1}}}},a.clearObject=function(a){return a?(a.cr||(a.cr=0),a.cru||(a.cru=0),a.crnf||(a.crnf=0),a.crf||(a.crf=0),a.crru||(a.crru=0)):a={cr:0,cru:0,crnf:0,crf:0,crru:0},a}}(window.countlyCrashes=window.countlyCrashes||{},jQuery),function(){function a(a){this.tokens=[],this.tokens.links={},this.options=a||j.defaults,this.rules=k.normal,this.options.gfm&&(this.options.tables?this.rules=k.tables:this.rules=k.gfm)}function b(a,b){if(this.options=b||j.defaults,this.links=a,this.rules=l.normal,this.renderer=this.options.renderer||new c,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=l.breaks:this.rules=l.gfm:this.options.pedantic&&(this.rules=l.pedantic)}function c(a){this.options=a||{}}function d(a){this.tokens=[],this.token=null,this.options=a||j.defaults,this.options.renderer=this.options.renderer||new c,this.renderer=this.options.renderer,this.renderer.options=this.options}function e(a,b){return a.replace(b?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function f(a){return a.replace(/&([#\w]+);/g,function(a,b){return b=b.toLowerCase(),"colon"===b?":":"#"===b.charAt(0)?"x"===b.charAt(1)?String.fromCharCode(parseInt(b.substring(2),16)):String.fromCharCode(+b.substring(1)):""})}function g(a,b){return a=a.source,b=b||"",function c(d,e){return d?(e=e.source||e,e=e.replace(/(^|[^\[])\^/g,"$1"),a=a.replace(d,e),c):new RegExp(a,b)}}function h(){}function i(a){for(var b,c,d=1;d<arguments.length;d++){b=arguments[d];for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a}function j(b,c,f){if(f||"function"==typeof c){f||(f=c,c=null),c=i({},j.defaults,c||{});var g,h,k=c.highlight,l=0;try{g=a.lex(b,c)}catch(m){return f(m)}h=g.length;var n=function(a){if(a)return c.highlight=k,f(a);var b;try{b=d.parse(g,c)}catch(e){a=e}return c.highlight=k,a?f(a):f(null,b)};if(!k||k.length<3)return n();if(delete c.highlight,!h)return n();for(;l<g.length;l++)!function(a){return"code"!==a.type?--h||n():k(a.text,a.lang,function(b,c){return b?n(b):null==c||c===a.text?--h||n():(a.text=c,a.escaped=!0,void(--h||n()))})}(g[l])}else try{return c&&(c=i({},j.defaults,c)),d.parse(a.lex(b,c),c)}catch(m){if(m.message+="\nPlease report this to https://github.com/chjj/marked.",(c||j.defaults).silent)return"<p>An error occured:</p><pre>"+e(m.message+"",!0)+"</pre>";throw m}}var k={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:h,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:h,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n(?!def)[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:h,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};k.bullet=/(?:[*+-]|\d+\.)/,k.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,k.item=g(k.item,"gm")(/bull/g,k.bullet)(),k.list=g(k.list)(/bull/g,k.bullet)("hr","\\n+(?=\\1?(?:[-*_] *){3,}(?:\\n+|$))")("def","\\n+(?="+k.def.source+")")(),k.blockquote=g(k.blockquote)("def",k.def)(),k._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|[^\\w\\s@]*@)\\b",k.html=g(k.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,k._tag)(),k.paragraph=g(k.paragraph)("hr",k.hr)("heading",k.heading)("lheading",k.lheading)("blockquote",k.blockquote)("tag","<"+k._tag)("def",k.def)(),k.normal=i({},k),k.gfm=i({},k.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),k.gfm.paragraph=g(k.paragraph)("(?!","(?!"+k.gfm.fences.source.replace("\\1","\\2")+"|"+k.list.source.replace("\\1","\\3")+"|")(),k.tables=i({},k.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),a.rules=k,a.lex=function(b,c){var d=new a(c);return d.lex(b)},a.prototype.lex=function(a){return a=a.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(a,!0)},a.prototype.token=function(a,b,c){for(var d,e,f,g,h,i,j,l,m,a=a.replace(/^ +$/gm,"");a;)if((f=this.rules.newline.exec(a))&&(a=a.substring(f[0].length),f[0].length>1&&this.tokens.push({type:"space"})),f=this.rules.code.exec(a))a=a.substring(f[0].length),f=f[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?f:f.replace(/\n+$/,"")});else if(f=this.rules.fences.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"code",lang:f[2],text:f[3]});else if(f=this.rules.heading.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"heading",depth:f[1].length,text:f[2]});else if(b&&(f=this.rules.nptable.exec(a))){for(a=a.substring(f[0].length),i={type:"table",header:f[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:f[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:f[3].replace(/\n$/,"").split("\n")},l=0;l<i.align.length;l++)/^ *-+: *$/.test(i.align[l])?i.align[l]="right":/^ *:-+: *$/.test(i.align[l])?i.align[l]="center":/^ *:-+ *$/.test(i.align[l])?i.align[l]="left":i.align[l]=null;for(l=0;l<i.cells.length;l++)i.cells[l]=i.cells[l].split(/ *\| */);this.tokens.push(i)}else if(f=this.rules.lheading.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"heading",depth:"="===f[2]?1:2,text:f[1]});else if(f=this.rules.hr.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"hr"});else if(f=this.rules.blockquote.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"blockquote_start"}),f=f[0].replace(/^ *> ?/gm,""),this.token(f,b,!0),this.tokens.push({type:"blockquote_end"});else if(f=this.rules.list.exec(a)){for(a=a.substring(f[0].length),g=f[2],this.tokens.push({type:"list_start",ordered:g.length>1}),f=f[0].match(this.rules.item),d=!1,m=f.length,l=0;l<m;l++)i=f[l],j=i.length,i=i.replace(/^ *([*+-]|\d+\.) +/,""),~i.indexOf("\n ")&&(j-=i.length,i=this.options.pedantic?i.replace(/^ {1,4}/gm,""):i.replace(new RegExp("^ {1,"+j+"}","gm"),"")),this.options.smartLists&&l!==m-1&&(h=k.bullet.exec(f[l+1])[0],g===h||g.length>1&&h.length>1||(a=f.slice(l+1).join("\n")+a,l=m-1)),e=d||/\n\n(?!\s*$)/.test(i),l!==m-1&&(d="\n"===i.charAt(i.length-1),e||(e=d)),this.tokens.push({type:e?"loose_item_start":"list_item_start"}),this.token(i,!1,c),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(f=this.rules.html.exec(a))a=a.substring(f[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:"pre"===f[1]||"script"===f[1]||"style"===f[1],text:f[0]});else if(!c&&b&&(f=this.rules.def.exec(a)))a=a.substring(f[0].length),this.tokens.links[f[1].toLowerCase()]={href:f[2],title:f[3]};else if(b&&(f=this.rules.table.exec(a))){for(a=a.substring(f[0].length),i={type:"table",header:f[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:f[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:f[3].replace(/(?: *\| *)?\n$/,"").split("\n")},l=0;l<i.align.length;l++)/^ *-+: *$/.test(i.align[l])?i.align[l]="right":/^ *:-+: *$/.test(i.align[l])?i.align[l]="center":/^ *:-+ *$/.test(i.align[l])?i.align[l]="left":i.align[l]=null;for(l=0;l<i.cells.length;l++)i.cells[l]=i.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(i)}else if(b&&(f=this.rules.paragraph.exec(a)))a=a.substring(f[0].length),this.tokens.push({type:"paragraph",text:"\n"===f[1].charAt(f[1].length-1)?f[1].slice(0,-1):f[1]});else if(f=this.rules.text.exec(a))a=a.substring(f[0].length),this.tokens.push({type:"text",text:f[0]});else if(a)throw new Error("Infinite loop on byte: "+a.charCodeAt(0));return this.tokens};var l={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:h,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:h,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};l._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,l._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,l.link=g(l.link)("inside",l._inside)("href",l._href)(),l.reflink=g(l.reflink)("inside",l._inside)(),l.normal=i({},l),l.pedantic=i({},l.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),l.gfm=i({},l.normal,{escape:g(l.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:g(l.text)("]|","~]|")("|","|https?://|")()}),l.breaks=i({},l.gfm,{br:g(l.br)("{2,}","*")(),text:g(l.gfm.text)("{2,}","*")()}),b.rules=l,b.output=function(a,c,d){var e=new b(c,d);return e.output(a)},b.prototype.output=function(a){for(var b,c,d,f,g="";a;)if(f=this.rules.escape.exec(a))a=a.substring(f[0].length),g+=f[1];else if(f=this.rules.autolink.exec(a))a=a.substring(f[0].length),"@"===f[2]?(c=":"===f[1].charAt(6)?this.mangle(f[1].substring(7)):this.mangle(f[1]),d=this.mangle("mailto:")+c):(c=e(f[1]),d=c),g+=this.renderer.link(d,null,c);else if(this.inLink||!(f=this.rules.url.exec(a))){if(f=this.rules.tag.exec(a))!this.inLink&&/^<a /i.test(f[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(f[0])&&(this.inLink=!1),a=a.substring(f[0].length),g+=this.options.sanitize?e(f[0]):f[0];else if(f=this.rules.link.exec(a))a=a.substring(f[0].length),this.inLink=!0,g+=this.outputLink(f,{href:f[2],title:f[3]}),this.inLink=!1;else if((f=this.rules.reflink.exec(a))||(f=this.rules.nolink.exec(a))){if(a=a.substring(f[0].length),b=(f[2]||f[1]).replace(/\s+/g," "),b=this.links[b.toLowerCase()],!b||!b.href){g+=f[0].charAt(0),a=f[0].substring(1)+a;continue}this.inLink=!0,g+=this.outputLink(f,b),this.inLink=!1}else if(f=this.rules.strong.exec(a))a=a.substring(f[0].length),g+=this.renderer.strong(this.output(f[2]||f[1]));else if(f=this.rules.em.exec(a))a=a.substring(f[0].length),g+=this.renderer.em(this.output(f[2]||f[1]));else if(f=this.rules.code.exec(a))a=a.substring(f[0].length),g+=this.renderer.codespan(e(f[2],!0));else if(f=this.rules.br.exec(a))a=a.substring(f[0].length),g+=this.renderer.br();else if(f=this.rules.del.exec(a))a=a.substring(f[0].length),g+=this.renderer.del(this.output(f[1]));else if(f=this.rules.text.exec(a))a=a.substring(f[0].length),g+=e(this.smartypants(f[0]));else if(a)throw new Error("Infinite loop on byte: "+a.charCodeAt(0))}else a=a.substring(f[0].length),c=e(f[1]),d=c,g+=this.renderer.link(d,null,c);return g},b.prototype.outputLink=function(a,b){var c=e(b.href),d=b.title?e(b.title):null;return"!"!==a[0].charAt(0)?this.renderer.link(c,d,this.output(a[1])):this.renderer.image(c,d,e(a[1]))},b.prototype.smartypants=function(a){return this.options.smartypants?a.replace(/--/g,"—").replace(/(^|[-\u2014\/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014\/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):a},b.prototype.mangle=function(a){for(var b,c="",d=a.length,e=0;e<d;e++)b=a.charCodeAt(e),Math.random()>.5&&(b="x"+b.toString(16)),c+="&#"+b+";";return c},c.prototype.code=function(a,b,c){if(this.options.highlight){var d=this.options.highlight(a,b);null!=d&&d!==a&&(c=!0,a=d)}return b?'<pre><code class="'+this.options.langPrefix+e(b,!0)+'">'+(c?a:e(a,!0))+"\n</code></pre>\n":"<pre><code>"+(c?a:e(a,!0))+"\n</code></pre>"},c.prototype.blockquote=function(a){return"<blockquote>\n"+a+"</blockquote>\n"},c.prototype.html=function(a){return a},c.prototype.heading=function(a,b,c){return"<h"+b+' id="'+this.options.headerPrefix+c.toLowerCase().replace(/[^\w]+/g,"-")+'">'+a+"</h"+b+">\n"},c.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},c.prototype.list=function(a,b){var c=b?"ol":"ul";return"<"+c+">\n"+a+"</"+c+">\n"},c.prototype.listitem=function(a){return"<li>"+a+"</li>\n"},c.prototype.paragraph=function(a){return"<p>"+a+"</p>\n"},c.prototype.table=function(a,b){return"<table>\n<thead>\n"+a+"</thead>\n<tbody>\n"+b+"</tbody>\n</table>\n"},c.prototype.tablerow=function(a){return"<tr>\n"+a+"</tr>\n"},c.prototype.tablecell=function(a,b){var c=b.header?"th":"td",d=b.align?"<"+c+' style="text-align:'+b.align+'">':"<"+c+">";return d+a+"</"+c+">\n"},c.prototype.strong=function(a){return"<strong>"+a+"</strong>"},c.prototype.em=function(a){return"<em>"+a+"</em>"},c.prototype.codespan=function(a){return"<code>"+a+"</code>"},c.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},c.prototype.del=function(a){return"<del>"+a+"</del>"},c.prototype.link=function(a,b,c){if(this.options.sanitize){try{var d=decodeURIComponent(f(a)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return""}if(0===d.indexOf("javascript:"))return""}var g='<a href="'+a+'"';return b&&(g+=' title="'+b+'"'),g+=">"+c+"</a>"},c.prototype.image=function(a,b,c){var d='<img src="'+a+'" alt="'+c+'"';return b&&(d+=' title="'+b+'"'),d+=this.options.xhtml?"/>":">"},d.parse=function(a,b,c){var e=new d(b,c);return e.parse(a)},d.prototype.parse=function(a){this.inline=new b(a.links,this.options,this.renderer),this.tokens=a.reverse();for(var c="";this.next();)c+=this.tok();return c},d.prototype.next=function(){return this.token=this.tokens.pop()},d.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},d.prototype.parseText=function(){for(var a=this.token.text;"text"===this.peek().type;)a+="\n"+this.next().text;return this.inline.output(a)},d.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,this.token.text);case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":var a,b,c,d,e,f="",g="";for(c="",a=0;a<this.token.header.length;a++)d={header:!0,align:this.token.align[a]},c+=this.renderer.tablecell(this.inline.output(this.token.header[a]),{header:!0,align:this.token.align[a]});for(f+=this.renderer.tablerow(c),a=0;a<this.token.cells.length;a++){for(b=this.token.cells[a],c="",e=0;e<b.length;e++)c+=this.renderer.tablecell(this.inline.output(b[e]),{header:!1,align:this.token.align[e]});g+=this.renderer.tablerow(c)}return this.renderer.table(f,g);case"blockquote_start":for(var g="";"blockquote_end"!==this.next().type;)g+=this.tok();return this.renderer.blockquote(g);case"list_start":for(var g="",h=this.token.ordered;"list_end"!==this.next().type;)g+=this.tok();return this.renderer.list(g,h);case"list_item_start":for(var g="";"list_item_end"!==this.next().type;)g+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(g);case"loose_item_start":for(var g="";"list_item_end"!==this.next().type;)g+=this.tok();return this.renderer.listitem(g);case"html":var i=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(i);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}},h.exec=h,j.options=j.setOptions=function(a){return i(j.defaults,a),j},j.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new c,xhtml:!1},j.Parser=d,j.parser=d.parse,j.Renderer=c,j.Lexer=a,j.lexer=a.lex,j.InlineLexer=b,j.inlineLexer=b.output,j.parse=j,"undefined"!=typeof module&&"object"==typeof exports?module.exports=j:"function"==typeof define&&define.amd?define(function(){return j}):this.marked=j}.call(function(){return this||("undefined"!=typeof window?window:global)}()),window.CrashesView=countlyView.extend({initialize:function(){this.loaded=!0,this.filter=store.get("countly_crashfilter")?store.get("countly_crashfilter"):"crash-all",this.curMetric="cr",this.metrics={cr:jQuery.i18n.map["crashes.total"],cru:jQuery.i18n.map["crashes.unique"],crnf:jQuery.i18n.map["crashes.nonfatal"]+" "+jQuery.i18n.map["crashes.title"],crf:jQuery.i18n.map["crashes.fatal"]+" "+jQuery.i18n.map["crashes.title"],crru:jQuery.i18n.map["crashes.resolved-users"]}},beforeRender:function(){if(this.template)return $.when(countlyCrashes.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/crashes/templates/crashes.html",function(b){a.template=Handlebars.compile(b)}),countlyCrashes.initialize()).then(function(){})},renderCommon:function(a){var b=countlyCrashes.getData(),c=countlyCrashes.getChartData(this.curMetric,this.metrics[this.curMetric]),d=countlyCrashes.getDashboardData();this.templateData={"page-title":jQuery.i18n.map["crashes.title"],usage:[{title:jQuery.i18n.map["crashes.total"],data:d.usage.total,id:"crash-cr",help:"crashes.help-total"},{title:jQuery.i18n.map["crashes.unique"],data:d.usage.unique,id:"crash-cru",help:"crashes.help-unique"},{title:jQuery.i18n.map["crashes.nonfatal"]+" "+jQuery.i18n.map["crashes.title"],data:d.usage.nonfatal,id:"crash-crnf",help:"crashes.help-nonfatal"},{title:jQuery.i18n.map["crashes.fatal"]+" "+jQuery.i18n.map["crashes.title"],data:d.usage.fatal,id:"crash-crf",help:"crashes.help-fatal"}],"big-numbers":{items:[{title:jQuery.i18n.map["crashes.unresolved-crashes"],total:b.crashes.unresolved,help:"crashes.help-unresolved"},{title:jQuery.i18n.map["crashes.highest-version"],total:b.crashes.highest_app,help:"crashes.help-latest-version"},{title:jQuery.i18n.map["crashes.new-crashes"],total:b.crashes.news,help:"crashes.help-new"},{title:jQuery.i18n.map["crashes.renew-crashes"],total:b.crashes.renewed,help:"crashes.help-reoccurred"}]},bars:[{title:jQuery.i18n.map["crashes.resolution-status"],data:countlyCrashes.getResolvedBars(),help:"crashes.help-resolved"},{title:jQuery.i18n.map["crashes.affected-users"],data:countlyCrashes.getAffectedUsers(),help:"crashes.help-affected-levels"},{title:jQuery.i18n.map["crashes.platform"],data:countlyCrashes.getPlatformBars(),help:"crashes.help-platforms"},{title:jQuery.i18n.map["crashes.fatality"],data:countlyCrashes.getFatalBars(),help:"crashes.help-fatals"}]},b.loss&&(this.templateData.loss=!0,this.templateData["big-numbers"].items.push({title:jQuery.i18n.map["crashes.loss"],total:b.loss.toFixed(2),help:"crashes.help-loss"}));var e=this;if(!a){$(this.el).html(this.template(this.templateData)),$("#"+this.filter).addClass("selected").addClass("active"),countlyCommon.drawTimeGraph(c.chartDP,"#dashboard-graph"),this.dtable=$("#crash-table").dataTable($.extend({},$.fn.dataTable.defaults,{bServerSide:!0,sAjaxSource:countlyCommon.API_PARTS.data.r+"?api_key="+countlyGlobal.member.api_key+"&app_id="+countlyCommon.ACTIVE_APP_ID+"&method=crashes",fnServerData:function(a,b,c){$.ajax({dataType:"jsonp",type:"POST",url:a,data:b,success:function(a){c(a)}})},fnServerParams:function(a){e.filter&&a.push({name:"filter",value:e.filter}),e._query&&a.push({name:"query",value:JSON.stringify(e._query)})},fnRowCallback:function(a,b,c,d){$(a).attr("id",b._id),b.is_resolved?$(a).addClass("resolvedcrash"):b.is_new?$(a).addClass("newcrash"):b.is_renewed&&$(a).addClass("renewedcrash")},aoColumns:[{mData:function(a,b){return"display"==b?a.nonfatal?jQuery.i18n.map["crashes.nonfatal"]:jQuery.i18n.map["crashes.fatal"]:!!a.nonfatal},sType:"string",sTitle:jQuery.i18n.map["crashes.fatal"],sWidth:"80px"},{mData:function(a,b){return"display"==b?a.session?100*Math.round(a.session.total/a.session.count)/100+" "+jQuery.i18n.map["crashes.sessions"]:jQuery.i18n.map["crashes.first-crash"]:a.session?a.session.total/a.session.count:0},sType:"string",sTitle:jQuery.i18n.map["crashes.frequency"],sWidth:"80px"},{mData:"reports",sType:"numeric",sTitle:jQuery.i18n.map["crashes.reports"],sWidth:"80px"},{mData:function(a,c){return a.users=a.users||1,"display"==c?a.users+" ("+(a.users/b.users.total*100).toFixed(2)+"%)":a.users},sType:"string",sTitle:jQuery.i18n.map["crashes.users"],sWidth:"60px"},{mData:function(a,b){return a.not_os_specific?jQuery.i18n.map["crashes.varies"]:a.os},sType:"string",sTitle:jQuery.i18n.map["crashes.platform"],sWidth:"70px"},{mData:function(a,b){return"<div class='truncated'>"+a.name+"</div>"},sType:"string",sTitle:jQuery.i18n.map["crashes.error"]},{mData:function(a,b){return"display"==b?countlyCommon.formatTimeAgo(a.lastTs):a.lastTs},sType:"string",sTitle:jQuery.i18n.map["crashes.last_time"],sWidth:"100px"},{mData:function(a,b){return a.latest_version.replace(/:/g,".")},sType:"string",sTitle:jQuery.i18n.map["crashes.latest_app"],sWidth:"100px"},{mData:function(a,b){return"display"==b?a.is_resolved?"<span style='color:green;'>"+jQuery.i18n.map["crashes.resolved"]+" ("+a.latest_version.replace(/:/g,".")+")</span>":"<span style='color:red;'>"+jQuery.i18n.map["crashes.unresolved"]+"</span>":a.is_resolved},sType:"string",sTitle:jQuery.i18n.map["crashes.resolved"],sWidth:"70px"}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[6,"desc"]]),$(".dataTables_filter input").unbind();var f=null,g=this;$(".dataTables_filter input").bind("keyup",function(a){e.showLoader=!0,$this=this,f&&(clearTimeout(f),f=null),f=setTimeout(function(){g.dtable.fnFilter($this.value)},1e3)});var h=$(this.el).find("#loader");h.show();this.dtable.on("processing",function(a,b,c){c&&e.showLoader?(e.showLoader=!1,h.show()):h.hide()}),setTimeout(function(){$(".dataTables_filter input").attr("placeholder",jQuery.i18n.map["crashes.search"])},1e3),$("#crash-"+this.curMetric).parents(".big-numbers").addClass("active"),$(".widget-content .inner").click(function(){$(".big-numbers").removeClass("active"),$(".big-numbers .select").removeClass("selected"),$(this).parent(".big-numbers").addClass("active"),$(this).find(".select").addClass("selected")}),$(".big-numbers .inner").click(function(){var a=$(this).find(".select").attr("id");if(a){if(e.curMetric==a.replace("crash-",""))return!0;e.curMetric=a.replace("crash-",""),e.switchMetric()}}),$(".bar-inner").on({mouseenter:function(){var a=$(this).parent().next();a.text($(this).data("item")),a.css({color:$(this).css("background-color")})},mouseleave:function(){var a=$(this).parent().next();a.text(a.data("item")),a.css({color:$(this).parent().find(".bar-inner:first-child").css("background-color")})}}),$(".crashes tbody").on("click","tr",function(){var a=$(this).attr("id");a&&(window.location.hash=window.location.hash.toString()+"/"+a)})}},refresh:function(){var a=this;this.loaded&&(this.loaded=!1,$.when(countlyCrashes.refresh()).then(function(){if(a.loaded=!0,app.activeView!=a)return!1;a.renderCommon(!0);var b=$("<div>"+a.template(a.templateData)+"</div>");$(".crashoveral .dashboard").replaceWith(b.find(".dashboard")),$("#crash-big-numbers").replaceWith(b.find("#crash-big-numbers")),$(".dashboard-summary").replaceWith(b.find(".dashboard-summary")),$("#crash-"+a.curMetric).parents(".big-numbers").addClass("active"),$(".widget-content .inner").click(function(){$(".big-numbers").removeClass("active"),$(".big-numbers .select").removeClass("selected"),$(this).parent(".big-numbers").addClass("active"),$(this).find(".select").addClass("selected")}),$(".big-numbers .inner").click(function(){var b=$(this).find(".select").attr("id");return a.curMetric==b.replace("crash-","")||(a.curMetric=b.replace("crash-",""),void a.switchMetric())}),$(".bar-inner").on({mouseenter:function(){var a=$(this).parent().next();a.text($(this).data("item")),a.css({color:$(this).css("background-color")})},mouseleave:function(){var a=$(this).parent().next();a.text(a.data("item")),a.css({color:$(this).parent().find(".bar-inner:first-child").css("background-color")})}}),a.dtable.fnDraw(!1);var c=countlyCrashes.getChartData(a.curMetric,a.metrics[a.curMetric]);countlyCommon.drawTimeGraph(c.chartDP,"#dashboard-graph"),app.localize()}))},filterCrashes:function(a){this.filter=a,store.set("countly_crashfilter",a),$("#"+this.filter).addClass("selected").addClass("active"),this.dtable.fnDraw()},switchMetric:function(){var a=countlyCrashes.getChartData(this.curMetric,this.metrics[this.curMetric]);countlyCommon.drawTimeGraph(a.chartDP,"#dashboard-graph")}}),window.CrashgroupView=countlyView.extend({initialize:function(){this.loaded=!0},beforeRender:function(){if(countlyCrashes.reset(),this.template)return $.when(countlyCrashes.initialize(this.id)).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/crashes/templates/crashgroup.html",function(b){a.template=Handlebars.compile(b)}),countlyCrashes.initialize(this.id)).then(function(){})},renderCommon:function(a){var b=location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")+countlyGlobal.path+"/crash/",c=countlyCrashes.getGroupData();if(c.url&&(b+=c.url),c.latest_version=c.latest_version.replace(/:/g,"."),this.comments={},"undefined"!=typeof marked&&marked.setOptions({breaks:!0}),c.comments)for(var d=0;d<c.comments.length;d++)this.comments[c.comments[d]._id]=c.comments[d].text,"undefined"!=typeof marked?c.comments[d].html=marked(c.comments[d].text):c.comments[d].html=c.comments[d].text;if(!a){this.metrics=countlyCrashes.getMetrics();for(var d in this.metrics){this.curMetric=d,this.curTitle=this.metrics[d];break}}for(var e=["ram","disk","bat","run"],d=0;d<e.length;d++)c[e[d]]||(c[e[d]]={min:0,max:0,total:0,count:1});this.templateData={"page-title":jQuery.i18n.map["crashes.crashes-by"],"note-placeholder":jQuery.i18n.map["crashes.editnote"],hasPermission:!(!countlyGlobal.member.global_admin&&!countlyGlobal.admin_apps[countlyCommon.ACTIVE_APP_ID]),url:b,data:c,error:c.name.substr(0,80),fatal:c.nonfatal?jQuery.i18n.map["crashes.nonfatal"]:jQuery.i18n.map["crashes.fatal"],"active-segmentation":this.curTitle,segmentations:this.metrics,"big-numbers":{"class":"four-column",items:[{title:jQuery.i18n.map["crashes.platform"],total:c.not_os_specific?jQuery.i18n.map["crashes.varies"]:c.os,help:"crashes.help-platform"},{title:jQuery.i18n.map["crashes.reports"],total:c.reports,help:"crashes.help-reports"},{title:jQuery.i18n.map["crashes.affected-users"],total:c.users+" ("+(c.users/c.total*100).toFixed(2)+"%)",help:"crashes.help-affected"},{title:jQuery.i18n.map["crashes.highest-version"],total:c.latest_version.replace(/:/g,"."),help:"crashes.help-app-version"}]}},"web"!=countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type&&(this.templateData.ranges=[{title:jQuery.i18n.map["crashes.ram"],icon:"crash-icon ram-icon",help:"crashes.help-ram",min:c.ram.min+" %",max:c.ram.max+" %",avg:(c.ram.total/c.ram.count).toFixed(2)+" %"},{title:jQuery.i18n.map["crashes.disk"],icon:"crash-icon disk-icon",help:"crashes.help-disk",min:c.disk.min+" %",max:c.disk.max+" %",avg:(c.disk.total/c.disk.count).toFixed(2)+" %"},{title:jQuery.i18n.map["crashes.battery"],icon:"crash-icon battery-icon",help:"crashes.help-battery",min:c.bat.min+" %",max:c.bat.max+" %",avg:(c.bat.total/c.bat.count).toFixed(2)+" %"},{title:jQuery.i18n.map["crashes.run"],icon:"font-icon fa fa-youtube-play",help:"crashes.help-run",min:countlyCommon.timeString(c.run.min/60),max:countlyCommon.timeString(c.run.max/60),avg:countlyCommon.timeString(c.run.total/c.run.count/60)}],this.templateData.bars=[{title:jQuery.i18n.map["crashes.root"],data:countlyCrashes.getBoolBars("root"),help:"crashes.help-root"},{title:jQuery.i18n.map["crashes.online"],data:countlyCrashes.getBoolBars("online"),help:"crashes.help-online"},{title:jQuery.i18n.map["crashes.muted"],data:countlyCrashes.getBoolBars("muted"),help:"crashes.help-muted"},{title:jQuery.i18n.map["crashes.background"],data:countlyCrashes.getBoolBars("background"),help:"crashes.help-background"}]),c.loss&&(this.templateData.loss=!0,this.templateData["big-numbers"].items.push({title:jQuery.i18n.map["crashes.loss"],total:c.loss,help:"crashes.help-loss"})),3==this.templateData["big-numbers"].items.length?this.templateData["big-numbers"]["class"]="three-column":5==this.templateData["big-numbers"].items.length&&(this.templateData["big-numbers"]["class"]="five-column"),c.session&&this.templateData.ranges&&(this.templateData.frequency=!0,this.templateData.ranges.push({
title:jQuery.i18n.map["crashes.sessions"],icon:"font-icon fa fa-refresh",help:"crashes.help-frequency",min:c.session.min,max:c.session.max,avg:100*Math.round(c.session.total/c.session.count)/100}));var f=this;if(!a){if($(this.el).html(this.template(this.templateData)),"undefined"!=typeof addDrill&&$("#content .widget:first-child .widget-header>.right").append(addDrill("sg.crash",this.id,"[CLY]_crash")),c.comments){for(var g=0,d=0;d<c.comments.length;d++)c.comments[d].is_owner||"undefined"!=typeof store.get("countly_"+this.id+"_"+c.comments[d]._id)||g++;g>0&&($(".crash-comment-count span").text(g+""),$(".crash-comment-count").show())}if($(".segmentation-option").on("click",function(){f.switchMetric($(this).data("value"))}),this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:c.data,fnRowCallback:function(a,b,c,d){$(a).attr("id",b._id)},aoColumns:[{mData:function(a,b){return"display"==b?countlyCommon.formatTimeAgo(a.ts):a.ts},sType:"string",sTitle:jQuery.i18n.map["crashes.crashed"]},{mData:function(a,b){var c=a.os;return a.os_version&&(c+=" "+a.os_version.replace(/:/g,".")),c},sType:"string",sTitle:jQuery.i18n.map["crashes.os_version"]},{mData:function(a,b){var c="";return a.manufacture&&(c+=a.manufacture+" "),a.device&&(c+=countlyDeviceList[a.device]||a.device),c},sType:"string",sTitle:jQuery.i18n.map["crashes.device"]},{mData:function(a,b){return a.app_version.replace(/:/g,".")},sType:"string",sTitle:jQuery.i18n.map["crashes.app_version"]}]})),this.dtable.stickyTableHeaders(),this.dtable.fnSort([[0,"desc"]]),CountlyHelpers.expandRows(this.dtable,this.formatData),countlyCommon.drawGraph(c.dp[this.curMetric],"#dashboard-graph","bar"),$("#mark-resolved").click(function(){$("#mark-resolved").css("display","none"),$("#unresolved-text").css("display","none"),countlyCrashes.markResolve(c._id,function(a){a?($("#mark-unresolved").css("display","block"),$("#resolved-text").css("display","inline"),$("#resolved-version").text(a)):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$("#mark-unresolved").click(function(){$("#mark-unresolved").css("display","none"),$("#resolved-text").css("display","none"),countlyCrashes.markUnresolve(c._id,function(a){a?($("#mark-resolved").css("display","block"),$("#unresolved-text").css("display","inline")):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$(".btn-show-crash").click(function(){$(".btn-show-crash").addClass("active"),countlyCrashes.show(c._id,function(a){a?($(".btn-show-crash").removeClass("active"),$(".btn-show-crash").css("display","none"),$(".btn-hide-crash").css("display","block")):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$(".btn-hide-crash").click(function(){$(".btn-hide-crash").addClass("active"),countlyCrashes.hide(c._id,function(a){a?($(".btn-hide-crash").removeClass("active"),$(".btn-hide-crash").css("display","none"),$(".btn-show-crash").css("display","block")):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$(".btn-share-crash").click(function(){$(this).hasClass("active")?($(this).removeClass("active"),$("#crash-share-list").slideUp()):($(this).addClass("active"),$("#crash-share-list").slideDown())}),$(".btn-delete-crash").on("click",function(){$(this).data("id");CountlyHelpers.confirm(jQuery.i18n.map["crashes.confirm-delete"],"red",function(a){return!a||void countlyCrashes.del(c._id,function(a){a?"Success"==a.result?window.location.hash="/crashes":CountlyHelpers.alert(a.result,"red"):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})})}),c.is_public?($("#crash-share-public").attr("checked",!0),$(".crash-share").show()):($("#crash-share-public").attr("checked",!1),$(".crash-share").hide()),c.share)for(var d in c.share)c.share[d]&&$("#crash-share-"+d).attr("checked",!0);$(".crash-share input[type=checkbox]").change(function(){var a={};$(".crash-share input[type=checkbox]").each(function(){a[this.id.replace("crash-share-","")]=$(this).is(":checked")?1:0}),countlyCrashes.modifyShare(c._id,a)}),$("#crash-share-public").change(function(){$(this).is(":checked")?countlyCrashes.share(c._id,function(a){a?$(".crash-share").show():CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")}):countlyCrashes.unshare(c._id,function(a){a?$(".crash-share").hide():CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$("#tabs").tabs(),$("#crash-notes").click(function(){var a=countlyCrashes.getGroupData();if(a.comments){for(var b=0;b<a.comments.length;b++)store.set("countly_"+f.id+"_"+a.comments[b]._id,!0);$(".crash-comment-count").hide()}});var h=$(".crash-stack pre")[0];h.innerHTML='<span class="line-number"></span>'+h.innerHTML+'<span class="cl"></span>';for(var i=h.innerHTML.split(/\n/).length,d=0;d<i;d++){var j=h.getElementsByTagName("span")[0];j.innerHTML+="<span>"+(d+1)+"</span>"}$("#add_comment").click(function(){var a={};a.time=(new Date).getTime(),a.text=$("#comment").val(),countlyCrashes.addComment(c._id,a,function(a){a?(f.refresh(),$("#comment").val("")):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})}),$("#notes").on("click",".crash-comment-edit",function(){var a=$(this).parents(".comment");if(!a.find("#comment_edit").length){var b=$(this).data("id");a.find(".text").hide(),a.append($("#comment_edit").clone()),a.find("textarea").val(f.comments[b]),a.find(".cancel_comment").click(function(){a.find("#comment_edit").remove(),a.find(".text").show()}),a.find(".edit_comment").click(function(){var d={};d.time=(new Date).getTime(),d.text=a.find("#edited_comment").val(),d.comment_id=b,countlyCrashes.editComment(c._id,d,function(b){b?(f.refresh(),a.find("#comment_edit").remove(),a.find(".text").show()):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})})}}),$("#notes").on("click",".crash-comment-delete",function(){var a={};a.comment_id=$(this).data("id"),CountlyHelpers.confirm(jQuery.i18n.map["crashes.confirm-comment-delete"],"red",function(b){return!b||void countlyCrashes.deleteComment(c._id,a,function(b){b?($("#comment_"+a.comment_id).remove(),f.refresh()):CountlyHelpers.alert(jQuery.i18n.map["crashes.try-later"],"red")})})})}},refresh:function(){var a=this;this.loaded&&(this.loaded=!1,$.when(countlyCrashes.initialize(this.id,!0)).then(function(){if(a.loaded=!0,app.activeView!=a)return!1;a.renderCommon(!0);var b=$("<div>"+a.template(a.templateData)+"</div>");$("#big-numbers-container").replaceWith(b.find("#big-numbers-container")),$(".crash-ranges").replaceWith(b.find(".crash-ranges")),$(".crash-bars").replaceWith(b.find(".crash-bars"));var c=countlyCrashes.getGroupData();if(c.comments){for(var d,e,f=$("#comments"),g=0,h=0;h<c.comments.length;h++)a.comments[c.comments[h]._id]=c.comments[h].text,d=c.comments[h],f.find("#comment_"+d._id).length?(e=f.find("#comment_"+d._id),e.find(".text").html(b.find("#comment_"+d._id+" .text").html()),e.find(".author").html(b.find("#comment_"+d._id+" .author").html()),e.find(".time").html(b.find("#comment_"+d._id+" .time").html())):f.append(b.find("#comment_"+d._id)),c.comments[h].is_owner||"undefined"!=typeof store.get("countly_"+a.id+"_"+d._id)||g++;g>0&&($(".crash-comment-count span").text(g+""),$(".crash-comment-count").show())}CountlyHelpers.refreshTable(a.dtable,c.data),countlyCommon.drawGraph(c.dp[a.curMetric],"#dashboard-graph","bar"),CountlyHelpers.reopenRows(a.dtable,a.formatData),app.localize()}))},formatData:function(a){var b="";if(a){if(b+='<div class="datatablesubrow"><table style="width: 100%;"><tr><td class="text-left">'+jQuery.i18n.map["crashes.app_version"]+':</td><td class="text-left">'+jQuery.i18n.map["crashes.device"]+':</td><td class="text-left">'+jQuery.i18n.map["crashes.state"]+":</td>",a.custom&&(b+='<td class="text-left">'+jQuery.i18n.map["crashes.custom"]+":</td>"),a.logs&&(b+='<td class="text-left">'+jQuery.i18n.map["crashes.logs"]+":</td>"),b+='</tr><tr><td class="text-right">'+a.app_version.replace(/:/g,".")+'</td><td class="text-right">'+a.os+" ",a.os_version&&(b+=a.os_version.replace(/:/g,".")+"<br/>"),a.manufacture&&(b+=a.manufacture),a.device&&(b+=a.device),a.cpu&&(b+=" ("+a.cpu+")<br/>"),a.opengl&&(b+=jQuery.i18n.map["crashes.opengl"]+": "+a.opengl+"<br/>"),a.resolution&&(b+=jQuery.i18n.map["crashes.resolution"]+": "+a.resolution+"<br/>"),b+=jQuery.i18n.map["crashes.root"]+": "+(a.root?"yes":"no")+"<br/>",b+='</td><td class="text-left">',a.ram_current&&a.ram_total&&(b+=jQuery.i18n.map["crashes.ram"]+": "+a.ram_current+"/"+a.ram_total+" Mb<br/>"),a.disk_current&&a.disk_total&&(b+=jQuery.i18n.map["crashes.disk"]+": "+a.disk_current+"/"+a.disk_total+" Mb<br/>"),a.bat_current&&(b+=jQuery.i18n.map["crashes.battery"]+": "+a.bat_current+"%<br/>"),a.run&&(b+=jQuery.i18n.map["crashes.run"]+": "+countlyCommon.timeString(a.run/60)+"<br/>"),b+=a.session?jQuery.i18n.map["crashes.after"]+" "+a.session+" "+jQuery.i18n.map["crashes.sessions"]+"<br/>":jQuery.i18n.map["crashes.frequency"]+": "+jQuery.i18n.map["crashes.first-crash"]+"<br/>",b+=jQuery.i18n.map["crashes.online"]+":"+(a.online?"yes":"no")+"<br/>",b+=jQuery.i18n.map["crashes.background"]+":"+(a.background?"yes":"no")+"<br/>",b+=jQuery.i18n.map["crashes.muted"]+":"+(a.muted?"yes":"no")+"<br/>",b+="</td>",a.custom){b+='<td class="text-left">';for(var c in a.custom)b+=c+": "+a.custom[c]+"<br/>";b+="</td>"}a.logs&&(b+='<td class="text-left"><pre>'+a.logs+"</pre></td>"),b+="</tr></table></div>"}return b},switchMetric:function(a){this.curMetric=a;var b=countlyCrashes.getGroupData();countlyCommon.drawGraph(b.dp[this.curMetric],"#dashboard-graph","bar")}}),app.crashesView=new CrashesView,app.crashgroupView=new CrashgroupView,app.route("/crashes","crashes",function(){this.renderWhenReady(this.crashesView)}),app.route("/crashes/:group","crashgroup",function(a){this.crashgroupView.id=a,this.renderWhenReady(this.crashgroupView)}),app.addPageScript("/crashes",function(){$("#crash-selector").find(">.button").click(function(){if($(this).hasClass("selected"))return!0;$(".crash-selector").removeClass("selected").removeClass("active");var a=$(this).attr("id");app.activeView.filterCrashes(a)})}),app.addPageScript("/drill#",function(){var a,b=app.drillView;countlyGlobal.record_crashes&&($("#drill-types").append('<div id="drill-type-crashes" style="padding: 6px 8px 7px 8px;" class="icon-button light">'+jQuery.i18n.map["crashes.title"]+"</div>"),$("#drill-type-crashes").on("click",function(){return!!$(this).hasClass("active")||($("#drill-types").find(".icon-button").removeClass("active"),$(this).addClass("active"),$("#event-selector").hide(),$("#drill-no-event").fadeOut(),$("#segmentation-start").fadeOut().remove(),$(this).parents(".cly-select").removeClass("dark"),$(".event-select.cly-select").find(".text").text("Select an Event"),$(".event-select.cly-select").find(".text").data("value",""),currEvent="[CLY]_crash",b.graphType="line",b.graphVal="times",b.filterObj={},b.byVal="",b.drillChartDP={},b.drillChartData={},b.activeSegmentForTable="",countlySegmentation.reset(),$("#drill-navigation").find(".menu[data-open=table-view]").hide(),void $.when(countlySegmentation.initialize(currEvent)).then(function(){$("#drill").replaceWith(a.clone(!0)),b.adjustFilters(),b.draw(!0,!1)}))}),setTimeout(function(){a=$("#drill").clone(!0)},0))}),$(document).ready(function(){app.addAppSwitchCallback(function(a){countlyCrashes.loadList(a)}),production||CountlyHelpers.loadJS("crashes/javascripts/marked.min.js");var a='<a href="#/crashes" class="item" id="crash-menu"><div class="logo ion-alert-circled"></div><div class="text" data-localize="crashes.title"></div></a>';$(".sidebar-menu #management-menu").length?$(".sidebar-menu #management-menu").before(a):$(".sidebar-menu").append(a),app.configurationsView&&(app.configurationsView.registerLabel("crashes","Crashes"),app.configurationsView.registerLabel("crashes-report_limit","Amount of reports displayed"))}),function(a,b,c){function d(a){return a._id?e(a):_.map(a,function(a){return e(a)})}function e(a){return"undefined"==typeof a.result.sent||0==a.result.sent?(a.percentDelivered=0,a.percentNotDelivered=100):(a.percentDelivered=+(100*a.result.delivered/a.result.sent).toFixed(2),a.percentNotDelivered=100-a.percentDelivered),"undefined"==typeof a.result.found||0==a.result.found?(a.percentSent=0,a.percentNotSent=100):(a.percentSent=+(100*a.result.sent/(a.result.found-(a.result.processed-a.result.sent))).toFixed(2),a.percentNotSent=100-a.percentSent),a.sending=(4&a.result.status)>0&&0===(48&a.result.status),a.local={created:moment(a.created).format("D MMM, YYYY HH:mm"),createdSeconds:moment(a.created).unix()},a.percentDelivered=Math.min(100,a.percentDelivered),a.percentNotDelivered=Math.min(100,a.percentNotDelivered),a.percentSent=Math.min(100,a.percentSent),a.percentNotSent=Math.min(100,a.percentNotSent),a.date&&(a.local.date=moment(a.date).format("D MMM, YYYY HH:mm"),a.local.dateSeconds=moment(a.date).unix()),a.sent&&(a.local.sent=moment(a.sent).format("D MMM, YYYY HH:mm"),a.local.dateSeconds=moment(a.sent).unix()),a}var f={pushes:{w:countlyCommon.API_URL+"/i/pushes",r:countlyCommon.API_URL+"/o/pushes"}};window.MessageStatus={Initial:0,InQueue:2,InProcessing:4,Sent:8,Error:16,Aborted:32,Deleted:64};var g={},h={},i=0,j=!1;a.debug=function(){console.log("debug")},a.initialize=function(){return!!countlyCommon.DEBUG||(i=countlyCommon.ACTIVE_APP_KEY,j=!0,b.ajax({type:"GET",url:f.pushes.r+"/all",data:{api_key:countlyGlobal.member.api_key,period:countlyCommon.getPeriodForAjax()},dataType:"jsonp",success:function(a){g=d(a)}}))},a.refresh=a.initialize,a.getAudience=function(a,c,d){return b.ajax({type:"GET",url:f.pushes.w+"/audience",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify(a)},dataType:"jsonp",success:c,error:d})},a.getLangs=function(a,c,d){function e(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:a,method:"langs",period:"month"},dataType:"jsonp",success:function(b){g[a]=b}})}var f=a.join(",");if(f in h)return b.when(h[f]).then(c,d);for(var g={},i=[],j=0;j<a.length;j++)i.push(e(a[j]));return b.when.apply(b,i).then(function(){h[f]=c(g,!0)},d)},a.createMessage=function(a,c,d,g){return b.ajax({type:"GET",url:f.pushes.w+"/create",data:{api_key:countlyGlobal.member.api_key,args:JSON.stringify(a),date:c?c.toString():""},dataType:"jsonp",success:function(a){a.error?g(a.error):d(e(a))}})},a.refreshMessage=function(a,c,d){return b.ajax({type:"GET",url:f.pushes.w+"/refresh",data:{api_key:countlyGlobal.member.api_key,mid:a._id},dataType:"jsonp",success:function(a){for(var b=e(a),d=0;d<g.length;d++)g[d]._id==b._id&&(g[d]=b);c(e(a))},error:d})},a.retryMessage=function(a,c,d){return b.ajax({type:"GET",url:f.pushes.w+"/retry",data:{api_key:countlyGlobal.member.api_key,mid:a},dataType:"jsonp",success:function(a){a.error?d(a.error):c(e(a))}})},a.deleteMessage=function(a,c,d){return b.ajax({type:"GET",url:f.pushes.w+"/delete",data:{api_key:countlyGlobal.member.api_key,mid:a},dataType:"jsonp",success:function(a){if(a.error)d(a.error);else for(var b=e(a),f=0;f<g.length;f++)g[f]._id==b._id&&(g.splice(f,1),c(b))}})},a.reset=function(){g={},_errorDb={}},a.getMessagesForCurrApp=function(){for(var a=[],b=0;b<g.length&&(g[b].apps.indexOf(countlyCommon.ACTIVE_APP_ID)!==-1&&a.push(g[b]),!(a.length>=10));b++);return a},a.getAllMessages=function(){return g}}(window.countlyPush=window.countlyPush||{},jQuery),function(a,b,c){function d(a,b){var c=countlyCommon.getDescendantProp(a,b);return c&&c.c?c.c:0}var e,f,g,h={},i=null;a.initialize=function(){function c(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"events",event:a,segmentation:"no-segment",period:i},dataType:"jsonp",success:function(b){h[a]=b}})}return g&&i==countlyCommon.getPeriodForAjax()&&f==countlyCommon.ACTIVE_APP_KEY?a.refresh():(i=countlyCommon.getPeriodForAjax(),!!countlyCommon.DEBUG||(f=countlyCommon.ACTIVE_APP_KEY,g=!0,b.when(c("[CLY]_push_sent"),c("[CLY]_push_open"),c("[CLY]_push_action")).then(function(){return!0})))},a.refresh=function(){function a(a){return b.ajax({type:"GET",url:countlyCommon.API_PARTS.data.r,data:{api_key:countlyGlobal.member.api_key,app_id:countlyCommon.ACTIVE_APP_ID,method:"events",action:"refresh",event:a,segmentation:"no-segment",period:i},dataType:"jsonp",success:function(b){countlyCommon.extendDbObj(h[a],b)}})}return countlyCommon.DEBUG?(h={2012:{}},!0):b.when(a("[CLY]_push_sent"),a("[CLY]_push_open"),a("[CLY]_push_action")).then(function(){return!0})},a.getDashDP=function(){var a={chartDP:[],chartData:[],keyEvents:[]},b=["[CLY]_push_sent","[CLY]_push_open","[CLY]_push_action"],c=[jQuery.i18n.map["common.sent"],jQuery.i18n.map["common.delivered"],jQuery.i18n.map["common.actions"]];return b.forEach(function(b,d){var e=(_.pluck(h[b],"_id"),h[b]||{}),f=[{data:[],label:c[d],color:countlyCommon.GRAPH_COLORS[d]}],g=[{name:"c"}],i=countlyCommon.extractChartData(e,countlyEvent.clearEventsObject,f,g);a.chartDP.push(i.chartDP[0]),a.chartData.push(i.chartData[0]),a.keyEvents.push(i.keyEvents[0])}),a},a.getDashSummary=function(){var b=["[CLY]_push_sent","[CLY]_push_open","[CLY]_push_action"],c=[jQuery.i18n.map["common.sent"],jQuery.i18n.map["common.delivered"],jQuery.i18n.map["common.actions"]],d=["dashboard.push.sent","dashboard.push.delivered","dashboard.push.actions"],e=[];return b.forEach(function(b,f){var g=a.getDashEventData(b);g.title=c[f],g.help=d[f],e.push(g)}),e},a.getEventData=function(a){var b=[{data:[],label:jQuery.i18n.map["events.table.count"],color:"#DDDDDD",mode:"ghost"},{data:[],label:jQuery.i18n.map["events.table.count"],color:countlyCommon.GRAPH_COLORS[1]}],c=[{name:"pc",func:function(a){return a.c},period:"previous"},{name:"c"}],d=countlyCommon.extractChartData(h[a],countlyEvent.clearEventsObject,b,c);d.eventName=a,d.dataLevel=1,d.tableColumns=[jQuery.i18n.map["common.date"],jQuery.i18n.map["events.table.count"]];var e=_.pluck(d.chartData,"c");return e.length&&(d.totalCount=_.reduce(e,function(a,b){return a+b},0)),d},a.getDashEventData=function(a){e=countlyCommon.periodObj;var b=(_.pluck(h[a],"_id"),h[a]||{});if(!b)return{total:0,change:"NA",trend:"u",sparkline:"0,0"};var c=0,f=0;if(e.isSpecialPeriod)for(var g=0;g<e.currentPeriodArr.length;g++)c+=d(b,e.currentPeriodArr[g]),f+=d(b,e.previousPeriodArr[g]);else c=d(b,e.activePeriod),f=d(b,e.previousPeriod);var i=countlyCommon.getPercentChange(f,c);return{total:c,change:i.percent,trend:i.trend}},a.calcSparklineData=function(a){var b=[];if(e=countlyCommon.periodObj,e.isSpecialPeriod)for(var c=0;c<e.currentPeriodArr.length;c++){var d=countlyCommon.getDescendantProp(h[a],e.currentPeriodArr[c]);b.push(d&&d.c?d.c:0)}else for(var c=e.periodMin;c<e.periodMax+1;c++){var d=countlyCommon.getDescendantProp(h[a],e.activePeriod+"."+c);b.push(d&&d.c?d.c:0)}return b.join(",")}}(window.countlyPushEvents=window.countlyPushEvents||{},jQuery);var jsonlite;!function(a){function b(a,b){function c(a){throw{name:"SyntaxError",message:a,at:o,text:r}}function d(a){return a&&a!==p&&c("Expected '"+a+"' instead of '"+p+"'"),p=r.charAt(o),o+=1,p}function e(){var a="";if('"'===p)for(;d();){if('"'===p)return d(),a;if("\\"===p)if(d(),"u"===p){for(var b=0,e=0;e<4;e+=1){var f=parseInt(d(),16);if(!isFinite(f))break;b=16*b+f}a+=String.fromCharCode(b)}else{if("string"!=typeof q[p])break;a+=q[p]}else a+=p}c("Bad string")}function f(){for(;p&&p<=" ";)d()}function g(){for(var a="";k();)a+=p,d();return"true"===a||"false"!==a&&("null"===a?null:/^-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?$/.test(a)?parseFloat(a):a)}function h(){var a=[];if("["===p){if(d("["),f(),"]"===p)return d("]"),a;for(;p;){if(a.push(j()),f(),"]"===p)return d("]"),a;d(","),f()}}c("Bad array")}function i(){var a={};if(p===l){if(d(l),f(),p===m)return d(m),a;for(;p;){var b='"'===p?e():g();if("string"!=typeof b&&c("Bad object key: "+b),f(),d(n),Object.hasOwnProperty.call(a,b)&&c('Duplicate key: "'+b+'"'),a[b]=j(),f(),p===m)return d(m),a;d(","),f()}}c("Bad object")}function j(){switch(f(),p){case l:return i();case"[":return h();case'"':return e();default:return g()}}function k(){switch(p){case'"':case"\\":case"\t":case"\n":case"\r":case",":case"[":case"]":case l:case m:case n:return!1}return p>" "}"undefined"==typeof b&&(b=!0);var l=b?"{":"(",m=b?"}":")",n=b?":":"=",o=0,p=" ",q={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},r=a,s=j();return f(),p&&c("Syntax error"),s}a.parse=b}(jsonlite||(jsonlite={})),window.MessagingDashboardView=countlyView.extend({showOnGraph:3,initialize:function(){},beforeRender:function(){if(this.template)return $.when(countlySession.initialize(),countlyUser.initialize(),countlyPushEvents.initialize(),countlyPush.initialize(),"undefined"==typeof countlyGeo?{}:countlyGeo.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/push/templates/messaging-dashboard.html",function(b){a.template=Handlebars.compile(b)}),countlySession.initialize(),countlyUser.initialize(),countlyPushEvents.initialize(),countlyPush.initialize(),"undefined"==typeof countlyGeo?{}:countlyGeo.initialize()).then(function(){})},renderCommon:function(a){var b=countlySession.getSessionData(),c=countlySession.getMsgUserDPActive(),d=countlyPushEvents.getDashDP(),e=countlyPushEvents.getDashSummary(),f={},g=[b.usage["total-users"],b.usage["messaging-users"]];g[0].title=jQuery.i18n.map["common.total-users"],g[0].id="draw-total-users",g[0].help="dashboard.total-users",g[1].title=jQuery.i18n.map["common.messaging-users"],g[1].id="draw-messaging-users",g[1].help="dashboard.messaging-users",f["big-numbers-secondary"]=g;var h=0,i=0,j=0,k=0;b.usage["total-users"].total&&(h=Math.round(100*(b.usage["messaging-users"].total/b.usage["total-users"].total)));for(var l in d.chartDP[0].data)i+=d.chartDP[0].data[l][1];for(var l in d.chartDP[1].data)j+=d.chartDP[1].data[l][1];for(var l in d.chartDP[2].data)k+=d.chartDP[2].data[l][1];h=Math.min(100,h),j=Math.min(100,j?0===i?100:Math.round(100*j/i):0),k=Math.min(100,k?0===i?100:Math.round(100*k/i):0),f["page-title"]=countlyCommon.getDateRange(),f["logo-class"]="sessions",f.push_short=countlyPush.getMessagesForCurrApp(),f["big-numbers"]=e,f["big-numbers-intermediate"]=[{percentage:h+"%",title:jQuery.i18n.map["push.rate.enabling"],help:"dashboard.push.enabling-rate"},{percentage:j+"%",title:jQuery.i18n.map["push.rate.delivery"],help:"dashboard.push.delivery-rate"},{percentage:k+"%",title:jQuery.i18n.map["push.rate.action"],help:"dashboard.push.actions-rate"}],this.templateData=f,a?(newPage=$("<div>"+this.template(this.templateData)+"</div>"),$(this.el).find("#big-numbers-container").replaceWith(newPage.find("#big-numbers-container")),$(this.el).find("#intermediate-numbers-container").replaceWith(newPage.find("#intermediate-numbers-container"))):$(this.el).html(this.template(this.templateData)),countlyCommon.drawTimeGraph(d.chartDP,"#dashboard-graph"),countlyCommon.drawTimeGraph(c.chartDP,"#dashboard-graph-secondary"),a&&(CountlyHelpers.setUpDateSelectors(this),app.localize())},refresh:function(){$.when(this.beforeRender()).then(this.renderCommon.bind(this,!0))},dateChanged:function(){this.refresh()}}),window.MessagingListView=countlyView.extend({template:null,initialize:function(){},beforeRender:function(){if(this.template)return $.when(countlyPush.initialize(),"undefined"==typeof countlyGeo?{}:countlyGeo.initialize()).then(function(){});var a=this;return $.when($.get(countlyGlobal.path+"/push/templates/messaging-list.html",function(b){a.template=Handlebars.compile(b)}),countlyPush.initialize(),"undefined"==typeof countlyGeo?{}:countlyGeo.initialize()).then(function(){})},renderTable:function(a){var b=countlyPush.getAllMessages();$.fn.dataTableExt.oStdClasses.sWrapper="dataTableOne_wrapper message-list",this.dtable=$(".d-table").dataTable($.extend({},$.fn.dataTable.defaults,{aaData:b,aoColumns:[{mData:"messagePerLocale",mRender:CountlyHelpers.clip(CountlyHelpers.messageText),sTitle:jQuery.i18n.map["push.table.message"]},{mData:"apps",sType:"string",mRender:CountlyHelpers.clip(CountlyHelpers.appIdsToNames),sTitle:jQuery.i18n.map["push.table.app-names"]},{mData:"percentDelivered",sType:"string",mRender:function(a,b,c){return'<div class="bar" data-desc="'+a+'%"><div class="bar-inner" style="width:'+c.percentDelivered+'%;" data-item="'+c.percentDelivered+'%"></div><div class="bar-inner" style="width:'+c.percentNotDelivered+'%;" data-item="'+c.percentNotDelivered+'%"></div> </div><div class="percent-text">'+jQuery.i18n.prop("push.count.sent",c.percentDelivered,c.result.sent)+"</div>"},sTitle:jQuery.i18n.map["push.table.delivered"]},{mData:"result",sType:"string",mRender:function(a,b,c){return c.sending&&a.found?'<div class="bar" data-desc="'+a+'%"><div class="bar-inner" style="width:'+c.percentSent+'%;" data-item="'+c.percentSent+'%"></div><div class="bar-inner" style="width:'+c.percentNotSent+'%;" data-item="'+c.percentNotSent+'%"></div> </div><div class="percent-text">'+jQuery.i18n.prop("push.count.sending",c.percentSent,a.found-(a.processed-a.sent))+"</div>":'<span data-localize="push.message.status.'+a.status+'"></span>'},sTitle:jQuery.i18n.map["push.table.status"]},{mData:"local.createdSeconds",bVisible:!1,sType:"numeric"},{mData:"local.created",sType:"date",iDataSort:4,sTitle:jQuery.i18n.map["push.table.created"]},{mData:"local.dateSeconds",bVisible:!1,sType:"numeric"},{mData:"local",sType:"string",iDataSort:6,sTitle:jQuery.i18n.map["push.table.sent-scheduled"],mRender:function(a){return a.sent?a.sent:a.date}}],aaSorting:[[4,"desc"]],fnCreatedRow:function(a,b,c){$(a).attr("data-mid",b._id)}})),$.fn.dataTableExt.oStdClasses.sWrapper="dataTableOne_wrapper",$(".d-table").stickyTableHeaders(),$(".btn-create-message").off("click").on("click",PushPopup.bind(window,void 0,void 0)),$(".d-table tr:not(.push-no-messages)").off("click").on("click",function(){var a=$(this).attr("data-mid");for(var c in b)if(b[c]._id===a)return void PushPopup(b[c])})},renderCommon:function(a){if(a||($("#content").html(this.template({"logo-class":"logo","page-title":jQuery.i18n.map["push.page-title"]})),this.renderTable()),a){var b=countlyPush.getAllMessages();CountlyHelpers.refreshTable(this.dtable,b),CountlyHelpers.setUpDateSelectors(this),$("#date-to").datepicker("option","maxDate",null),$(".d-table tr:not(.push-no-messages)").off("click").on("click",function(){var a=$(this).attr("data-mid");for(var c in b)if(b[c]._id===a)return void PushPopup(b[c])}),app.localize()}},refresh:function(){$.when(this.beforeRender()).then(this.renderCommon.bind(this,!0))},dateChanged:function(){this.refresh()}});var PushPopup=function(a,b,c){function d(b){$("#listof-apps").remove();var c=$('<div id="listof-apps"><div class="tip"></div><div class="scrollable"></div><div class="button-container"><a class="icon-button dark btn-done">'+jQuery.i18n.map["common.done"]+'</a><a class="icon-button dark btn-select-all">'+jQuery.i18n.map["common.select-all"]+'</a><a class="icon-button dark btn-deselect-all">'+jQuery.i18n.map["common.deselect-all"]+"</a></div></div>").hide(),d=c.find(".scrollable");ap=function(a){return $('<div class="app" data-app-id="'+a._id+'"><div class="image" style="background-image: url(\'/files/'+a._id+'.png\');"></div><div class="name">'+a.name+'</div><input class="app_id" type="hidden" value="{{this._id}}"/></div>')};for(var e in x){var f=x[e],g=ap(f);g.on("click",function(){var b=$(this),c=b.attr("data-app-id"),d=!b.hasClass("selected");d?(s(c,a.apps),s(x[c].name,a.appNames)):(r(c,a.apps),r(x[c].name,a.appNames)),b.toggleClass("selected"),o()}),a.apps.indexOf(f._id)!==-1&&g.addClass("selected"),d.append(g)}c.find(".btn-select-all").on("click",function(b){b.preventDefault(),a.apps=[],a.appNames=[];for(var d in x)a.apps.push(x[d]._id),a.appNames.push(x[d].name);o(),$(this).hide(),c.find(".btn-deselect-all").show()}),c.find(".btn-deselect-all").on("click",function(b){b.preventDefault(),a.apps=[],a.appNames=[],o(),$(this).hide(),c.find(".btn-select-all").show()}),c.find(".btn-done").on("click",function(a){a.preventDefault(),v(),n(),c.remove()}),a.apps.length===p(x)&&(c.find(".btn-select-all").hide(),c.find(".btn-deselect-all").show()),c.appendTo(H).offset(b).show()}function e(b){a.type=b,H.find(".type .cly-select .text").text(jQuery.i18n.map["push.type."+b]),"message"===b||"update"===b||"review"===b?(O.slideUp(100),P.slideUp(100),Q.slideDown(100),R.slideDown(100),S.slideDown(100),T.slideDown(100)):"data"===b?(O.slideUp(100),P.slideUp(100),Q.slideUp(100),R.slideDown(100),S.slideDown(100),T.slideDown(100)):"link"===b?(O.slideDown(100),P.slideUp(100),Q.slideDown(100),R.slideDown(100),S.slideDown(100),T.slideDown(100)):"category"===b&&(O.slideUp(100),P.slideDown(100),Q.slideDown(100),R.slideDown(100),S.slideDown(100),T.slideDown(100)),k(),setTimeout(CountlyHelpers.changeDialogHeight.bind(null,G,!0),120)}function f(){var a=moment(H.find(".send-later-datepicker").datepicker("getDate")).format("DD.MM.YYYY");a+=", "+H.find(".time-picker-push").find("span.active").text(),H.find(".send-later-date").text(a),H.find(".send-later-date").data("timestamp",moment(a,"DD.MM.YYYY, H:mm").unix())}function g(a){var b=!1;if(H.find(".time-picker-push").html(""),a){var c=parseInt(moment().format("H"),10),d=parseInt(moment().format("m"),10),e=moment().format("H");d<30&&(H.find(".time-picker-push").append('<span class="active">'+e+":30</span>"),b=!0),e=c+1}else e=0;for(;e<=23;e++)b?H.find(".time-picker-push").append("<span>"+e+":00</span>"):(H.find(".time-picker-push").append('<span class="active">'+e+":00</span>"),b=!0),H.find(".time-picker-push").append("<span>"+e+":30</span>")}function h(){Y.empty(),"default"in a.usedLocales&&Y.append(aa(Math.round(100*a.usedLocales["default"]),"default",jQuery.i18n.map["push.locale.default"]).addClass("selected"));var b,c=[];for(b in a.usedLocales)"default"!==b&&c.push([b,a.usedLocales[b]]);c.sort(function(a,b){return b[1]-a[1]});for(var d in c)Y.append(aa(Math.round(100*c[d][1]),c[d][0],(C[c[d][0]]||"").englishName));var e;if("default"in a.usedLocales)e="default";else for(var f in c){e=c[f][0];break}i(e)}function i(b){Y.find("li").each(function(){var c=$(this),d=c.attr("data-locale");a.messagePerLocale[d]?c.addClass("set"):c.removeClass("set"),b===d?c.addClass("selected"):c.removeClass("selected")}),Z.val(a.messagePerLocale[b]||"")}function j(){a.sound?R.prop("disabled",!1):R.prop("disabled",!0),a.badge?S.prop("disabled",!1):S.prop("disabled",!0),a.data?T.prop("disabled",!1):T.prop("disabled",!0)}function k(){"undefined"==typeof a.count||!a.count.TOTALLY||"default"in a.usedLocales&&!a.messagePerLocale["default"]&&"data"!=a.type?ca.addClass("disabled"):ca.removeClass("disabled")}function l(){var b=H.find(".msg textarea"),c=H.find(".locales ul li.selected").attr("data-locale");c&&(a.messagePerLocale[c]=b.val()),a.usedLocales={};for(var d in a.count)"object"!=typeof a.count[d]&&d in C&&a.count[d]&&(a.usedLocales[d]=a.count[d]);var e=0;for(var d in a.messagePerLocale)a.messagePerLocale[d]&&"default"!==d&&(e+=a.usedLocales[d]);if(a.messagePerLocale["default"]?a.usedLocales["default"]=a.count.TOTALLY-e:e<a.count.TOTALLY&&(a.usedLocales["default"]=a.count.TOTALLY-e),a.count.TOTALLY){b.show();for(var d in a.usedLocales)a.usedLocales[d]=(a.usedLocales[d]/a.count.TOTALLY).toFixed(2)}else b.hide();k(),h(),c&&H.find('.locales ul li[data-locale="'+c+'"]').trigger("click")}function m(){ba||(ba=H.find(".count-value")),ba.text(""),countlyPush.getAudience({apps:a.apps,platforms:a.platforms,test:a.test,userConditions:a.userConditions,drillConditions:a.drillConditions,geo:a.geo||void 0},function(b){a.count=b,countlyPush.getLangs(a.apps,function(c,d){var e=d?{TOTALLY:0}:c;if(d)for(var f in c)for(var g in c[f])if(parseInt(g)==g)for(var h in c[f][g])if(parseInt(h)==h)for(var i in c[f][g][h])if(isNaN(i)){var j=c[f][g][h][i].u;"number"==typeof j&&(e[i]=e[i]?e[i]+j:j,e.TOTALLY+=j)}for(var k in e)"TOTALLY"!==k&&(a.count[k]=Math.floor(a.count.TOTALLY*e[k]/e.TOTALLY));l();var m='<span class="green">&nbsp;'+jQuery.i18n.prop("push.count",b.TOTALLY)+"&nbsp;</span";
return ba.empty().append(jQuery.i18n.map["push.start"]).append(m).append(jQuery.i18n.map["push.end"]),e})},function(a){})}function n(){var b=H.find(".push-platform.ios"),c=H.find(".push-platform.android");q(A,a.appsPlatforms)?(b.show(),q(A,a.platforms)?b.addClass("active"):b.removeClass("active")):b.hide(),q(B,a.appsPlatforms)?(c.show(),q(B,a.platforms)?c.addClass("active"):c.removeClass("active")):c.hide(),m()}function o(){a.apps.length?(H.find(".no-apps").hide(),H.find(".app-names").text(a.appNames.join(", ")).show()):(H.find(".no-apps").show(),H.find(".app-names").hide()),H.find("#listof-apps .app").each(function(){q($(this).attr("data-app-id"),a.apps)?$(this).addClass("selected"):$(this).removeClass("selected")})}function p(a){var b=0;for(var c in a)b++;return b}function q(a,b){return b.indexOf(a)!==-1}function r(a,b){var c=b.indexOf(a);c!==-1&&b.splice(c,1)}function s(a,b){r(a,b),b.push(a)}function t(a){return!isNaN(parseFloat(a))&&isFinite(a)}function u(a){try{var b=jsonlite.parse(a);return"object"==typeof b&&b}catch(c){return!1}}function v(b){b||(a.platforms=[]),a.appsPlatforms=[],a.apps.forEach(function(c){var d=x[c];d.apn&&(d.apn.test||d.apn.prod||d.apn.universal)&&(b||s(A,a.platforms),s(A,a.appsPlatforms)),d.gcm&&d.gcm.key&&(b||s(B,a.platforms),s(B,a.appsPlatforms))})}function w(){var b=H.find(".msg textarea"),c=H.find(".locales ul li.selected").attr("data-locale");a.messagePerLocale[c]=b.val();var d={type:a.type,apps:a.apps.slice(0),appNames:a.appNames.slice(0),platforms:a.platforms.slice(0),messagePerLocale:{},test:a.test,sound:a.sound?H.find(".extra-sound").val():"",badge:a.badge?H.find(".extra-badge").val():"",data:a.data?H.find(".extra-data").val():"",update:"update"===a.type,review:"review"===a.type,url:"link"===a.type?H.find(".push-link").val():"",category:"category"===a.type?H.find(".push-category").val():"",locales:a.usedLocales,date:H.find(".send-later:checked").length?H.find(".send-later-date").data("timestamp"):null,userConditions:a.userConditions,drillConditions:a.drillConditions,geo:a.geo};""===d.sound&&delete d.sound,""===d.badge&&delete d.badge,""===d.data&&delete d.data,""===d.url&&delete d.url,""===d.category&&delete d.category,d.update||delete d.update,d.review||delete d.review,d.userConditions||delete d.userConditions,d.drillConditions||delete d.drillConditions,d.geo||delete d.geo,d.data&&(d.data=u(d.data));for(var e in a.messagePerLocale)a.messagePerLocale[e]&&(d.messagePerLocale[e]=a.messagePerLocale[e]);return d}var x={},y=!1,z=!1,A="i",B="a",C=countlyGlobalLang.languages;for(var D in countlyGlobal.apps){var E=countlyGlobal.apps[D];(E.apn&&(E.apn.test||E.apn.prod||E.apn.universal)||E.gcm&&E.gcm.key)&&(y=!0,countlyGlobal.admin_apps[E._id]&&(z=!0,x[E._id]=E))}if(currentApp=x[countlyCommon.ACTIVE_APP_ID],!y)return void CountlyHelpers.alert(jQuery.i18n.map["push.no-apps"],"red");if(!z)return void CountlyHelpers.alert(jQuery.i18n.map["push.no-apps-admin"],"red");if(!currentApp||!(currentApp.apn&&(currentApp.apn.test||currentApp.apn.prod||currentApp.apn.universal)||currentApp.gcm&&currentApp.gcm.key)){if(c)return void CountlyHelpers.alert(jQuery.i18n.map["push.no-app"],"red");for(var E in x)currentApp=x[E]}if(a){a={_id:a._id,duplicate:a,type:a.type||"message",apps:a.apps.slice(0),appNames:[],platforms:a.platforms.slice(0),appsPlatforms:[],messagePerLocale:_.extend({},a.messagePerLocale),locales:_.extend({},a.locales),sound:b?a.sound:!!a.sound,update:b?a.update:!!a.update,review:b?a.review:!!a.review,badge:b?a.badge:"undefined"!=typeof a.badge,data:b?a.data:"undefined"!=typeof a.data,url:b?a.url:"undefined"!=typeof a.url,test:a.test,date:a.date,sent:a.sent,result:a.result,userConditions:"{}"===a.userConditions?void 0:"string"==typeof a.userConditions?JSON.parse(a.userConditions):a.userConditions,drillConditions:"{}"===a.drillConditions?void 0:"string"==typeof a.drillConditions?JSON.parse(a.drillConditions):a.drillConditions,geo:"undefined"==typeof a.geo?void 0:"string"==typeof a.geo&&a.geo?a.geo:void 0,noTests:!1,noApps:!1,noPlatforms:!1};for(var F in a.apps)for(var E in x)x[E]._id===a.apps[F]&&a.appNames.push(x[E].name);a.userConditions&&a.userConditions._id&&(a.noTests=!0,a.noApps=!0,a.noPlatforms=!0)}else a={type:"message",apps:[currentApp._id],appNames:[currentApp.name],platforms:[],appsPlatforms:[],messagePerLocale:{"default":""},sound:!0,noTests:!1,noApps:!1,noPlatforms:!1};var G=$("#cly-popup").clone().removeAttr("id").addClass("push-create");G.find(".content").html($("#push-create").html());var H=G.find(".content");app.localize(H);var I=a._id&&!b;if(I?H.find(".create-header").hide():H.find(".view-header").hide(),"undefined"!=typeof countlyGeo){var J=countlyGeo.getAll();if(J.length){var K=H.find(".geos .select-items > div"),L=H.find(".geos .select-items > div").text();for(var M in J)K.append($('<div data-value="'+J[M]._id+'" class="item">'+J[M].title+"</div>")),a.geo===J[M]._id&&H.find(".geos .cly-select .text").text(J[M].title);a.geo||H.find(".geos .cly-select .text").text(L),H.find(".geos .cly-select .text").on("changeData",function(b){a.geo=$(this).data("value"),m()})}else H.find(".divide-three.create-header").removeClass(".divide-three"),H.find(".create-header .field.geos").remove()}else{var J=H.find(".field.geos");J.parent().removeClass("divide-three").addClass("divide"),J.remove()}if(I?H.find(".view-apps .view-value").text(a.appNames.join(", ")):(a.noApps&&H.find(".field.apps").hide(),H.find(".select-apps").on("click",function(a){if($("#listof-apps").length)$("#listof-apps").remove();else{var b=$(this).offset();b.top=b.top+46-H.offset().top,b.left=b.left-18-H.offset().left,d(b)}}),o()),I)q(A,a.platforms)||H.find(".view-platforms .ios").hide(),q(B,a.platforms)||H.find(".view-platforms .android").hide();else{if(v(b),a.noPlatforms&&H.find(".field.platforms").hide(),!a.platforms.length)return!1;G.find(".push-platform").on("click",function(b){b.preventDefault();var c=$(this).attr("data-platform");q(c,a.platforms)?r(c,a.platforms):s(c,a.platforms),n()}),n()}var N={message:540,update:540,review:540,data:378,link:613,category:613};if(a.noPlatforms&&a.noApps)for(var M in N)N[M]-=90;if(I)H.find(".view-type .view-value").text(jQuery.i18n.map["push.type."+a.type]),setTimeout(CountlyHelpers.changeDialogHeight.bind(CountlyHelpers,G),20);else{CountlyHelpers.initializeSelect(H),H.find(".type .cly-select .text").on("changeData",function(a){e($(this).data("value"))});var O=H.find(".field.link"),P=H.find(".field.category"),Q=H.find(".field.msg"),R=H.find(".extra-sound-check").parents("tr"),S=H.find(".extra-badge-check").parents("tr"),T=H.find(".extra-data-check").parents("tr");"link"==a.type&&O.find(".push-link").val(a.url),"category"==a.type&&P.find(".push-category").val(a.category),setTimeout(e.bind(this,a.type),20)}if(I){var U="MMM DD, YYYY HH:mm";if(H.find(".view-date .view-value").text(a.date?moment(a.date).format(U):""),a.result&&a.result.error){var Q="string"==typeof a.result.error?a.result.error:a.result.error.message||a.result.error.toString(),V="object"==typeof a.result.error?a.result.error.code:void 0,W=jQuery.i18n.map["push.error"]+(a.result.error.code?" #"+a.result.error.code:"");H.find(".view-sent .title").text(W),Q.length>20?(H.find(".view-sent .view-value").html('<a class="icon-button delete-app">Show</a>'),H.find(".view-sent .view-value .delete-app").on("click",function(){CountlyHelpers.alert(Q,"red")})):H.find(".view-sent .view-value").addClass("error").text(Q)}else if(a.result&&(16&a.result.status||32&a.result.status))H.find(".view-sent .title").text(jQuery.i18n.map["push.error"]),H.find(".view-sent .view-value").addClass("error").text(jQuery.i18n.map["push.message.status."+a.result.status]);else if(a.result&&a.result.processed){var Q=(a.sent?moment(a.sent).format(U):"")+'<div class="codes">';if(Q+="<table>",Q+="<tr><td>"+jQuery.i18n.map["push.totals.processed"]+"</td><td>"+a.result.processed+"</td></tr>",Q+="<tr><td>"+jQuery.i18n.map["push.totals.sent"]+"</td><td>"+a.result.sent+"</td></tr>",Q+="<tr><td>"+jQuery.i18n.map["push.totals.errors"]+"</td><td>"+a.result.errors+"</td></tr>",Q+="</table>",a.result.errorCodes){Q+="<h5>"+jQuery.i18n.map["push.errorCodes"]+"</h5><table>";for(var V in a.result.errorCodes)Q+="<tr><td>"+jQuery.i18n.map["push.errorCode."+V]+"</td><td>"+a.result.errorCodes[V]+"</td></tr>";Q+="</table>"}Q+="</div>",H.find(".view-sent .view-value").html(Q)}}else{H.find(".date-picker-push").click(function(a){a.stopPropagation()});var X=function(a){$(document.body).off("click",X),H.find(".date-picker-push").hide()};H.find(".send-later-datepicker").datepicker({numberOfMonths:1,showOtherMonths:!0,minDate:new Date,onSelect:function(a){var b=$(this).data("datepicker"),c=$.datepicker.parseDate(b.settings.dateFormat||$.datepicker._defaults.dateFormat,a,b.settings);moment(c).format("DD-MM-YYYY")==moment().format("DD-MM-YYYY")?g(!0):g()}}),H.find(".send-later-datepicker").datepicker("option",$.datepicker.regional[countlyCommon.BROWSER_LANG]),g(!0),H.find(".send-later").on("click",function(a){$(this).is(":checked")?(H.find(".date-picker-push").show(),f(),$(document.body).off("click",X).on("click",X)):(H.find(".date-picker-push").hide(),H.find(".send-later-date").text("")),a.stopPropagation()}),H.find(".send-later-date").on("click",function(a){a.stopPropagation(),$(document.body).off("click",X),H.find(".date-picker-push").is(":visible")?H.find(".date-picker-push").hide():(H.find(".date-picker-push").show(),$(document.body).on("click",X))}),H.find(".time-picker-push").on("click","span",function(){H.find(".time-picker-push").find("span").removeClass("active"),$(this).addClass("active"),f()})}a.usedLocales={};var Y=H.find(".locales ul"),Z=H.find(".msg textarea"),aa=function(b,c,d){var e=$('<li data-locale="'+c+'"><span class="percentage">'+b+'%</span><span class="locale">'+d+'</span><span class="fa fa-check"></span>'+("default"===c?"":' <span class="fa fa-remove"></span>')+"</li>").on("click",function(){var b=Y.find(".selected").attr("data-locale");a.messagePerLocale[b]=Z.val(),i(c)}).on("click",".fa-remove",function(b){b.stopPropagation(),Z.val(""),delete a.messagePerLocale[c],l()});return e};if(I?(a.usedLocales=_.extend({},a.locales),h(),"data"===a.type&&H.find(".field.msg").hide()):Z.on("keydown",l),I&&(H.find("textarea").prop("disabled",!0),H.find(".locales").addClass("view-locales")),(I||b)&&(a.test&&H.find(".extra-test-check").attr("checked","checked"),a.sound?(H.find(".extras .extra-sound-check").attr("checked","checked"),H.find(".extras .extra-sound").val(a.duplicate.sound)):H.find(".extras .extra-sound-check").removeAttr("checked"),a.badge&&(H.find(".extras .extra-badge-check").attr("checked","checked"),H.find(".extras .extra-badge").val(a.duplicate.badge)),a.data&&(H.find(".extras .extra-data-check").attr("checked","checked"),H.find(".extras .extra-data").val(JSON.stringify(a.duplicate.data)))),I)H.find(".extras input, .extra-test-check").prop("disabled",!0);else{H.find('.extras table input[type="checkbox"], .extra-test-check').on("change",function(b){a[$(this).attr("data-attr")]=$(this).is(":checked"),j(),$(this).parents("td").next("td").find("input").focus(),"test"===$(this).attr("data-attr")&&m()}),H.find(".extras table td.td-value").on("click",function(a){$(this).find('input[type="text"]').prop("disabled")&&$(this).prev().find('input[type="checkbox"]').trigger("click")}),a.noTests&&H.find(".test-switch-holder").hide(),H.find(".extras table label, .test-switch-holder label").on("click",function(a){var b=$(this).prev();b.is(":checkbox")&&b.trigger("click")});var R=H.find(".extras .extra-sound"),S=H.find(".extras .extra-badge"),T=H.find(".extras .extra-data");H.find(".extra-data").on("blur",function(){$(this).next(".required").remove();var a=$(this).val(),b=u(a);b?$(this).val(JSON.stringify(b)):a&&$(this).after($("<span>").addClass("required").text("*").show())})}I?(H.find(".btn-send").hide(),H.find(".btn-duplicate").on("click",function(){$("#overlay").trigger("click"),setTimeout(PushPopup.bind(window,a.duplicate,!0),500)}),H.find(".btn-delete").on("click",function(){var b=$(this).addClass("disabled");countlyPush.deleteMessage(a._id,function(a){b.removeClass("disabled"),app.activeView.render(),H.find(".btn-close").trigger("click")},function(a){H.find(".btn-close").trigger("click")})})):(H.find(".btn-duplicate").hide(),H.find(".btn-delete").hide(),H.find(".btn-send").on("click",function(){if(!$(this).hasClass("disabled")){var b=w();$(".required").fadeOut().remove();var c=$("<span>").addClass("required").text("*");if(b.apps.length||H.find(".field.apps .app-names").append(c.clone()),b.platforms.length||H.find(".field.platforms .details").append(c.clone()),a.sound&&!b.sound&&H.find(".extra-sound").after(c.clone()),a.badge&&(b.badge&&t(b.badge)?b.badge=1*b.badge:H.find(".extra-badge").after(c.clone())),a.data&&!b.data&&H.find(".extra-data").after(c.clone()),"link"!==b.type||b.url&&/^([a-z]([a-z]|\d|\+|-|\.)*):(\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?((\[(|(v[\da-f]{1,}\.(([a-z]|\d|-|\.|_|~)|[!\$&'\(\)\*\+,;=]|:)+))\])|((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=])*)(:\d*)?)(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*|(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)|((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)){0})(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b.url)||H.find(".field.link .details").after(c.clone()),"default"in a.usedLocales&&!b.messagePerLocale["default"]&&"data"!=b.type&&H.find(".locales li").first().append(c.clone()),!$(".required").show().length){var d=$(this).addClass("disabled");countlyPush.createMessage(b,null,function(a){d.removeClass("disabled"),app.activeView.render(),H.find(".btn-close").trigger("click")},function(a){d.removeClass("disabled"),CountlyHelpers.alert(a)})}}})),H.find(".btn-close").on("click",function(){$("#overlay").trigger("click")});var ba,ca=H.find(".btn-send");m(),I&&H.find("input, textarea").each(function(){$(this).removeAttr("placeholder")}),CountlyHelpers.revealDialog(G)};app.messagingDashboardView=new MessagingDashboardView,app.messagingListView=new MessagingListView,app.route("/messaging","messagingDashboardView",function(){this.renderWhenReady(this.messagingDashboardView)}),app.route("/messaging/messages","messagingListView",function(){this.renderWhenReady(this.messagingListView)});var settingsAppId,apn,gcm,managementAdd="";app.addPageScript("/manage/apps",function(){""==managementAdd?$.get(countlyGlobal.path+"/push/templates/push-management.html",function(a){managementAdd=a,addPushHTMLIfNeeded(),pushAppMgmt()}):pushAppMgmt()}),app.addAppManagementSwitchCallback(function(a,b){"mobile"==b?(addPushHTMLIfNeeded(),$(".appmng-push").show(),changeApp(a)):$(".appmng-push").hide()}),app.addPageScript("/drill#",function(){"mobile"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type&&($("#bookmark-filter").after('<div id="create-message-connector" style="display:none; float:left; height:1px; border-top:1px solid #999; width:50px; margin-top:14px; margin-left:5px;"></div><a class="icon-button green btn-header btn-create-message" data-localize="push.create" style="display:none"></a>'),app.localize(),$(".btn-create-message").off("click").on("click",function(){var a=(app.drillView.getFilterObjAndByVal(),{apps:[countlyCommon.ACTIVE_APP_ID],platforms:[],drillConditions:countlySegmentation.getRequestData()});PushPopup(a,!1,!0)}),$("#bookmark-view").on("click",".bookmark-action.send",function(){var a=$(this).data("query"),b={apps:[countlyCommon.ACTIVE_APP_ID],platforms:[],drillConditions:a};PushPopup(b,!1,!0)}))}),app.addPageScript("/users#",function(){if("mobile"==countlyGlobal.apps[countlyCommon.ACTIVE_APP_ID].type)if(app.activeView.updateEngagement){var a=countlyUserdata.getUserdetails(),b=[],c=!1,d=!1;a.tk&&((a.tk.id||a.tk.ia||a.tk.ip)&&b.push("i"),(a.tk.at||a.tk.ap)&&b.push("a"),c=!!a.tk.id||!!a.tk.ia||!!a.tk.at,d=!!a.tk.ip||!!a.tk.ap),$(".btn-create-message").length||$(".widget-header .left").append($('<a class="icon-button green btn-header left btn-create-message" data-localize="push.create"></a>').text(jQuery.i18n.map["push.create"])),$(".btn-create-message").show().off("click").on("click",function(){b.length?PushPopup({platforms:b,apps:[countlyCommon.ACTIVE_APP_ID],test:c&&!d,userConditions:{_id:app.userdetailsView.user_id}},!0,!0):CountlyHelpers.alert(jQuery.i18n.map["push.no-user-token"],"red")})}else $(".btn-create-message").length||$(".widget-header .left").append($('<a class="icon-button green btn-header left btn-create-message" data-localize="push.create"></a>').text(jQuery.i18n.map["push.create"])),$(".btn-create-message").off("click").on("click",function(){var a=app.userdataView._query||{};"user-known"==app.userdataView.filter?a.hasInfo=!0:"user-anonymous"==app.userdataView.filter&&(a.hasInfo={$ne:!0}),$(".dataTables_filter input").val().length&&(a.$text={$search:'"'+$(".dataTables_filter input").val()+'"'});var b={apps:[countlyCommon.ACTIVE_APP_ID],platforms:[],userConditions:a};PushPopup(b,!1,!0)})}),$(document).ready(function(){$.get(countlyGlobal.path+"/push/templates/push-create.html",function(a){$("body").append(a)}),Handlebars.registerPartial("message",$("#template-message-partial").html()),Handlebars.registerHelper("messageText",function(a,b){return CountlyHelpers.messageText(a.messagePerLocale)}),Handlebars.registerHelper("ifMessageStatusToRetry",function(a,b){return a==MessageStatus.Error?b.fn(this):""}),Handlebars.registerHelper("ifMessageStatusToStop",function(a,b){return a==MessageStatus.InProcessing||a==MessageStatus.InQueue?b.fn(this):""});var a='<a class="item messaging" id="sidebar-messaging"><div class="logo ion-chatbox-working"></div><div class="text" data-localize="push.sidebar.section">Messaging</div></a><div class="sidebar-submenu" id="messaging-submenu"><a href="#/messaging" class="item"><div class="logo-icon fa fa-line-chart"></div><div class="text" data-localize="push.sidebar.overview">Overview</div></a><a href="#/messaging/messages" class="item"><div class="logo-icon fa fa-inbox""></div><div class="text" data-localize="push.sidebar.messages">Messages</div></a></div>';$("#mobile-type #management-menu").length?$("#mobile-type #management-menu").before(a):$("#mobile-type").append(a)});